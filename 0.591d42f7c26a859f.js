(self.webpackChunksnv_admin_frontend=self.webpackChunksnv_admin_frontend||[]).push([[0],{5e3:(N,h,p)=>{"use strict";p.r(h),p.d(h,{CallLayoutRoutesModule:()=>v});var f=p(5810),e=p(5879),E=p(5128),_=p(9862),A=p(7065);let S=(()=>{class l{constructor(){this._http=(0,e.f3M)(_.eN)}onGenerateToken(){return this._http.get(A.f+"/twilio/access-token")}}return l.\u0275fac=function(b){return new(b||l)},l.\u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})(),C=(()=>{class l{constructor(){this._twiliosvc=(0,e.f3M)(S),this._accessToken=""}ngOnInit(){this.onLoadToken()}onLoadToken(){this._token$=this._twiliosvc.onGenerateToken().subscribe({next:b=>{const{token:O}=b;this._accessToken=O,this.onLoadDevice()},error:b=>{console.log("error :::: ",b)}})}onLoadDevice(){this._device=new E.AS(this._accessToken,{logLevel:1,codecPreferences:[E.Ig.Codec.Opus,E.Ig.Codec.PCMU]}),console.log("this._device ::: ",this._device),this._device.register()}ngOnDestroy(){}}return l.\u0275fac=function(b){return new(b||l)},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-softphone"]],decls:2,vars:0,template:function(b,O){1&b&&(e.TgZ(0,"p"),e._uU(1,"softphone works!"),e.qZA())}}),l})(),g=(()=>{class l{}return l.\u0275fac=function(b){return new(b||l)},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-home-page"]],decls:48,vars:0,consts:[[1,"row"],[1,"col-xl-12"],[1,"card"],[1,"card-header","align-items-center","d-flex"],[1,"card-title","mb-0","flex-grow-1"],[1,"card-body"],[1,"col-3"],[1,"card","card-body","card-calls"],[1,"mb-4","mx-auto"],[1,"box-icon"],[1,"mdi","mdi-phone-in-talk"],[1,"mt-3","mb-1","text-center"],["href","",1,"btn","btn-danger","rounded-pill","text-uppercase","fw-semibold"],[1,"mdi","mdi-video"],[1,"mdi","mdi-volume-high"],[1,"mdi","mdi-calendar-month"],[1,"col-lg-9","col-md-8","col-sm-12"],[1,"col-lg-3","col-md-4","col-sm-12","bg-info"]],template:function(b,O){1&b&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),e._uU(5,"Calls"),e.qZA()(),e.TgZ(6,"div",5)(7,"div",0)(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9),e._UZ(12,"i",10),e.qZA(),e.TgZ(13,"h5",11),e._uU(14,"Phone"),e.qZA()(),e.TgZ(15,"a",12),e._uU(16,"Start"),e.qZA()()(),e.TgZ(17,"div",6)(18,"div",7)(19,"div",8)(20,"div",9),e._UZ(21,"i",13),e.qZA(),e.TgZ(22,"h5",11),e._uU(23,"Video Calls"),e.qZA()(),e.TgZ(24,"a",12),e._uU(25,"Start"),e.qZA()()(),e.TgZ(26,"div",6)(27,"div",7)(28,"div",8)(29,"div",9),e._UZ(30,"i",14),e.qZA(),e.TgZ(31,"h5",11),e._uU(32,"Audio Calls"),e.qZA()(),e.TgZ(33,"a",12),e._uU(34,"Start"),e.qZA()()(),e.TgZ(35,"div",6)(36,"div",7)(37,"div",8)(38,"div",9),e._UZ(39,"i",15),e.qZA(),e.TgZ(40,"h5",11),e._uU(41,"Scheduled"),e.qZA()(),e.TgZ(42,"a",12),e._uU(43,"Start"),e.qZA()()()()()()()(),e.TgZ(44,"div",0),e._UZ(45,"div",16),e.TgZ(46,"div",17),e._UZ(47,"app-softphone"),e.qZA()())},dependencies:[C],styles:[".box-icon[_ngcontent-%COMP%]{align-items:center;background-color:#9a9a9a;border-radius:50%;display:flex;justify-content:center;height:80px;width:80px}.box-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;font-size:40px}.card-calls[_ngcontent-%COMP%]{box-shadow:0 0 4px 2px #38414a26}"]}),l})();var T=p(2081),u=p(6223);const i=function(){return["/calls/call-handling-customer/"]},t=function(){return["/calls/call-handling/"]},r=[{path:"",component:g},{path:"connectNow",component:(()=>{class l{}return l.\u0275fac=function(b){return new(b||l)},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-connect-now"]],decls:54,vars:0,consts:[[1,"row"],[1,"col-xl-12"],[1,"card"],[1,"card-header","align-items-center","d-flex"],[1,"card-title","mb-0","flex-grow-1"],[1,"card-body"],[1,"row","mt-4","justify-content-center"],[1,"col-6","col-md-4","col-lg-3"],[1,"card","card-body","card-calls"],[1,"my-3","mx-auto"],[1,"box-icon"],[1,"mdi","mdi-video"],[1,"mt-3","mb-1","text-center"],[1,"mdi","mdi-volume-high"],[1,"row","mt-3"],[1,"col-md-4"],["for","exampleInputrounded",1,"form-label"],["type","text","id","exampleInputrounded","placeholder","Enter your address",1,"form-control","rounded-pill"],[1,"form-label"],["aria-label","Default select example",1,"form-select","rounded-pill","mb-3"],["selected",""],["value","1"],["value","2"],["value","3"]],template:function(b,O){1&b&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),e._uU(5,"Access to Interpreter"),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10),e._UZ(12,"i",11),e.qZA(),e.TgZ(13,"h5",12),e._uU(14,"Video"),e.qZA()()()(),e.TgZ(15,"div",7)(16,"div",8)(17,"div",9)(18,"div",10),e._UZ(19,"i",13),e.qZA(),e.TgZ(20,"h5",12),e._uU(21,"Audio"),e.qZA()()()()(),e.TgZ(22,"div",14)(23,"div",15)(24,"div")(25,"label",16),e._uU(26,"Address"),e.qZA(),e._UZ(27,"input",17),e.qZA()(),e.TgZ(28,"div",15)(29,"div")(30,"label",18),e._uU(31,"Language Required"),e.qZA(),e.TgZ(32,"select",19)(33,"option",20),e._uU(34,"Search language"),e.qZA(),e.TgZ(35,"option",21),e._uU(36,"Information Architecture"),e.qZA(),e.TgZ(37,"option",22),e._uU(38,"UI/UX Design"),e.qZA(),e.TgZ(39,"option",23),e._uU(40,"Back End Development"),e.qZA()()()(),e.TgZ(41,"div",15)(42,"div")(43,"label",18),e._uU(44,"I need help with"),e.qZA(),e.TgZ(45,"select",19)(46,"option",20),e._uU(47,"Search for"),e.qZA(),e.TgZ(48,"option",21),e._uU(49,"Information Architecture"),e.qZA(),e.TgZ(50,"option",22),e._uU(51,"UI/UX Design"),e.qZA(),e.TgZ(52,"option",23),e._uU(53,"Back End Development"),e.qZA()()()()()()()()())},dependencies:[u.YN,u.Kr],styles:[".box-icon[_ngcontent-%COMP%]{align-items:center;background-color:var(--neutral-01);border-radius:50%;border:solid 1px var(--neutral-05);display:flex;justify-content:center;height:80px;width:80px}.box-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--clr-neutral-05);font-size:40px}.card-calls[_ngcontent-%COMP%]{box-shadow:0 0 4px 2px #38414a26}"]}),l})()},{path:"callReport",component:(()=>{class l{}return l.\u0275fac=function(b){return new(b||l)},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-call-report"]],decls:48,vars:0,consts:[[1,"row"],[1,"col-xl-12"],[1,"card"],[1,"card-header","align-items-center","d-flex"],[1,"card-title","mb-0","flex-grow-1"],[1,"card-body"],[1,"col-md-4"],[1,"mb-3"],["for","exampleInputrounded",1,"form-label"],["type","text","id","exampleInputrounded",1,"form-control","rounded-pill"],["for","exampleInputdate",1,"form-label"],["type","date","id","exampleInputdate",1,"form-control"],["for","exampleInputdateEnd",1,"form-label"],["type","date","id","exampleInputdateEnd",1,"form-control"],[1,"text-end"],["type","button",1,"btn","rounded-pill","btn-danger","px-5","fw-medium","waves-effect","waves-light"],[1,"table-responsive"],[1,"table","table-striped"],["scope","col"],["colspan","5",1,"text-center"]],template:function(b,O){1&b&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),e._uU(5,"Filter by"),e.qZA()(),e.TgZ(6,"div",5)(7,"div",0)(8,"div",6)(9,"div",7)(10,"label",8),e._uU(11,"Search"),e.qZA(),e._UZ(12,"input",9),e.qZA()(),e.TgZ(13,"div",6)(14,"div",7)(15,"label",10),e._uU(16,"Start Date"),e.qZA(),e._UZ(17,"input",11),e.qZA()(),e.TgZ(18,"div",6)(19,"div",7)(20,"label",12),e._uU(21,"End Date"),e.qZA(),e._UZ(22,"input",13),e.qZA()()(),e.TgZ(23,"div",14)(24,"button",15),e._uU(25,"Search"),e.qZA()()()()()(),e.TgZ(26,"div",0)(27,"div",1)(28,"div",2)(29,"div",5)(30,"div",16)(31,"table",17)(32,"thead")(33,"tr")(34,"th",18),e._uU(35,"Id"),e.qZA(),e.TgZ(36,"th",18),e._uU(37,"Customer"),e.qZA(),e.TgZ(38,"th",18),e._uU(39,"Date"),e.qZA(),e.TgZ(40,"th",18),e._uU(41,"Invoice"),e.qZA(),e.TgZ(42,"th",18),e._uU(43,"Action"),e.qZA()()(),e.TgZ(44,"tbody")(45,"tr")(46,"td",19),e._uU(47," Sin registros "),e.qZA()()()()()()()()())}}),l})()},{path:"opi-call",component:(()=>{class l{}return l.\u0275fac=function(b){return new(b||l)},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-opi-call"]],decls:72,vars:0,consts:[[1,"row"],[1,"col-12"],[1,"page-title-box","d-sm-flex","align-items-center","justify-content-between"],[1,"mb-sm-0"],[1,"col-xl-12"],[1,"card"],[1,"card-header","align-items-center","d-flex"],[1,"card-title","mb-0","flex-grow-1"],[1,"card-body"],[1,"col-md-6","mb-3"],["for","exampleInputrounded",1,"form-label"],["type","text","id","exampleInputrounded",1,"form-control","rounded-pill"],[1,"form-label"],["aria-label","Default select example",1,"form-select","rounded-pill"],["selected",""],["value","1"],["value","2"],["value","3"],[1,"col-md-6","mb-3","mb-md-0"],["for","accesscode",1,"form-label"],["type","text","id","accesscode",1,"form-control","rounded-pill"],[1,"col-md-6"],["for","phoneNumber",1,"form-label"],["type","text","id","phoneNumber",1,"form-control","rounded-pill"],[1,"text-end","mt-3"],["type","button",1,"btn","rounded-pill","btn-danger","px-5","fw-medium","waves-effect","waves-light"],[1,"table-responsive"],[1,"table","table-striped"],["scope","col"],["colspan","8",1,"text-center"]],template:function(b,O){1&b&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),e._uU(4,"Call Reports"),e.qZA()()()(),e.TgZ(5,"div",0)(6,"div",4)(7,"div",5)(8,"div",6)(9,"h4",7),e._uU(10,"Filter by"),e.qZA()(),e.TgZ(11,"div",8)(12,"div",0)(13,"div",9)(14,"div")(15,"label",10),e._uU(16,"Customer"),e.qZA(),e._UZ(17,"input",11),e.qZA()(),e.TgZ(18,"div",9)(19,"div")(20,"label",12),e._uU(21,"Account"),e.qZA(),e.TgZ(22,"select",13)(23,"option",14),e._uU(24,"Select"),e.qZA(),e.TgZ(25,"option",15),e._uU(26,"Information Architecture"),e.qZA(),e.TgZ(27,"option",16),e._uU(28,"UI/UX Design"),e.qZA(),e.TgZ(29,"option",17),e._uU(30,"Back End Development"),e.qZA()()()(),e.TgZ(31,"div",18)(32,"div")(33,"label",19),e._uU(34,"Access Code"),e.qZA(),e._UZ(35,"input",20),e.qZA()(),e.TgZ(36,"div",21)(37,"div")(38,"label",22),e._uU(39,"Phone Number"),e.qZA(),e._UZ(40,"input",23),e.qZA()()(),e.TgZ(41,"div",24)(42,"button",25),e._uU(43,"Apply"),e.qZA()()()()()(),e.TgZ(44,"div",0)(45,"div",4)(46,"div",5)(47,"div",8)(48,"div",26)(49,"table",27)(50,"thead")(51,"tr")(52,"th",28),e._uU(53,"Id"),e.qZA(),e.TgZ(54,"th",28),e._uU(55,"Interpreter"),e.qZA(),e.TgZ(56,"th",28),e._uU(57,"Language"),e.qZA(),e.TgZ(58,"th",28),e._uU(59,"ID"),e.qZA(),e.TgZ(60,"th",28),e._uU(61,"OPI"),e.qZA(),e.TgZ(62,"th",28),e._uU(63,"Date"),e.qZA(),e.TgZ(64,"th",28),e._uU(65,"Status"),e.qZA(),e.TgZ(66,"th",28),e._uU(67,"Action"),e.qZA()()(),e.TgZ(68,"tbody")(69,"tr")(70,"td",29),e._uU(71," Sin registros "),e.qZA()()()()()()()()())},dependencies:[u.YN,u.Kr]}),l})()},{path:"call-history",component:(()=>{class l{constructor(){this.lista=[{callstart:"08/31/2022",callend:"08/31/2022",language:"Spanish",ratexmin:"0.10",duration:"16s",avg:"19s",id:"5FF57B70F0",location:"Emergency",mrn:200025487,client:"Arenas"},{callstart:"08/31/2022",callend:"08/31/2022",language:"Spanish",ratexmin:"0.10",duration:"16s",avg:"19s",id:"5FF57B70F0",location:"Emergency",mrn:200025487,client:"Arenas"},{callstart:"08/31/2022",callend:"08/31/2022",language:"Spanish",ratexmin:"0.10",duration:"16s",avg:"19s",id:"5FF57B70F0",location:"Emergency",mrn:200025487,client:"Arenas"}]}}return l.\u0275fac=function(b){return new(b||l)},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-call-history"]],decls:86,vars:3,consts:[[1,"row"],[1,"col-12"],[1,"page-title-box","d-sm-flex","align-items-center","justify-content-between"],[1,"mb-sm-0"],[1,"col-xl-12"],[1,"card"],[1,"card-header","align-items-center","d-flex"],[1,"card-title","mb-0","flex-grow-1"],[1,"card-body"],[1,"col-md-3","mb-3"],[1,"form-label"],["aria-label","Default select example",1,"form-select","rounded-pill"],["selected",""],["value","1"],["value","2"],["value","3"],["for","customer",1,"form-label"],["type","text","id","customer",1,"form-control","rounded-pill"],["for","exampleInputdate",1,"form-label"],["type","date","id","exampleInputdate",1,"form-control","rounded-pill"],["for","exampleInputdateEnd",1,"form-label"],["type","date","id","exampleInputdateEnd",1,"form-control","rounded-pill"],[1,"text-end"],["type","button",1,"btn","rounded-pill","btn-danger","px-4","fw-medium","waves-effect","waves-light"],[1,"mt-5"],[1,"table-responsive","table-card"],[1,"table","table-nowrap","table-hover","table-striped","mb-0"],[1,"table-light"],["scope","col"],["colspan","10",1,"text-center"],[1,"row","mt-4"],[1,"col-6"],[1,"d-flex","justify-content-start","align-items-center","gap-4","ms-3"],["formControlName","limit",1,"form-select",2,"width","70px"],[3,"value"]],template:function(b,O){1&b&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),e._uU(4,"Call History"),e.qZA()()()(),e.TgZ(5,"div",0)(6,"div",4)(7,"div",5)(8,"div",6)(9,"h4",7),e._uU(10,"Filter by"),e.qZA()(),e.TgZ(11,"div",8)(12,"div",0)(13,"div",9)(14,"div")(15,"label",10),e._uU(16,"Interpreter"),e.qZA(),e.TgZ(17,"select",11)(18,"option",12),e._uU(19,"Select"),e.qZA(),e.TgZ(20,"option",13),e._uU(21,"Information Architecture"),e.qZA(),e.TgZ(22,"option",14),e._uU(23,"UI/UX Design"),e.qZA(),e.TgZ(24,"option",15),e._uU(25,"Back End Development"),e.qZA()()()(),e.TgZ(26,"div",9)(27,"div")(28,"label",16),e._uU(29,"ID"),e.qZA(),e._UZ(30,"input",17),e.qZA()(),e.TgZ(31,"div",9)(32,"div")(33,"label",18),e._uU(34,"From"),e.qZA(),e._UZ(35,"input",19),e.qZA()(),e.TgZ(36,"div",9)(37,"div")(38,"label",20),e._uU(39,"To"),e.qZA(),e._UZ(40,"input",21),e.qZA()()(),e.TgZ(41,"div",22)(42,"button",23),e._uU(43,"Apply"),e.qZA()(),e.TgZ(44,"div",24)(45,"form")(46,"div",25)(47,"table",26)(48,"thead",27)(49,"tr")(50,"th",28),e._uU(51,"Call Start"),e.qZA(),e.TgZ(52,"th",28),e._uU(53,"Call End"),e.qZA(),e.TgZ(54,"th",28),e._uU(55,"Language"),e.qZA(),e.TgZ(56,"th",28),e._uU(57,"Rate x min."),e.qZA(),e.TgZ(58,"th",28),e._uU(59,"Duration(m)"),e.qZA(),e.TgZ(60,"th",28),e._uU(61,"Avg. connect Time"),e.qZA(),e.TgZ(62,"th",28),e._uU(63,"Call ID"),e.qZA(),e.TgZ(64,"th",28),e._uU(65,"Location"),e.qZA(),e.TgZ(66,"th",28),e._uU(67,"MRN"),e.qZA(),e.TgZ(68,"th",28),e._uU(69,"Client/Patient Name"),e.qZA()()(),e.TgZ(70,"tbody")(71,"tr")(72,"td",29),e._uU(73," Sin registros "),e.qZA()()()()(),e.TgZ(74,"div",30)(75,"div",31)(76,"div",32),e._uU(77," Showing "),e.TgZ(78,"select",33)(79,"option",34),e._uU(80,"5"),e.qZA(),e.TgZ(81,"option",34),e._uU(82,"10"),e.qZA(),e.TgZ(83,"option",34),e._uU(84,"20"),e.qZA()(),e._uU(85," register "),e.qZA()()()()()()()()()),2&b&&(e.xp6(79),e.Q6J("value",5),e.xp6(2),e.Q6J("value",10),e.xp6(2),e.Q6J("value",20))},dependencies:[u._Y,u.YN,u.Kr,u.EJ,u.JJ,u.JL,u.F,u.u]}),l})()},{path:"call-handling",component:(()=>{class l{}return l.\u0275fac=function(b){return new(b||l)},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-call-handling"]],decls:65,vars:6,consts:[[1,"row"],[1,"col-12"],[1,"page-title-box","d-sm-flex","align-items-center","justify-content-between"],[1,"mb-sm-0"],[1,"col-xl-12"],[1,"card"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-striped","table-nowrap","align-middle","mb-0"],["scope","col"],[1,"hstack","gap-3","flex-wrap"],[1,"link-danger","fs-15",3,"routerLink"],[1,"ri-settings-3-line"]],template:function(b,O){1&b&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),e._uU(4,"Phone Call Handling"),e.qZA()()()(),e.TgZ(5,"div",0)(6,"div",4)(7,"div",5)(8,"div",6)(9,"div")(10,"div",7)(11,"table",8)(12,"thead")(13,"tr")(14,"th",9),e._uU(15,"Customer"),e.qZA(),e.TgZ(16,"th",9),e._uU(17,"N\xb0 Tel\xe9fono"),e.qZA(),e.TgZ(18,"th",9),e._uU(19,"Access Code"),e.qZA(),e.TgZ(20,"th",9),e._uU(21,"Action"),e.qZA()()(),e.TgZ(22,"tbody")(23,"tr")(24,"td"),e._uU(25,"Bobby Davis"),e.qZA(),e.TgZ(26,"td"),e._uU(27,"98456789"),e.qZA(),e.TgZ(28,"td")(29,"div"),e._uU(30,"#56789"),e.qZA(),e.TgZ(31,"div"),e._uU(32,"#73819"),e.qZA(),e.TgZ(33,"div"),e._uU(34,"#69123"),e.qZA()(),e.TgZ(35,"td")(36,"div",10)(37,"a",11),e._UZ(38,"i",12),e.qZA()()()(),e.TgZ(39,"tr")(40,"td"),e._uU(41,"Christopher Neal"),e.qZA(),e.TgZ(42,"td"),e._uU(43,"92456789"),e.qZA(),e.TgZ(44,"td")(45,"div"),e._uU(46,"#69123"),e.qZA()(),e.TgZ(47,"td")(48,"div",10)(49,"a",11),e._UZ(50,"i",12),e.qZA()()()(),e.TgZ(51,"tr")(52,"td"),e._uU(53,"Monkey Karry"),e.qZA(),e.TgZ(54,"td"),e._uU(55,"73456789"),e.qZA(),e.TgZ(56,"td")(57,"div"),e._uU(58,"#93078"),e.qZA(),e.TgZ(59,"div"),e._uU(60,"#53723"),e.qZA()(),e.TgZ(61,"td")(62,"div",10)(63,"a",11),e._UZ(64,"i",12),e.qZA()()()()()()()()()()()()),2&b&&(e.xp6(37),e.Q6J("routerLink",e.DdM(3,i)),e.xp6(12),e.Q6J("routerLink",e.DdM(4,i)),e.xp6(14),e.Q6J("routerLink",e.DdM(5,i)))},dependencies:[f.rH]}),l})()},{path:"call-handling-customer",component:(()=>{class l{}return l.\u0275fac=function(b){return new(b||l)},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-call-handling-customer"]],decls:151,vars:2,consts:[[1,"row"],[1,"col-12"],[1,"page-title-box","d-sm-flex","align-items-center","justify-content-between"],[1,"mb-sm-0"],[1,"page-title-right"],[1,"breadcrumb","m-0"],[1,"breadcrumb-item"],[3,"routerLink"],[1,"breadcrumb-item","active"],[1,"col-xl-12"],[1,"card"],[1,"card-header","align-items-center","d-flex"],[1,"card-title","mb-0","flex-grow-1"],[1,"card-body"],[1,"col-12","mb-3"],["for","customer",1,"form-label","me-3"],[1,"col-md-6","mb-3"],["for","customer",1,"form-label"],["type","text","id","customer",1,"form-control","rounded-pill"],[1,"form-label"],["aria-label","Default select example",1,"form-select","rounded-pill"],["selected",""],["value","1"],["value","2"],["value","3"],[1,"w-100"],["type","button","data-bs-toggle","modal","data-bs-target","#modalAddNumber",1,"btn","btn-danger","rounded-pill","px-md-5","fw-medium","custom-toggle"],[1,"col-md-6"],[1,"table-responsive"],[1,"table","table-striped","table-nowrap","align-middle","mb-0"],["scope","col"],[1,"form-check"],["type","checkbox","value","","id","cardtableCheck01",1,"form-check-input"],["for","cardtableCheck01",1,"form-check-label"],[1,"hstack","gap-3","flex-wrap"],["href","#","data-bs-toggle","modal","data-bs-target","#modalAddNumber",1,"link-success","fs-15"],[1,"ri-edit-2-line"],["href","javascript:void(0);",1,"link-danger","fs-15"],[1,"ri-delete-bin-line"],["id","modalAddNumber","tabindex","-1","aria-labelledby","exampleModalgridLabel","aria-modal","true","role","dialog",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header","bg-dark","p-3"],["id","exampleModalgridLabel",1,"modal-title","text-white","fw-medium"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],["action","javascript:void(0);"],[1,"row","g-3"],["for","firstName",1,"form-label"],["type","number","id","firstName","placeholder","Enter new number telephone",1,"form-control"],[1,"col-lg-12"],[1,"hstack","gap-2","justify-content-end"],["type","submit",1,"btn","btn-danger","rounded-pill","fw-medium","custom-toggle"]],template:function(b,O){1&b&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),e._uU(4,"Phone Call Handling of Customer"),e.qZA(),e.TgZ(5,"div",4)(6,"ol",5)(7,"li",6)(8,"a",7),e._uU(9,"Phone Call Handling"),e.qZA()(),e.TgZ(10,"li",8),e._uU(11,"Customers"),e.qZA()()()()()(),e.TgZ(12,"div",0)(13,"div",9)(14,"div",10)(15,"div",11)(16,"h4",12),e._uU(17,"Business Hours"),e.qZA()(),e.TgZ(18,"div",13)(19,"div",0)(20,"div",14)(21,"div")(22,"label",15)(23,"strong"),e._uU(24,"24 Hours a Day, 7 Days a Week"),e.qZA()()()(),e.TgZ(25,"div",16)(26,"div")(27,"label",17),e._uU(28,"Call Handling"),e.qZA(),e._UZ(29,"input",18),e.qZA()(),e.TgZ(30,"div",16)(31,"div")(32,"label",19),e._uU(33,"Call Handling Ring Mode"),e.qZA(),e.TgZ(34,"select",20)(35,"option",21),e._uU(36,"Simultaneous"),e.qZA(),e.TgZ(37,"option",22),e._uU(38,"Information Architecture"),e.qZA(),e.TgZ(39,"option",23),e._uU(40,"UI/UX Design"),e.qZA(),e.TgZ(41,"option",24),e._uU(42,"Back End Development"),e.qZA()()()(),e.TgZ(43,"div",16)(44,"div")(45,"label",19),e._uU(46,"Max. Wait Time"),e.qZA(),e.TgZ(47,"select",20)(48,"option",21),e._uU(49,"30 seconds"),e.qZA(),e.TgZ(50,"option",22),e._uU(51,"30 seconds"),e.qZA(),e.TgZ(52,"option",23),e._uU(53,"30 seconds"),e.qZA(),e.TgZ(54,"option",24),e._uU(55,"30 seconds"),e.qZA()()()(),e.TgZ(56,"div",16)(57,"div")(58,"label",19),e._uU(59,"Greeting & Leave voicemall instruction"),e.qZA(),e.TgZ(60,"select",20)(61,"option",21),e._uU(62,"Default"),e.qZA(),e.TgZ(63,"option",22),e._uU(64,"30 seconds"),e.qZA()()()(),e.TgZ(65,"div",16)(66,"div")(67,"label",19),e._uU(68,"When a call is not answered"),e.qZA(),e.TgZ(69,"select",20)(70,"option",21),e._uU(71,"Forward to voicemail"),e.qZA(),e.TgZ(72,"option",22),e._uU(73,"Forward External Number"),e.qZA()()()(),e.TgZ(74,"div",16)(75,"div")(76,"label",19),e._uU(77,"\xa0"),e.qZA(),e.TgZ(78,"div",25)(79,"button",26),e._uU(80,"+ Add Number"),e.qZA()()()(),e.TgZ(81,"div",27)(82,"div",28)(83,"table",29)(84,"thead")(85,"tr")(86,"th"),e._uU(87,"Seleccione N\xb0"),e.qZA(),e.TgZ(88,"th",30),e._uU(89,"N\xb0 Tel\xe9fono"),e.qZA(),e.TgZ(90,"th",30),e._uU(91,"Action"),e.qZA()()(),e.TgZ(92,"tbody")(93,"tr")(94,"td")(95,"div",31),e._UZ(96,"input",32)(97,"label",33),e.qZA()(),e.TgZ(98,"td"),e._uU(99,"98456789"),e.qZA(),e.TgZ(100,"td")(101,"div",34)(102,"a",35),e._UZ(103,"i",36),e.qZA(),e.TgZ(104,"a",37),e._UZ(105,"i",38),e.qZA()()()(),e.TgZ(106,"tr")(107,"td")(108,"div",31),e._UZ(109,"input",32)(110,"label",33),e.qZA()(),e.TgZ(111,"td"),e._uU(112,"92456789"),e.qZA(),e.TgZ(113,"td")(114,"div",34)(115,"a",35),e._UZ(116,"i",36),e.qZA(),e.TgZ(117,"a",37),e._UZ(118,"i",38),e.qZA()()()(),e.TgZ(119,"tr")(120,"td")(121,"div",31),e._UZ(122,"input",32)(123,"label",33),e.qZA()(),e.TgZ(124,"td"),e._uU(125,"73456789"),e.qZA(),e.TgZ(126,"td")(127,"div",34)(128,"a",35),e._UZ(129,"i",36),e.qZA(),e.TgZ(130,"a",37),e._UZ(131,"i",38),e.qZA()()()()()()()()()()()()(),e.TgZ(132,"div",39)(133,"div",40)(134,"div",41)(135,"div",42)(136,"h5",43),e._uU(137,"Add Number"),e.qZA(),e._UZ(138,"button",44),e.qZA(),e.TgZ(139,"div",45)(140,"form",46)(141,"div",47)(142,"div",1)(143,"div")(144,"label",48),e._uU(145,"N\xb0 Telephone"),e.qZA(),e._UZ(146,"input",49),e.qZA()(),e.TgZ(147,"div",50)(148,"div",51)(149,"button",52),e._uU(150,"Save"),e.qZA()()()()()()()()()),2&b&&(e.xp6(8),e.Q6J("routerLink",e.DdM(1,t)))},dependencies:[u._Y,u.YN,u.Kr,u.JL,u.F,f.rH]}),l})()},{path:"**",component:T.T}];let v=(()=>{class l{}return l.\u0275fac=function(b){return new(b||l)},l.\u0275mod=e.oAB({type:l}),l.\u0275inj=e.cJS({imports:[f.Bz.forChild(r),f.Bz]}),l})()},5128:(N,h,p)=>{"use strict";h.AS=h.Ig=void 0;var e=p(5487);h.Ig=e.default;var E=p(1915);h.AS=E.default,p(1287);p(990),p(8579)},1976:function(N,h,p){"use strict";var f=this&&this.__awaiter||function(A,S,C,g){return new(C||(C=Promise))(function(u,c){function m(i){try{o(g.next(i))}catch(n){c(n)}}function s(i){try{o(g.throw(i))}catch(n){c(n)}}function o(i){i.done?u(i.value):function T(u){return u instanceof C?u:new C(function(c){c(u)})}(i.value).then(m,s)}o((g=g.apply(A,S||[])).next())})},e=this&&this.__generator||function(A,S){var g,T,u,c,C={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return c={next:m(0),throw:m(1),return:m(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function m(o){return function(i){return function s(o){if(g)throw new TypeError("Generator is already executing.");for(;C;)try{if(g=1,T&&(u=2&o[0]?T.return:o[0]?T.throw||((u=T.return)&&u.call(T),0):T.next)&&!(u=u.call(T,o[1])).done)return u;switch(T=0,u&&(o=[2&o[0],u.value]),o[0]){case 0:case 1:u=o;break;case 4:return C.label++,{value:o[1],done:!1};case 5:C.label++,T=o[1],o=[0];continue;case 7:o=C.ops.pop(),C.trys.pop();continue;default:if(!(u=(u=C.trys).length>0&&u[u.length-1])&&(6===o[0]||2===o[0])){C=0;continue}if(3===o[0]&&(!u||o[1]>u[0]&&o[1]<u[3])){C.label=o[1];break}if(6===o[0]&&C.label<u[1]){C.label=u[1],u=o;break}if(u&&C.label<u[2]){C.label=u[2],C.ops.push(o);break}u[2]&&C.ops.pop(),C.trys.pop();continue}o=S.call(A,C)}catch(i){o=[6,i],T=0}finally{g=u=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};Object.defineProperty(h,"__esModule",{value:!0}),h.AsyncQueue=void 0;var E=p(765),_=function(){function A(){this._operations=[]}return A.prototype.enqueue=function(S){var C=!!this._operations.length,g=new E.default;return this._operations.push({deferred:g,callback:S}),C||this._processQueue(),g.promise},A.prototype._processQueue=function(){return f(this,void 0,void 0,function(){var S,C,g,T,u,c,m;return e(this,function(s){switch(s.label){case 0:if(!this._operations.length)return[3,5];C=(S=this._operations[0]).deferred,g=S.callback,T=void 0,u=void 0,c=void 0,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,g()];case 2:return T=s.sent(),c=!0,[3,4];case 3:return m=s.sent(),u=m,[3,4];case 4:return this._operations.shift(),c?C.resolve(T):C.reject(u),[3,0];case 5:return[2]}})})},A}();h.AsyncQueue=_},6170:function(N,h,p){"use strict";var m,f=this&&this.__extends||(m=function(s,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(i[t]=n[t])})(s,o)},function(s,o){function i(){this.constructor=s}m(s,o),s.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0});var e=p(2016),E=p(1915),_=p(1287),A=p(990),S=p(6178),C=p(4199),g=p(6292),T=p(9819),u={audioinput:"Audio Input",audiooutput:"Audio Output"},c=function(m){function s(o,i,n,t){var a,r=m.call(this)||this;r.availableInputDevices=new Map,r.availableOutputDevices=new Map,r._audioConstraints=null,r._enabledSounds=((a={})[E.default.SoundName.Disconnect]=!0,a[E.default.SoundName.Incoming]=!0,a[E.default.SoundName.Outgoing]=!0,a),r._inputDevice=null,r._inputStream=null,r._isPollingInputVolume=!1,r._log=A.default.getInstance(),r._unknownDeviceIndexes={audioinput:{},audiooutput:{}},r._removeLostInput=function(b){if(!r.inputDevice||r.inputDevice.deviceId!==b.deviceId)return!1;r._replaceStream(null),r._inputDevice=null,r._maybeStopPollingVolume();var O=r.availableInputDevices.get("default")||Array.from(r.availableInputDevices.values())[0];return O&&r.setInputDevice(O.deviceId),!0},r._removeLostOutput=function(b){var O=r.speakerDevices.delete(b),x=r.ringtoneDevices.delete(b);return O||x},r._updateAvailableDevices=function(){return r._mediaDevices&&r._enumerateDevices?r._enumerateDevices().then(function(b){r._updateDevices(b.filter(function(x){return"audiooutput"===x.kind}),r.availableOutputDevices,r._removeLostOutput),r._updateDevices(b.filter(function(x){return"audioinput"===x.kind}),r.availableInputDevices,r._removeLostInput);var O=r.availableOutputDevices.get("default")||Array.from(r.availableOutputDevices.values())[0];[r.speakerDevices,r.ringtoneDevices].forEach(function(x){!x.get().size&&r.availableOutputDevices.size&&r.isOutputSelectionSupported&&x.set(O.deviceId).catch(function(Z){r._log.warn("Unable to set audio output devices. "+Z)})})}):Promise.reject("Enumeration not supported")},t=Object.assign({AudioContext:typeof AudioContext<"u"&&AudioContext,setSinkId:typeof HTMLAudioElement<"u"&&HTMLAudioElement.prototype.setSinkId},t),r._getUserMedia=n,r._mediaDevices=t.mediaDevices||g.default(),r._onActiveInputChanged=i,r._enumerateDevices="function"==typeof t.enumerateDevices?t.enumerateDevices:r._mediaDevices&&r._mediaDevices.enumerateDevices;var v=!(!t.AudioContext&&!t.audioContext),l=!!r._enumerateDevices;return t.enabledSounds&&(r._enabledSounds=t.enabledSounds),r.isOutputSelectionSupported=l&&"function"==typeof t.setSinkId,r.isVolumeSupported=v,r.isVolumeSupported&&(r._audioContext=t.audioContext||t.AudioContext&&new t.AudioContext,r._audioContext&&(r._inputVolumeAnalyser=r._audioContext.createAnalyser(),r._inputVolumeAnalyser.fftSize=32,r._inputVolumeAnalyser.smoothingTimeConstant=.3)),r.ringtoneDevices=new S.default("ringtone",r.availableOutputDevices,o,r.isOutputSelectionSupported),r.speakerDevices=new S.default("speaker",r.availableOutputDevices,o,r.isOutputSelectionSupported),r.addListener("newListener",function(b){"inputVolume"===b&&r._maybeStartPollingVolume()}),r.addListener("removeListener",function(b){"inputVolume"===b&&r._maybeStopPollingVolume()}),r.once("newListener",function(){r.isOutputSelectionSupported||r._log.warn("Warning: This browser does not support audio output selection."),r.isVolumeSupported||r._log.warn("Warning: This browser does not support Twilio's volume indicator feature.")}),l&&r._initializeEnumeration(),r}return f(s,m),Object.defineProperty(s.prototype,"audioConstraints",{get:function(){return this._audioConstraints},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"inputDevice",{get:function(){return this._inputDevice},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"inputStream",{get:function(){return this._inputStream},enumerable:!1,configurable:!0}),s.prototype._getEnabledSounds=function(){return this._enabledSounds},s.prototype._maybeStartPollingVolume=function(){var o=this;if(this.isVolumeSupported&&this._inputStream&&(this._updateVolumeSource(),!this._isPollingInputVolume&&this._inputVolumeAnalyser)){var n=new Uint8Array(this._inputVolumeAnalyser.frequencyBinCount);this._isPollingInputVolume=!0;var t=function(){if(o._isPollingInputVolume){if(o._inputVolumeAnalyser){o._inputVolumeAnalyser.getByteFrequencyData(n);var a=T.average(n);o.emit("inputVolume",a/255)}requestAnimationFrame(t)}};requestAnimationFrame(t)}},s.prototype._maybeStopPollingVolume=function(){this.isVolumeSupported&&(!this._isPollingInputVolume||this._inputStream&&this.listenerCount("inputVolume")||(this._inputVolumeSource&&(this._inputVolumeSource.disconnect(),delete this._inputVolumeSource),this._isPollingInputVolume=!1))},s.prototype._unbind=function(){if(!this._mediaDevices||!this._enumerateDevices)throw new _.NotSupportedError("Enumeration is not supported");this._mediaDevices.removeEventListener&&(this._mediaDevices.removeEventListener("devicechange",this._updateAvailableDevices),this._mediaDevices.removeEventListener("deviceinfochange",this._updateAvailableDevices))},s.prototype.disconnect=function(o){return this._maybeEnableSound(E.default.SoundName.Disconnect,o)},s.prototype.incoming=function(o){return this._maybeEnableSound(E.default.SoundName.Incoming,o)},s.prototype.outgoing=function(o){return this._maybeEnableSound(E.default.SoundName.Outgoing,o)},s.prototype.setAudioConstraints=function(o){return this._audioConstraints=Object.assign({},o),delete this._audioConstraints.deviceId,this.inputDevice?this._setInputDevice(this.inputDevice.deviceId,!0):Promise.resolve()},s.prototype.setInputDevice=function(o){return T.isFirefox()?Promise.reject(new _.NotSupportedError("Firefox does not currently support opening multiple audio input tracks simultaneously, even across different tabs. As a result, Device.audio.setInputDevice is disabled on Firefox until support is added.\nRelated BugZilla thread: https://bugzilla.mozilla.org/show_bug.cgi?id=1299324")):this._setInputDevice(o,!1)},s.prototype.unsetAudioConstraints=function(){return this._audioConstraints=null,this.inputDevice?this._setInputDevice(this.inputDevice.deviceId,!0):Promise.resolve()},s.prototype.unsetInputDevice=function(){var o=this;return this.inputDevice?this._onActiveInputChanged(null).then(function(){o._replaceStream(null),o._inputDevice=null,o._maybeStopPollingVolume()}):Promise.resolve()},s.prototype._getUnknownDeviceIndex=function(o){var i=o.deviceId,n=o.kind,t=this._unknownDeviceIndexes[n][i];return t||(t=Object.keys(this._unknownDeviceIndexes[n]).length+1,this._unknownDeviceIndexes[n][i]=t),t},s.prototype._initializeEnumeration=function(){var o=this;if(!this._mediaDevices||!this._enumerateDevices)throw new _.NotSupportedError("Enumeration is not supported");this._mediaDevices.addEventListener&&(this._mediaDevices.addEventListener("devicechange",this._updateAvailableDevices),this._mediaDevices.addEventListener("deviceinfochange",this._updateAvailableDevices)),this._updateAvailableDevices().then(function(){o.isOutputSelectionSupported&&Promise.all([o.speakerDevices.set("default"),o.ringtoneDevices.set("default")]).catch(function(i){o._log.warn("Warning: Unable to set audio output devices. "+i)})})},s.prototype._maybeEnableSound=function(o,i){return typeof i<"u"&&(this._enabledSounds[o]=i),this._enabledSounds[o]},s.prototype._replaceStream=function(o){this._inputStream&&this._inputStream.getTracks().forEach(function(i){i.stop()}),this._inputStream=o},s.prototype._setInputDevice=function(o,i){var n=this;if("string"!=typeof o)return Promise.reject(new _.InvalidArgumentError("Must specify the device to set"));var t=this.availableInputDevices.get(o);if(!t)return Promise.reject(new _.InvalidArgumentError("Device not found: "+o));if(this._inputDevice&&this._inputDevice.deviceId===o&&this._inputStream){if(!i)return Promise.resolve();this._inputStream.getTracks().forEach(function(r){r.stop()})}var a={audio:Object.assign({deviceId:{exact:o}},this.audioConstraints)};return this._getUserMedia(a).then(function(r){return n._onActiveInputChanged(r).then(function(){n._replaceStream(r),n._inputDevice=t,n._maybeStartPollingVolume()})})},s.prototype._updateDevices=function(o,i,n){var t=this,a=o.map(function(b){return b.deviceId}),r=Array.from(i.values()).map(function(b){return b.deviceId}),v=[],l=T.difference(r,a);l.forEach(function(b){var O=i.get(b);O&&(i.delete(b),n(O)&&v.push(O))});var y=!1;o.forEach(function(b){var O=i.get(b.deviceId),x=t._wrapMediaDeviceInfo(b);(!O||O.label!==x.label)&&(i.set(b.deviceId,x),y=!0)}),(y||l.length)&&(null!==this.inputDevice&&"default"===this.inputDevice.deviceId&&(this._log.warn("Calling getUserMedia after device change to ensure that the           tracks of the active device (default) have not gone stale."),this._setInputDevice(this.inputDevice.deviceId,!0)),this.emit("deviceChange",v))},s.prototype._updateVolumeSource=function(){if(this._inputStream&&this._audioContext&&this._inputVolumeAnalyser){this._inputVolumeSource&&this._inputVolumeSource.disconnect();try{this._inputVolumeSource=this._audioContext.createMediaStreamSource(this._inputStream),this._inputVolumeSource.connect(this._inputVolumeAnalyser)}catch(o){this._log.warn("Unable to update volume source",o),delete this._inputVolumeSource}}},s.prototype._wrapMediaDeviceInfo=function(o){var i={deviceId:o.deviceId,groupId:o.groupId,kind:o.kind,label:o.label};if(!i.label)if("default"===i.deviceId)i.label="Default";else{var n=this._getUnknownDeviceIndex(o);i.label="Unknown "+u[i.kind]+" Device "+n}return new C.default(i)},s}(e.EventEmitter);c||(c={}),h.default=c},5358:function(N,h,p){"use strict";var g,f=this&&this.__extends||(g=function(T,u){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,m){c.__proto__=m}||function(c,m){for(var s in m)Object.prototype.hasOwnProperty.call(m,s)&&(c[s]=m[s])})(T,u)},function(T,u){function c(){this.constructor=T}g(T,u),T.prototype=null===u?Object.create(u):(c.prototype=u.prototype,new c)}),e=this&&this.__awaiter||function(g,T,u,c){return new(u||(u=Promise))(function(s,o){function i(a){try{t(c.next(a))}catch(r){o(r)}}function n(a){try{t(c.throw(a))}catch(r){o(r)}}function t(a){a.done?s(a.value):function m(s){return s instanceof u?s:new u(function(o){o(s)})}(a.value).then(i,n)}t((c=c.apply(g,T||[])).next())})},E=this&&this.__generator||function(g,T){var c,m,s,o,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(t){return function(a){return function n(t){if(c)throw new TypeError("Generator is already executing.");for(;u;)try{if(c=1,m&&(s=2&t[0]?m.return:t[0]?m.throw||((s=m.return)&&s.call(m),0):m.next)&&!(s=s.call(m,t[1])).done)return s;switch(m=0,s&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,m=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=(s=u.trys).length>0&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){u.label=t[1];break}if(6===t[0]&&u.label<s[1]){u.label=s[1],s=t;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(t);break}s[2]&&u.ops.pop(),u.trys.pop();continue}t=T.call(g,u)}catch(a){t=[6,a],m=0}finally{c=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,a])}}};Object.defineProperty(h,"__esModule",{value:!0});var _=p(3148),S=function(g){function T(u,c,m){void 0===c&&(c={}),void 0===m&&(m={});var s=g.call(this)||this;return s._audioNode=null,s._loop=!1,s._pendingPlayDeferreds=[],s._sinkId="default",s._src="","string"!=typeof c&&(m=c),s._audioContext=u,s._audioElement=new(m.AudioFactory||Audio),s._bufferPromise=s._createPlayDeferred().promise,s._destination=s._audioContext.destination,s._gainNode=s._audioContext.createGain(),s._gainNode.connect(s._destination),s._XMLHttpRequest=m.XMLHttpRequestFactory||XMLHttpRequest,s.addEventListener("canplaythrough",function(){s._resolvePlayDeferreds()}),"string"==typeof c&&(s.src=c),s}return f(T,g),Object.defineProperty(T.prototype,"destination",{get:function(){return this._destination},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"loop",{get:function(){return this._loop},set:function(u){var c=this;!u&&this.loop&&!this.paused&&this._audioNode.addEventListener("ended",function m(){c._audioNode.removeEventListener("ended",m),c.pause()}),this._loop=u},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"muted",{get:function(){return 0===this._gainNode.gain.value},set:function(u){this._gainNode.gain.value=u?0:1},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"paused",{get:function(){return null===this._audioNode},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"src",{get:function(){return this._src},set:function(u){this._load(u)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"srcObject",{get:function(){return this._audioElement.srcObject},set:function(u){this._audioElement.srcObject=u},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"sinkId",{get:function(){return this._sinkId},enumerable:!1,configurable:!0}),T.prototype.load=function(){this._load(this._src)},T.prototype.pause=function(){this.paused||(this._audioElement.pause(),this._audioNode.stop(),this._audioNode.disconnect(this._gainNode),this._audioNode=null,this._rejectPlayDeferreds(new Error("The play() request was interrupted by a call to pause().")))},T.prototype.play=function(){return e(this,void 0,void 0,function(){var u,c=this;return E(this,function(m){switch(m.label){case 0:return this.paused?[3,2]:[4,this._bufferPromise];case 1:if(m.sent(),!this.paused)return[2];throw new Error("The play() request was interrupted by a call to pause().");case 2:return this._audioNode=this._audioContext.createBufferSource(),this._audioNode.loop=this.loop,this._audioNode.addEventListener("ended",function(){c._audioNode&&c._audioNode.loop||c.dispatchEvent("ended")}),[4,this._bufferPromise];case 3:if(u=m.sent(),this.paused)throw new Error("The play() request was interrupted by a call to pause().");return this._audioNode.buffer=u,this._audioNode.connect(this._gainNode),this._audioNode.start(),this._audioElement.srcObject?[2,this._audioElement.play()]:[2]}})})},T.prototype.setSinkId=function(u){return e(this,void 0,void 0,function(){return E(this,function(c){switch(c.label){case 0:if("function"!=typeof this._audioElement.setSinkId)throw new Error("This browser does not support setSinkId.");return u===this.sinkId?[2]:"default"===u?(this.paused||this._gainNode.disconnect(this._destination),this._audioElement.srcObject=null,this._destination=this._audioContext.destination,this._gainNode.connect(this._destination),this._sinkId=u,[2]):[4,this._audioElement.setSinkId(u)];case 1:return c.sent(),this._audioElement.srcObject||(this._gainNode.disconnect(this._audioContext.destination),this._destination=this._audioContext.createMediaStreamDestination(),this._audioElement.srcObject=this._destination.stream,this._sinkId=u,this._gainNode.connect(this._destination)),[2]}})})},T.prototype._createPlayDeferred=function(){var u=new _.default;return this._pendingPlayDeferreds.push(u),u},T.prototype._load=function(u){var c=this;this._src&&this._src!==u&&this.pause(),this._src=u,this._bufferPromise=new Promise(function(m,s){return e(c,void 0,void 0,function(){var o;return E(this,function(i){switch(i.label){case 0:return u?[4,C(this._audioContext,this._XMLHttpRequest,u)]:[2,this._createPlayDeferred().promise];case 1:return o=i.sent(),this.dispatchEvent("canplaythrough"),m(o),[2]}})})})},T.prototype._rejectPlayDeferreds=function(u){var c=this._pendingPlayDeferreds;c.splice(0,c.length).forEach(function(m){return(0,m.reject)(u)})},T.prototype._resolvePlayDeferreds=function(u){var c=this._pendingPlayDeferreds;c.splice(0,c.length).forEach(function(m){return(0,m.resolve)(u)})},T}(p(8094).default);function C(g,T,u){return e(this,void 0,void 0,function(){var c,m;return E(this,function(s){switch(s.label){case 0:return(c=new T).open("GET",u,!0),c.responseType="arraybuffer",[4,new Promise(function(o){c.addEventListener("load",o),c.send()})];case 1:m=s.sent();try{return[2,g.decodeAudioData(m.target.response)]}catch{return[2,new Promise(function(i){g.decodeAudioData(m.target.response,i)})]}return[2]}})})}h.default=S},3148:(N,h)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var p=function(){function f(){var e=this;this.promise=new Promise(function(E,_){e._resolve=E,e._reject=_})}return Object.defineProperty(f.prototype,"reject",{get:function(){return this._reject},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"resolve",{get:function(){return this._resolve},enumerable:!1,configurable:!0}),f}();h.default=p},8094:function(N,h,p){"use strict";var f=this&&this.__spreadArrays||function(){for(var _=0,A=0,S=arguments.length;A<S;A++)_+=arguments[A].length;var C=Array(_),g=0;for(A=0;A<S;A++)for(var T=arguments[A],u=0,c=T.length;u<c;u++,g++)C[g]=T[u];return C};Object.defineProperty(h,"__esModule",{value:!0});var e=p(2016),E=function(){function _(){this._eventEmitter=new e.EventEmitter}return _.prototype.addEventListener=function(A,S){return this._eventEmitter.addListener(A,S)},_.prototype.dispatchEvent=function(A){for(var S,C=[],g=1;g<arguments.length;g++)C[g-1]=arguments[g];return(S=this._eventEmitter).emit.apply(S,f([A],C))},_.prototype.removeEventListener=function(A,S){return this._eventEmitter.removeListener(A,S)},_}();h.default=E},8039:function(N,h,p){"use strict";var _,f=this&&this.__extends||(_=function(A,S){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,g){C.__proto__=g}||function(C,g){for(var T in g)Object.prototype.hasOwnProperty.call(g,T)&&(C[T]=g[T])})(A,S)},function(A,S){function C(){this.constructor=A}_(A,S),A.prototype=null===S?Object.create(S):(C.prototype=S.prototype,new C)});Object.defineProperty(h,"__esModule",{value:!0});var E=function(_){function A(S){var C=_.call(this)||this;return Object.defineProperties(C,{_attempts:{value:0,writable:!0},_duration:{enumerable:!1,get:function(){var g=this._min*Math.pow(this._factor,this._attempts);if(this._jitter){var T=Math.random(),u=Math.floor(T*this._jitter*g);g=1&Math.floor(10*T)?g+u:g-u}return 0|Math.min(g,this._max)}},_factor:{value:S.factor||2},_jitter:{value:S.jitter>0&&S.jitter<=1?S.jitter:0},_max:{value:S.max||1e4},_min:{value:S.min||100},_timeoutID:{value:null,writable:!0}}),C}return f(A,_),A.prototype.backoff=function(){var S=this,C=this._duration;this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null),this.emit("backoff",this._attempts,C),this._timeoutID=setTimeout(function(){S.emit("ready",S._attempts,C),S._attempts++},C)},A.prototype.reset=function(){this._attempts=0,this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null)},A}(p(2016).EventEmitter);h.default=E},5487:function(N,h,p){"use strict";var L,f=this&&this.__extends||(L=function(w,P){return(L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,d){R.__proto__=d}||function(R,d){for(var I in d)Object.prototype.hasOwnProperty.call(d,I)&&(R[I]=d[I])})(w,P)},function(w,P){function R(){this.constructor=w}L(w,P),w.prototype=null===P?Object.create(P):(R.prototype=P.prototype,new R)}),e=this&&this.__assign||function(){return e=Object.assign||function(L){for(var w,P=1,R=arguments.length;P<R;P++)for(var d in w=arguments[P])Object.prototype.hasOwnProperty.call(w,d)&&(L[d]=w[d]);return L},e.apply(this,arguments)};Object.defineProperty(h,"__esModule",{value:!0});var E=p(2016),_=p(8039),A=p(1915),S=p(1287),C=p(990),g=p(6813),T=p(9168),u=p(2563),c=p(8753),m=p(9819),s=p(8941),o=p(186),i={factor:1.1,jitter:.5,max:3e4,min:1},l={disconnect:!0,info:{code:31003,message:"Connection with Twilio was interrupted.",twilioError:new S.MediaErrors.ConnectionError}},y={packetsLostFraction:{max:"packet-loss",maxAverage:"packets-lost-fraction"}},b={audioInputLevel:"audio-input-level",audioOutputLevel:"audio-output-level",bytesReceived:"bytes-received",bytesSent:"bytes-sent",jitter:"jitter",mos:"mos",rtt:"rtt"},O={max:"high-",maxAverage:"high-",maxDuration:"constant-",min:"low-",minStandardDeviation:"constant-"},x=function(L){function w(P,R){var d=L.call(this)||this;d.parameters={},d._inputVolumeStreak=0,d._isAnswered=!1,d._isCancelled=!1,d._isRejected=!1,d._latestInputVolume=0,d._latestOutputVolume=0,d._log=C.default.getInstance(),d._mediaStatus=w.State.Pending,d._messages=new Map,d._metricsSamples=[],d._options={MediaHandler:g.PeerConnection,offerSdp:null,shouldPlayDisconnect:function(){return!0},voiceEventSidGenerator:s.generateVoiceEventSid},d._outputVolumeStreak=0,d._shouldSendHangup=!0,d._signalingStatus=w.State.Pending,d._soundcache=new Map,d._status=w.State.Pending,d._wasConnected=!1,d.toString=function(){return"[Twilio.Call instance]"},d._emitWarning=function(k,D,M,j,H,B){var G=k+"warning"+(H?"-cleared":"-raised");if("constant-audio-input-level"!==D||!d.isMuted()){var V=H?"info":"warning";"constant-audio-output-level"===D&&(V="info");var W={threshold:M};j&&(j instanceof Array?W.values=j.map(function(K){return"number"==typeof K?Math.round(100*K)/100:j}):W.value=j),d._publisher.post(V,G,D,{data:W},d),"constant-audio-output-level"!==D&&d.emit(H?"warning-cleared":"warning",D,B&&!H?B:null)}},d._onAck=function(k){var M=k.callsid;d.parameters.CallSid===M?"message"===k.acktype&&d._onMessageSent(k.voiceeventsid):d._log.warn("Received ack from a different callsid: "+M)},d._onAnswer=function(k){"string"==typeof k.reconnect&&(d._signalingReconnectToken=k.reconnect),(!d._isAnswered||d._status===w.State.Reconnecting)&&(d._setCallSid(k),d._isAnswered=!0,d._maybeTransitionToOpen())},d._onCancel=function(k){d.parameters.CallSid===k.callsid&&(d._isCancelled=!0,d._publisher.info("connection","cancel",null,d),d._cleanupEventListeners(),d._mediaHandler.close(),d._status=w.State.Closed,d.emit("cancel"),d._pstream.removeListener("cancel",d._onCancel))},d._onConnected=function(){d._log.info("Received connected from pstream"),d._signalingReconnectToken&&d._pstream.reconnect(d._mediaHandler.version.getSDP(),d.parameters.CallSid,d._signalingReconnectToken)},d._onHangup=function(k){if(d.status()!==w.State.Closed){if(k.callsid&&(d.parameters.CallSid||d.outboundConnectionId)){if(k.callsid!==d.parameters.CallSid&&k.callsid!==d.outboundConnectionId)return}else if(k.callsid)return;if(d._log.info("Received HANGUP from gateway"),k.error){var D=new S.GeneralErrors.ConnectionError("Error sent from gateway in HANGUP");d._log.error("Received an error from the gateway:",D),d.emit("error",D)}d._shouldSendHangup=!1,d._publisher.info("connection","disconnected-by-remote",null,d),d._disconnect(null,!0),d._cleanupEventListeners()}},d._onMediaFailure=function(k){var D=w.MediaFailure,M=D.ConnectionDisconnected,j=D.ConnectionFailed,B=D.LowBytes,q=k===j||k===D.IceGatheringFailed;if(!m.isChrome(window,window.navigator)&&k===j)return d._mediaHandler.onerror(l);if(d._mediaStatus!==w.State.Reconnecting){var G=d._mediaHandler.version.pc,V=G&&"disconnected"===G.iceConnectionState,W=d._monitor.hasActiveWarning("bytesSent","min")||d._monitor.hasActiveWarning("bytesReceived","min");if(k===B&&V||k===M&&W||q){var J=new S.MediaErrors.ConnectionError("Media connection failed.");d._log.warn("ICE Connection disconnected."),d._publisher.warn("connection","error",J,d),d._publisher.info("connection","reconnecting",null,d),d._mediaReconnectStartTime=Date.now(),d._status=w.State.Reconnecting,d._mediaStatus=w.State.Reconnecting,d._mediaReconnectBackoff.reset(),d._mediaReconnectBackoff.backoff(),d.emit("reconnecting",J)}}else if(q){if(Date.now()-d._mediaReconnectStartTime>i.max)return d._log.info("Exceeded max ICE retries"),d._mediaHandler.onerror(l);try{d._mediaReconnectBackoff.backoff()}catch(K){if(!K.message||"Backoff in progress."!==K.message)throw K}}},d._onMediaReconnected=function(){d._mediaStatus===w.State.Reconnecting&&(d._log.info("ICE Connection reestablished."),d._mediaStatus=w.State.Open,d._signalingStatus===w.State.Open&&(d._publisher.info("connection","reconnected",null,d),d.emit("reconnected"),d._status=w.State.Open))},d._onMessageReceived=function(k){var D=k.callsid;d.parameters.CallSid===D?d.emit("messageReceived",{content:k.content,contentType:k.contenttype,messageType:k.messagetype,voiceEventSid:k.voiceeventsid}):d._log.warn("Received a message from a different callsid: "+D)},d._onMessageSent=function(k){if(d._messages.has(k)){var D=d._messages.get(k);d._messages.delete(k),d.emit("messageSent",D)}else d._log.warn("Received a messageSent with a voiceEventSid that doesn't exists: "+k)},d._onRinging=function(k){if(d._setCallSid(k),d._status===w.State.Connecting||d._status===w.State.Ringing){var D=!!k.sdp;d._status=w.State.Ringing,d._publisher.info("connection","outgoing-ringing",{hasEarlyMedia:D},d),d.emit("ringing",D)}},d._onRTCSample=function(k){var D=e(e({},k),{inputVolume:d._latestInputVolume,outputVolume:d._latestOutputVolume});d._codec=D.codecName,d._metricsSamples.push(D),d._metricsSamples.length>=10&&d._publishMetrics(),d.emit("sample",k)},d._onSignalingError=function(k){var D=k.callsid,M=k.voiceeventsid;d.parameters.CallSid===D?M&&d._messages.has(M)&&(d._messages.delete(M),d._log.warn("Received an error while sending a message.",k)):d._log.warn("Received an error from a different callsid: "+D)},d._onSignalingReconnected=function(){d._signalingStatus===w.State.Reconnecting&&(d._log.info("Signaling Connection reestablished."),d._signalingStatus=w.State.Open,d._mediaStatus===w.State.Open&&(d._publisher.info("connection","reconnected",null,d),d.emit("reconnected"),d._status=w.State.Open))},d._onTransportClose=function(){d._log.error("Received transportClose from pstream"),d.emit("transportClose"),d._signalingReconnectToken?(d._status=w.State.Reconnecting,d._signalingStatus=w.State.Reconnecting,d.emit("reconnecting",new S.SignalingErrors.ConnectionDisconnected)):(d._status=w.State.Closed,d._signalingStatus=w.State.Closed)},d._reemitWarning=function(k,D){var H,M=/^audio/.test(k.name)?"audio-level-":"network-quality-";k.name in y?H=y[k.name][k.threshold.name]:k.name in b&&(H=b[k.name]),d._emitWarning(M,O[k.threshold.name]+H,k.threshold.value,k.values||k.value,D,k)},d._reemitWarningCleared=function(k){d._reemitWarning(k,!0)},d._isUnifiedPlanDefault=P.isUnifiedPlanDefault,d._soundcache=P.soundcache,"function"==typeof P.onIgnore&&(d._onIgnore=P.onIgnore),d.customParameters=new Map(Object.entries(R&&R.twimlParams||{}).map(function(k){return[k[0],String(k[1])]})),Object.assign(d._options,R),d._options.callParameters&&(d.parameters=d._options.callParameters),d._options.reconnectToken&&(d._signalingReconnectToken=d._options.reconnectToken),d._voiceEventSidGenerator=d._options.voiceEventSidGenerator||s.generateVoiceEventSid,d._direction=d.parameters.CallSid?w.CallDirection.Incoming:w.CallDirection.Outgoing,d.callerInfo=d._direction===w.CallDirection.Incoming&&d.parameters&&d.parameters.StirStatus?{isVerified:"TN-Validation-Passed-A"===d.parameters.StirStatus}:null,d._mediaReconnectBackoff=new _.default(i),d._mediaReconnectBackoff.on("ready",function(){return d._mediaHandler.iceRestart()}),d.outboundConnectionId=function Z(){return"TJSxxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(L){var w=16*Math.random()|0;return("x"===L?w:3&w|8).toString(16)})}();var U=d._publisher=P.publisher;d._direction===w.CallDirection.Incoming?U.info("connection","incoming",null,d):U.info("connection","outgoing",{preflight:d._options.preflight},d);var F=d._monitor=new(d._options.StatsMonitor||c.default);return F.on("sample",d._onRTCSample),F.disableWarnings(),setTimeout(function(){return F.enableWarnings()},5e3),F.on("warning",function(k,D){("bytesSent"===k.name||"bytesReceived"===k.name)&&d._onMediaFailure(w.MediaFailure.LowBytes),d._reemitWarning(k,D)}),F.on("warning-cleared",function(k){d._reemitWarningCleared(k)}),d._mediaHandler=new d._options.MediaHandler(P.audioHelper,P.pstream,P.getUserMedia,{RTCPeerConnection:d._options.RTCPeerConnection,codecPreferences:d._options.codecPreferences,dscp:d._options.dscp,forceAggressiveIceNomination:d._options.forceAggressiveIceNomination,isUnifiedPlan:d._isUnifiedPlanDefault,maxAverageBitrate:d._options.maxAverageBitrate,preflight:d._options.preflight}),d.on("volume",function(k,D){d._inputVolumeStreak=d._checkVolume(k,d._inputVolumeStreak,d._latestInputVolume,"input"),d._outputVolumeStreak=d._checkVolume(D,d._outputVolumeStreak,d._latestOutputVolume,"output"),d._latestInputVolume=k,d._latestOutputVolume=D}),d._mediaHandler.onaudio=function(k){d._log.info("Remote audio created"),d.emit("audio",k)},d._mediaHandler.onvolume=function(k,D,M,j){F.addVolumes(M/255*32767,j/255*32767),d.emit("volume",k,D)},d._mediaHandler.ondtlstransportstatechange=function(k){d._publisher.post("failed"===k?"error":"debug","dtls-transport-state",k,null,d)},d._mediaHandler.onpcconnectionstatechange=function(k){var D="debug",M=d._mediaHandler.getRTCDtlsTransport();"failed"===k&&(D=M&&"failed"===M.state?"error":"warning"),d._publisher.post(D,"pc-connection-state",k,null,d)},d._mediaHandler.onicecandidate=function(k){var D=new T.IceCandidate(k).toPayload();d._publisher.debug("ice-candidate","ice-candidate",D,d)},d._mediaHandler.onselectedcandidatepairchange=function(k){var D=new T.IceCandidate(k.local).toPayload(),M=new T.IceCandidate(k.remote,!0).toPayload();d._publisher.debug("ice-candidate","selected-ice-candidate-pair",{local_candidate:D,remote_candidate:M},d)},d._mediaHandler.oniceconnectionstatechange=function(k){d._publisher.post("failed"===k?"error":"debug","ice-connection-state",k,null,d)},d._mediaHandler.onicegatheringfailure=function(k){d._publisher.warn("ice-gathering-state",k,null,d),d._onMediaFailure(w.MediaFailure.IceGatheringFailed)},d._mediaHandler.onicegatheringstatechange=function(k){d._publisher.debug("ice-gathering-state",k,null,d)},d._mediaHandler.onsignalingstatechange=function(k){d._publisher.debug("signaling-state",k,null,d)},d._mediaHandler.ondisconnected=function(k){d._log.info(k),d._publisher.warn("network-quality-warning-raised","ice-connectivity-lost",{message:k},d),d.emit("warning","ice-connectivity-lost"),d._onMediaFailure(w.MediaFailure.ConnectionDisconnected)},d._mediaHandler.onfailed=function(k){d._onMediaFailure(w.MediaFailure.ConnectionFailed)},d._mediaHandler.onconnected=function(){d._status===w.State.Reconnecting&&d._onMediaReconnected()},d._mediaHandler.onreconnected=function(k){d._log.info(k),d._publisher.info("network-quality-warning-cleared","ice-connectivity-lost",{message:k},d),d.emit("warning-cleared","ice-connectivity-lost"),d._onMediaReconnected()},d._mediaHandler.onerror=function(k){!0===k.disconnect&&d._disconnect(k.info&&k.info.message);var D=k.info.twilioError||new S.GeneralErrors.UnknownError(k.info.message);d._log.error("Received an error from MediaStream:",k),d.emit("error",D)},d._mediaHandler.onopen=function(){d._status===w.State.Open||d._status===w.State.Reconnecting||(d._status===w.State.Ringing||d._status===w.State.Connecting?(d.mute(!1),d._mediaStatus=w.State.Open,d._maybeTransitionToOpen()):d._mediaHandler.close())},d._mediaHandler.onclose=function(){d._status=w.State.Closed,d._options.shouldPlayDisconnect&&d._options.shouldPlayDisconnect()&&!d._isCancelled&&!d._isRejected&&d._soundcache.get(A.default.SoundName.Disconnect).play(),F.disable(),d._publishMetrics(),!d._isCancelled&&!d._isRejected&&d.emit("disconnect",d)},d._pstream=P.pstream,d._pstream.on("ack",d._onAck),d._pstream.on("cancel",d._onCancel),d._pstream.on("error",d._onSignalingError),d._pstream.on("ringing",d._onRinging),d._pstream.on("transportClose",d._onTransportClose),d._pstream.on("connected",d._onConnected),d._pstream.on("message",d._onMessageReceived),d.on("error",function(k){d._publisher.error("connection","error",{code:k.code,message:k.message},d),d._pstream&&"disconnected"===d._pstream.status&&d._cleanupEventListeners()}),d.on("disconnect",function(){d._cleanupEventListeners()}),d}return f(w,L),Object.defineProperty(w.prototype,"direction",{get:function(){return this._direction},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"codec",{get:function(){return this._codec},enumerable:!1,configurable:!0}),w.prototype._setInputTracksFromStream=function(P){return this._mediaHandler.setInputTracksFromStream(P)},w.prototype._setSinkIds=function(P){return this._mediaHandler._setSinkIds(P)},w.prototype.accept=function(P){var R=this;if(this._status===w.State.Pending){var d=(P=P||{}).rtcConfiguration||this._options.rtcConfiguration,I=P.rtcConstraints||this._options.rtcConstraints||{},U=I.audio||{audio:!0};this._status=w.State.Connecting,this._options.beforeAccept&&this._options.beforeAccept(this);var k="function"==typeof this._options.getInputStream&&this._options.getInputStream();(k?this._mediaHandler.setInputTracksFromStream(k):this._mediaHandler.openWithConstraints(U)).then(function(){R._publisher.info("get-user-media","succeeded",{data:{audioConstraints:U}},R),function(){if(R._status!==w.State.Connecting)return R._cleanupEventListeners(),void R._mediaHandler.close();var M=function(B,q){R._publisher.info("connection",R._direction===w.CallDirection.Incoming?"accepted-by-local":"accepted-by-remote",null,R),"string"==typeof q&&(R._signalingReconnectToken=q);var V=u.getPreferredCodecInfo(R._mediaHandler.version.getSDP());R._publisher.info("settings","codec",{codec_params:V.codecParams,selected_codec:V.codecName},R),R._monitor.enable(B)},j="function"==typeof R._options.getSinkIds&&R._options.getSinkIds();if(Array.isArray(j)&&R._mediaHandler._setSinkIds(j).catch(function(){}),R._pstream.addListener("hangup",R._onHangup),R._direction===w.CallDirection.Incoming)R._isAnswered=!0,R._pstream.on("answer",R._onAnswer),R._mediaHandler.answerIncomingCall(R.parameters.CallSid,R._options.offerSdp,I,d,M);else{var H=Array.from(R.customParameters.entries()).map(function(B){return encodeURIComponent(B[0])+"="+encodeURIComponent(B[1])}).join("&");R._pstream.on("answer",R._onAnswer),R._mediaHandler.makeOutgoingCall(R._pstream.token,H,R.outboundConnectionId,I,d,M)}}()},function(M){var j;31208===M.code||-1!==["PermissionDeniedError","NotAllowedError"].indexOf(M.name)?(j=new S.UserMediaErrors.PermissionDeniedError,R._publisher.error("get-user-media","denied",{data:{audioConstraints:U,error:M}},R)):(j=new S.UserMediaErrors.AcquisitionFailedError,R._publisher.error("get-user-media","failed",{data:{audioConstraints:U,error:M}},R)),R._disconnect(),R.emit("error",j)})}},w.prototype.disconnect=function(){this._disconnect()},w.prototype.getLocalStream=function(){return this._mediaHandler&&this._mediaHandler.stream},w.prototype.getRemoteStream=function(){return this._mediaHandler&&this._mediaHandler._remoteStream},w.prototype.ignore=function(){this._status===w.State.Pending&&(this._status=w.State.Closed,this._mediaHandler.ignore(this.parameters.CallSid),this._publisher.info("connection","ignored-by-local",null,this),this._onIgnore&&this._onIgnore())},w.prototype.isMuted=function(){return this._mediaHandler.isMuted},w.prototype.mute=function(P){void 0===P&&(P=!0);var R=this._mediaHandler.isMuted;this._mediaHandler.mute(P);var d=this._mediaHandler.isMuted;R!==d&&(this._publisher.info("connection",d?"muted":"unmuted",null,this),this.emit("mute",d,this))},w.prototype.postFeedback=function(P,R){if(typeof P>"u"||null===P)return this._postFeedbackDeclined();if(!Object.values(w.FeedbackScore).includes(P))throw new S.InvalidArgumentError("Feedback score must be one of: "+Object.values(w.FeedbackScore));if(typeof R<"u"&&null!==R&&!Object.values(w.FeedbackIssue).includes(R))throw new S.InvalidArgumentError("Feedback issue must be one of: "+Object.values(w.FeedbackIssue));return this._publisher.info("feedback","received",{issue_name:R,quality_score:P},this,!0)},w.prototype.reject=function(){this._status===w.State.Pending&&(this._isRejected=!0,this._pstream.reject(this.parameters.CallSid),this._mediaHandler.reject(this.parameters.CallSid),this._publisher.info("connection","rejected-by-local",null,this),this._cleanupEventListeners(),this._mediaHandler.close(),this._status=w.State.Closed,this.emit("reject"))},w.prototype.sendDigits=function(P){var R=this;if(P.match(/[^0-9*#w]/))throw new S.InvalidArgumentError("Illegal character passed into sendDigits");var d=this._options.customSounds||{},I=[];P.split("").forEach(function(M){var j="w"!==M?"dtmf"+M:"";"dtmf*"===j&&(j="dtmfs"),"dtmf#"===j&&(j="dtmfh"),I.push(j)});var U=function(){var M=I.shift();M&&(R._options.dialtonePlayer&&!d[M]?R._options.dialtonePlayer.play(M):R._soundcache.get(M).play()),I.length&&setTimeout(function(){return U()},200)};U();var F=this._mediaHandler.getOrCreateDTMFSender();if(F){if(!("canInsertDTMF"in F)||F.canInsertDTMF)return this._log.info("Sending digits using RTCDTMFSender"),void function k(M){if(M.length){var j=M.shift();j&&j.length&&F.insertDTMF(j,160,70),setTimeout(k.bind(null,M),500)}}(P.split("w"));this._log.info("RTCDTMFSender cannot insert DTMF")}if(this._log.info("Sending digits over PStream"),null!==this._pstream&&"disconnected"!==this._pstream.status)this._pstream.dtmf(this.parameters.CallSid,P);else{var D=new S.GeneralErrors.ConnectionError("Could not send DTMF: Signaling channel is disconnected");this.emit("error",D)}},w.prototype.sendMessage=function(P){var R=P.content,d=P.contentType,I=P.messageType;if(typeof R>"u"||null===R)throw new S.InvalidArgumentError("`content` is empty");if("string"!=typeof I)throw new S.InvalidArgumentError("`messageType` must be an enumeration value of `Call.MessageType` or a string.");if(0===I.length)throw new S.InvalidArgumentError("`messageType` must be a non-empty string.");if(null===this._pstream)throw new S.InvalidStateError("Could not send CallMessage; Signaling channel is disconnected");var U=this.parameters.CallSid;if(typeof this.parameters.CallSid>"u")throw new S.InvalidStateError("Could not send CallMessage; Call has no CallSid");var F=this._voiceEventSidGenerator();return this._messages.set(F,{content:R,contentType:d,messageType:I,voiceEventSid:F}),this._pstream.sendMessage(U,R,d,I,F),F},w.prototype.status=function(){return this._status},w.prototype._checkVolume=function(P,R,d,I){var U=R>=10,F=0;return d===P&&(F=R),F>=10?this._emitWarning("audio-level-","constant-audio-"+I+"-level",10,F,!1):U&&this._emitWarning("audio-level-","constant-audio-"+I+"-level",10,F,!0),F},w.prototype._cleanupEventListeners=function(){var P=this,R=function(){P._pstream&&(P._pstream.removeListener("ack",P._onAck),P._pstream.removeListener("answer",P._onAnswer),P._pstream.removeListener("cancel",P._onCancel),P._pstream.removeListener("error",P._onSignalingError),P._pstream.removeListener("hangup",P._onHangup),P._pstream.removeListener("ringing",P._onRinging),P._pstream.removeListener("transportClose",P._onTransportClose),P._pstream.removeListener("connected",P._onConnected),P._pstream.removeListener("message",P._onMessageReceived))};R(),setTimeout(R,0)},w.prototype._createMetricPayload=function(){var P={call_sid:this.parameters.CallSid,dscp:!!this._options.dscp,sdk_version:o.RELEASE_VERSION};return this._options.gateway&&(P.gateway=this._options.gateway),P.direction=this._direction,P},w.prototype._disconnect=function(P,R){if(P="string"==typeof P?P:null,this._status===w.State.Open||this._status===w.State.Connecting||this._status===w.State.Reconnecting||this._status===w.State.Ringing){if(this._log.info("Disconnecting..."),null!==this._pstream&&"disconnected"!==this._pstream.status&&this._shouldSendHangup){var d=this.parameters.CallSid||this.outboundConnectionId;d&&this._pstream.hangup(d,P)}this._cleanupEventListeners(),this._mediaHandler.close(),R||this._publisher.info("connection","disconnected-by-local",null,this)}},w.prototype._maybeTransitionToOpen=function(){this._isAnswered&&(this._onSignalingReconnected(),this._signalingStatus=w.State.Open,this._mediaHandler&&"open"===this._mediaHandler.status&&(this._status=w.State.Open,this._wasConnected||(this._wasConnected=!0,this.emit("accept",this))))},w.prototype._postFeedbackDeclined=function(){return this._publisher.info("feedback","received-none",null,this,!0)},w.prototype._publishMetrics=function(){var P=this;0!==this._metricsSamples.length&&this._publisher.postMetrics("quality-metrics-samples","metrics-sample",this._metricsSamples.splice(0),this._createMetricPayload(),this).catch(function(R){P._log.warn("Unable to post metrics to Insights. Received error:",R)})},w.prototype._setCallSid=function(P){var R=P.callsid;R&&(this.parameters.CallSid=R,this._mediaHandler.callSid=R)},w.toString=function(){return"[Twilio.Call class]"},w}(E.EventEmitter);!function(L){var D;(D=L.State||(L.State={})).Closed="closed",D.Connecting="connecting",D.Open="open",D.Pending="pending",D.Reconnecting="reconnecting",D.Ringing="ringing",function(D){D.AudioLatency="audio-latency",D.ChoppyAudio="choppy-audio",D.DroppedCall="dropped-call",D.Echo="echo",D.NoisyCall="noisy-call",D.OneWayAudio="one-way-audio"}(L.FeedbackIssue||(L.FeedbackIssue={})),function(D){D[D.One=1]="One",D[D.Two=2]="Two",D[D.Three=3]="Three",D[D.Four=4]="Four",D[D.Five=5]="Five"}(L.FeedbackScore||(L.FeedbackScore={})),function(D){D.Incoming="INCOMING",D.Outgoing="OUTGOING"}(L.CallDirection||(L.CallDirection={})),function(D){D.Opus="opus",D.PCMU="pcmu"}(L.Codec||(L.Codec={})),function(D){D.None="none",D.Timeout="timeout"}(L.IceGatheringFailureReason||(L.IceGatheringFailureReason={})),function(D){D.ConnectionDisconnected="ConnectionDisconnected",D.ConnectionFailed="ConnectionFailed",D.IceGatheringFailed="IceGatheringFailed",D.LowBytes="LowBytes"}(L.MediaFailure||(L.MediaFailure={})),function(D){D.UserDefinedMessage="user-defined-message"}(L.MessageType||(L.MessageType={}))}(x||(x={})),h.default=x},186:(N,h)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.SOUNDS_BASE_URL=h.RELEASE_VERSION=h.PACKAGE_NAME=h.ECHO_TEST_DURATION=h.COWBELL_AUDIO_URL=void 0,h.PACKAGE_NAME="@twilio/voice-sdk";var f="2.6.1";h.RELEASE_VERSION=f;var e="https://sdk.twilio.com/js/client/sounds/releases/1.0.0";h.SOUNDS_BASE_URL=e,h.COWBELL_AUDIO_URL=e+"/cowbell.mp3?cache="+f,h.ECHO_TEST_DURATION=2e4},765:(N,h)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var p=function(){function f(){var e=this;this._promise=new Promise(function(E,_){e._resolve=E,e._reject=_})}return Object.defineProperty(f.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),f.prototype.reject=function(e){this._reject(e)},f.prototype.resolve=function(e){this._resolve(e)},f}();h.default=p},1915:function(N,h,p){"use strict";var L,f=this&&this.__extends||(L=function(w,P){return(L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,d){R.__proto__=d}||function(R,d){for(var I in d)Object.prototype.hasOwnProperty.call(d,I)&&(R[I]=d[I])})(w,P)},function(w,P){function R(){this.constructor=w}L(w,P),w.prototype=null===P?Object.create(P):(R.prototype=P.prototype,new R)}),e=this&&this.__assign||function(){return e=Object.assign||function(L){for(var w,P=1,R=arguments.length;P<R;P++)for(var d in w=arguments[P])Object.prototype.hasOwnProperty.call(w,d)&&(L[d]=w[d]);return L},e.apply(this,arguments)},E=this&&this.__awaiter||function(L,w,P,R){return new(P||(P=Promise))(function(I,U){function F(M){try{D(R.next(M))}catch(j){U(j)}}function k(M){try{D(R.throw(M))}catch(j){U(j)}}function D(M){M.done?I(M.value):function d(I){return I instanceof P?I:new P(function(U){U(I)})}(M.value).then(F,k)}D((R=R.apply(L,w||[])).next())})},_=this&&this.__generator||function(L,w){var R,d,I,U,P={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]};return U={next:F(0),throw:F(1),return:F(2)},"function"==typeof Symbol&&(U[Symbol.iterator]=function(){return this}),U;function F(D){return function(M){return function k(D){if(R)throw new TypeError("Generator is already executing.");for(;P;)try{if(R=1,d&&(I=2&D[0]?d.return:D[0]?d.throw||((I=d.return)&&I.call(d),0):d.next)&&!(I=I.call(d,D[1])).done)return I;switch(d=0,I&&(D=[2&D[0],I.value]),D[0]){case 0:case 1:I=D;break;case 4:return P.label++,{value:D[1],done:!1};case 5:P.label++,d=D[1],D=[0];continue;case 7:D=P.ops.pop(),P.trys.pop();continue;default:if(!(I=(I=P.trys).length>0&&I[I.length-1])&&(6===D[0]||2===D[0])){P=0;continue}if(3===D[0]&&(!I||D[1]>I[0]&&D[1]<I[3])){P.label=D[1];break}if(6===D[0]&&P.label<I[1]){P.label=I[1],I=D;break}if(I&&P.label<I[2]){P.label=I[2],P.ops.push(D);break}I[2]&&P.ops.pop(),P.trys.pop();continue}D=w.call(L,P)}catch(M){D=[6,M],d=0}finally{R=I=0}if(5&D[0])throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}([D,M])}}};Object.defineProperty(h,"__esModule",{value:!0});var A=p(2016),S=p(4182),C=p(6170),g=p(5487),T=p(186),u=p(2009),c=p(1287),m=p(2694),s=p(990),o=p(8579),i=p(3696),n=p(3351),t=p(6813),a=p(5011),r=p(8068),v=p(9819),l=p(8941),Z=function(L){function w(P,R){var d;void 0===R&&(R={});var I=L.call(this)||this;if(I._activeCall=null,I._audio=null,I._callInputStream=null,I._calls=[],I._callSinkIds=["default"],I._chunderURIs=[],I._defaultOptions={allowIncomingWhileBusy:!1,closeProtection:!1,codecPreferences:[g.default.Codec.PCMU,g.default.Codec.Opus],dscp:!0,forceAggressiveIceNomination:!1,logLevel:S.levels.ERROR,maxCallSignalingTimeoutMs:0,preflight:!1,sounds:{},tokenRefreshMs:1e4,voiceEventSidGenerator:l.generateVoiceEventSid},I._edge=null,I._home=null,I._identity=null,I._log=s.default.getInstance(),I._options={},I._preferredURI=null,I._publisher=null,I._region=null,I._regTimer=null,I._shouldReRegister=!1,I._soundcache=new Map,I._state=w.State.Unregistered,I._stateEventMapping=((d={})[w.State.Destroyed]=w.EventName.Destroyed,d[w.State.Unregistered]=w.EventName.Unregistered,d[w.State.Registering]=w.EventName.Registering,d[w.State.Registered]=w.EventName.Registered,d),I._stream=null,I._streamConnectedPromise=null,I._tokenWillExpireTimeout=null,I._createDefaultPayload=function(D){var M={aggressive_nomination:I._options.forceAggressiveIceNomination,browser_extension:I._isBrowserExtension,dscp:!!I._options.dscp,ice_restart_enabled:!0,platform:t.getMediaEngine(),sdk_version:T.RELEASE_VERSION};function j(B,q){q&&(M[B]=q)}if(D){var H=D.parameters.CallSid;j("call_sid",/^TJ/.test(H)?void 0:H),j("temp_call_sid",D.outboundConnectionId),j("audio_codec",D.codec),M.direction=D.direction}return j("gateway",I._stream&&I._stream.gateway),j("region",I._stream&&I._stream.region),M},I._onSignalingClose=function(){I._stream=null,I._streamConnectedPromise=null},I._onSignalingConnected=function(D){var M,j=n.getRegionShortcode(D.region);if(I._edge=D.edge||n.regionToEdge[j]||D.region,I._region=j||D.region,I._home=D.home,null===(M=I._publisher)||void 0===M||M.setHost(n.createEventGatewayURI(D.home)),D.token&&(I._identity=D.token.identity,"number"==typeof D.token.ttl&&"number"==typeof I._options.tokenRefreshMs)){var B=Math.max(0,1e3*D.token.ttl-I._options.tokenRefreshMs);I._tokenWillExpireTimeout=setTimeout(function(){I.emit("tokenWillExpire",I),I._tokenWillExpireTimeout&&(clearTimeout(I._tokenWillExpireTimeout),I._tokenWillExpireTimeout=null)},B)}var q=n.getChunderURIs(I._edge);q.length>0?I._preferredURI=n.createSignalingEndpointURL(q[0]):I._log.info("Could not parse a preferred URI from the stream#connected event."),I._shouldReRegister&&I.register()},I._onSignalingError=function(D){if("object"==typeof D){var M=D.error,j=D.callsid;if("object"==typeof M){var H="string"==typeof j&&I._findCall(j)||void 0,B=M.code,q=M.message,G=M.twilioError;"number"==typeof B&&(31201===B?G=new c.AuthorizationErrors.AuthenticationFailed(M):31204===B?G=new c.AuthorizationErrors.AccessTokenInvalid(M):31205===B?(I._stopRegistrationTimer(),G=new c.AuthorizationErrors.AccessTokenExpired(M)):c.hasErrorByCode(B)&&(G=new(c.getErrorByCode(B))(M))),G||(I._log.error("Unknown signaling error: ",M),G=new c.GeneralErrors.UnknownError(q,M)),I._log.info("Received error: ",G),I.emit(w.EventName.Error,G,H)}}},I._onSignalingInvite=function(D){return E(I,void 0,void 0,function(){var M,j,H,B,q,V,G=this;return _(this,function(W){switch(W.label){case 0:return(M=!!this._activeCall)&&!this._options.allowIncomingWhileBusy?(this._log.info("Device busy; ignoring incoming invite"),[2]):D.callsid&&D.sdp?((j=D.parameters||{}).CallSid=j.CallSid||D.callsid,H=Object.assign({},v.queryToJson(j.Params)),[4,this._makeCall(H,{callParameters:j,offerSdp:D.sdp,reconnectToken:D.reconnect,voiceEventSidGenerator:this._options.voiceEventSidGenerator})]):(this.emit(w.EventName.Error,new c.ClientErrors.BadRequest("Malformed invite from gateway")),[2]);case 1:return B=W.sent(),this._calls.push(B),B.once("accept",function(){G._soundcache.get(w.SoundName.Incoming).stop(),G._publishNetworkChange()}),q=null!==(V=this._audio)&&void 0!==V&&V.incoming()&&!M?function(){return G._soundcache.get(w.SoundName.Incoming).play()}:function(){return Promise.resolve()},this._showIncomingCall(B,q),[2]}})})},I._onSignalingOffline=function(){I._log.info("Stream is offline"),I._edge=null,I._region=null,I._shouldReRegister=I.state!==w.State.Unregistered,I._setState(w.State.Unregistered)},I._onSignalingReady=function(){I._log.info("Stream is ready"),I._setState(w.State.Registered)},I._publishNetworkChange=function(){I._activeCall&&I._networkInformation&&I._publisher.info("network-information","network-change",{connection_type:I._networkInformation.type,downlink:I._networkInformation.downlink,downlinkMax:I._networkInformation.downlinkMax,effective_type:I._networkInformation.effectiveType,rtt:I._networkInformation.rtt},I._activeCall)},I._updateInputStream=function(D){var M=I._activeCall;return M&&!D?Promise.reject(new c.InvalidStateError("Cannot unset input device while a call is in progress.")):(I._callInputStream=D,M?M._setInputTracksFromStream(D):Promise.resolve())},I._updateSinkIds=function(D,M){return("ringtone"===D?I._updateRingtoneSinkIds(M):I._updateSpeakerSinkIds(M)).then(function(){I._publisher.info("audio",D+"-devices-set",{audio_device_ids:M},I._activeCall)},function(H){throw I._publisher.error("audio",D+"-devices-set-failed",{audio_device_ids:M,message:H.message},I._activeCall),H})},I.updateToken(P),v.isLegacyEdge())throw new c.NotSupportedError("Microsoft Edge Legacy (https://support.microsoft.com/en-us/help/4533505/what-is-microsoft-edge-legacy) is deprecated and will not be able to connect to Twilio to make or receive calls after September 1st, 2020. Please see this documentation for a list of supported browsers https://www.twilio.com/docs/voice/client/javascript#supported-browsers");if(!w.isSupported&&R.ignoreBrowserSupport)throw window&&window.location&&"http:"===window.location.protocol?new c.NotSupportedError("twilio.js wasn't able to find WebRTC browser support.           This is most likely because this page is served over http rather than https,           which does not support WebRTC in many browsers. Please load this page over https and           try again."):new c.NotSupportedError("twilio.js 1.3+ SDKs require WebRTC browser support.         For more information, see <https://www.twilio.com/docs/api/client/twilio-js>.         If you have any questions about this announcement, please contact         Twilio Support at <help@twilio.com>.");if(window){var U=window,F=U.msBrowser||U.browser||U.chrome;I._isBrowserExtension=!!F&&!!F.runtime&&!!F.runtime.id||!!U.safari&&!!U.safari.extension}if(I._isBrowserExtension&&I._log.info("Running as browser extension."),navigator){var k=navigator;I._networkInformation=k.connection||k.mozConnection||k.webkitConnection}return I._networkInformation&&"function"==typeof I._networkInformation.addEventListener&&I._networkInformation.addEventListener("change",I._publishNetworkChange),w._getOrCreateAudioContext(),w._audioContext&&(w._dialtonePlayer||(w._dialtonePlayer=new u.default(w._audioContext))),typeof w._isUnifiedPlanDefault>"u"&&(w._isUnifiedPlanDefault=typeof window<"u"&&typeof RTCPeerConnection<"u"&&typeof RTCRtpTransceiver<"u"&&v.isUnifiedPlanDefault(window,window.navigator,RTCPeerConnection,RTCRtpTransceiver)),I._boundDestroy=I.destroy.bind(I),I._boundConfirmClose=I._confirmClose.bind(I),typeof window<"u"&&window.addEventListener&&(window.addEventListener("unload",I._boundDestroy),window.addEventListener("pagehide",I._boundDestroy)),I.updateOptions(R),I}return f(w,L),Object.defineProperty(w,"audioContext",{get:function(){return w._audioContext},enumerable:!1,configurable:!0}),Object.defineProperty(w,"extension",{get:function(){var R,d,P=typeof document<"u"?document.createElement("audio"):{canPlayType:!1};try{R=P.canPlayType&&!!P.canPlayType("audio/mpeg").replace(/no/,"")}catch{R=!1}try{d=P.canPlayType&&!!P.canPlayType("audio/ogg;codecs='vorbis'").replace(/no/,"")}catch{d=!1}return d&&!R?"ogg":"mp3"},enumerable:!1,configurable:!0}),Object.defineProperty(w,"isSupported",{get:function(){return t.enabled()},enumerable:!1,configurable:!0}),Object.defineProperty(w,"packageName",{get:function(){return T.PACKAGE_NAME},enumerable:!1,configurable:!0}),w.runPreflight=function(P,R){return new o.PreflightTest(P,e({audioContext:w._getOrCreateAudioContext()},R))},w.toString=function(){return"[Twilio.Device class]"},Object.defineProperty(w,"version",{get:function(){return T.RELEASE_VERSION},enumerable:!1,configurable:!0}),w._getOrCreateAudioContext=function(){return w._audioContext||(typeof AudioContext<"u"?w._audioContext=new AudioContext:typeof webkitAudioContext<"u"&&(w._audioContext=new webkitAudioContext)),w._audioContext},Object.defineProperty(w.prototype,"audio",{get:function(){return this._audio},enumerable:!1,configurable:!0}),w.prototype.connect=function(P){return void 0===P&&(P={}),E(this,void 0,void 0,function(){var R,d;return _(this,function(I){switch(I.label){case 0:if(this._throwIfDestroyed(),this._activeCall)throw new c.InvalidStateError("A Call is already active");return d=this,[4,this._makeCall(P.params||{},{rtcConfiguration:P.rtcConfiguration,voiceEventSidGenerator:this._options.voiceEventSidGenerator})];case 1:return R=d._activeCall=I.sent(),this._calls.splice(0).forEach(function(U){return U.ignore()}),this._soundcache.get(w.SoundName.Incoming).stop(),R.accept({rtcConstraints:P.rtcConstraints}),this._publishNetworkChange(),[2,R]}})})},Object.defineProperty(w.prototype,"calls",{get:function(){return this._calls},enumerable:!1,configurable:!0}),w.prototype.destroy=function(){this.disconnectAll(),this._stopRegistrationTimer(),this._audio&&this._audio._unbind(),this._destroyStream(),this._destroyPublisher(),this._destroyAudioHelper(),this._networkInformation&&"function"==typeof this._networkInformation.removeEventListener&&this._networkInformation.removeEventListener("change",this._publishNetworkChange),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("beforeunload",this._boundConfirmClose),window.removeEventListener("unload",this._boundDestroy),window.removeEventListener("pagehide",this._boundDestroy)),this._setState(w.State.Destroyed),A.EventEmitter.prototype.removeAllListeners.call(this)},w.prototype.disconnectAll=function(){this._calls.splice(0).forEach(function(R){return R.disconnect()}),this._activeCall&&this._activeCall.disconnect()},Object.defineProperty(w.prototype,"edge",{get:function(){return this._edge},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"home",{get:function(){return this._home},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"identity",{get:function(){return this._identity},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"isBusy",{get:function(){return!!this._activeCall},enumerable:!1,configurable:!0}),w.prototype.register=function(){return E(this,void 0,void 0,function(){var R,d=this;return _(this,function(I){switch(I.label){case 0:if(this.state!==w.State.Unregistered)throw new c.InvalidStateError('Attempt to register when device is in state "'+this.state+'". Must be "'+w.State.Unregistered+'".');return this._setState(w.State.Registering),[4,this._streamConnectedPromise||this._setupStream()];case 1:return I.sent(),R=new Promise(function(U){d.once(w.State.Registered,U)}),[4,this._sendPresence(!0)];case 2:return I.sent(),[4,R];case 3:return I.sent(),[2]}})})},Object.defineProperty(w.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"token",{get:function(){return this._token},enumerable:!1,configurable:!0}),w.prototype.toString=function(){return"[Twilio.Device instance]"},w.prototype.unregister=function(){return E(this,void 0,void 0,function(){var P,R;return _(this,function(d){switch(d.label){case 0:if(this.state!==w.State.Registered)throw new c.InvalidStateError('Attempt to unregister when device is in state "'+this.state+'". Must be "'+w.State.Registered+'".');return this._shouldReRegister=!1,[4,this._streamConnectedPromise];case 1:return P=d.sent(),R=new Promise(function(I){P.on("offline",I)}),[4,this._sendPresence(!1)];case 2:return d.sent(),[4,R];case 3:return d.sent(),[2]}})})},w.prototype.updateOptions=function(P){if(void 0===P&&(P={}),this.state===w.State.Destroyed)throw new c.InvalidStateError('Attempt to "updateOptions" when device is in state "'+this.state+'".');this._options=e(e(e({},this._defaultOptions),this._options),P);var R=new Set(this._chunderURIs),d="string"==typeof this._options.chunderw?[this._options.chunderw]:Array.isArray(this._options.chunderw)&&this._options.chunderw,I=this._chunderURIs=(d||n.getChunderURIs(this._options.edge)).map(n.createSignalingEndpointURL),U=R.size!==I.length;if(!U)for(var F=0,k=I;F<k.length;F++)if(!R.has(k[F])){U=!0;break}if(this.isBusy&&U)throw new c.InvalidStateError("Cannot change Edge while on an active Call");this._log.setDefaultLevel("number"==typeof this._options.logLevel?this._options.logLevel:S.levels.ERROR),this._options.dscp&&(this._options.rtcConstraints||(this._options.rtcConstraints={}),this._options.rtcConstraints.optional=[{googDscp:!0}]);for(var M=0,j=Object.keys(w._defaultSounds);M<j.length;M++){var H=j[M],B=w._defaultSounds[H],V=new(this._options.Sound||r.default)(H,this._options.sounds&&this._options.sounds[H]||T.SOUNDS_BASE_URL+"/"+B.filename+"."+w.extension+"?cache="+T.RELEASE_VERSION,{audioContext:this._options.disableAudioContextSounds?null:w.audioContext,maxDuration:B.maxDuration,shouldLoop:B.shouldLoop});this._soundcache.set(H,V)}this._setupAudioHelper(),this._setupPublisher(),U&&this._streamConnectedPromise&&this._setupStream(),typeof window<"u"&&"function"==typeof window.addEventListener&&this._options.closeProtection&&(window.removeEventListener("beforeunload",this._boundConfirmClose),window.addEventListener("beforeunload",this._boundConfirmClose))},w.prototype.updateToken=function(P){if(this.state===w.State.Destroyed)throw new c.InvalidStateError('Attempt to "updateToken" when device is in state "'+this.state+'".');if("string"!=typeof P)throw new c.InvalidArgumentError('Parameter "token" must be of type "string".');this._token=P,this._stream&&this._stream.setToken(this._token),this._publisher&&this._publisher.setToken(this._token)},w.prototype._confirmClose=function(P){if(!this._activeCall)return"";var R=this._options.closeProtection||!1,d="string"!=typeof R?"A call is currently in-progress. Leaving or reloading this page will end the call.":R;return(P||window.event).returnValue=d,d},w.prototype._destroyAudioHelper=function(){this._audio&&(this._audio.removeAllListeners(),this._audio=null)},w.prototype._destroyPublisher=function(){this._publisher&&(this._publisher=null)},w.prototype._destroyStream=function(){this._stream&&(this._stream.removeListener("close",this._onSignalingClose),this._stream.removeListener("connected",this._onSignalingConnected),this._stream.removeListener("error",this._onSignalingError),this._stream.removeListener("invite",this._onSignalingInvite),this._stream.removeListener("offline",this._onSignalingOffline),this._stream.removeListener("ready",this._onSignalingReady),this._stream.destroy(),this._stream=null),this._onSignalingOffline(),this._streamConnectedPromise=null},w.prototype._findCall=function(P){return this._calls.find(function(R){return R.parameters.CallSid===P||R.outboundConnectionId===P})||null},w.prototype._makeCall=function(P,R){return E(this,void 0,void 0,function(){var d,I,U,F,k=this;return _(this,function(D){switch(D.label){case 0:if(typeof w._isUnifiedPlanDefault>"u")throw new c.InvalidStateError("Device has not been initialized.");return F={audioHelper:this._audio,getUserMedia:this._options.getUserMedia||a.default,isUnifiedPlanDefault:w._isUnifiedPlanDefault,onIgnore:function(){k._soundcache.get(w.SoundName.Incoming).stop()}},[4,this._streamConnectedPromise||this._setupStream()];case 1:return F.pstream=D.sent(),F.publisher=this._publisher,F.soundcache=this._soundcache,d=F,R=Object.assign({MediaStream:this._options.MediaStream||t.PeerConnection,RTCPeerConnection:this._options.RTCPeerConnection,beforeAccept:function(M){!k._activeCall||k._activeCall===M||(k._activeCall.disconnect(),k._removeCall(k._activeCall))},codecPreferences:this._options.codecPreferences,customSounds:this._options.sounds,dialtonePlayer:w._dialtonePlayer,dscp:this._options.dscp,forceAggressiveIceNomination:this._options.forceAggressiveIceNomination,getInputStream:function(){return k._options.fileInputStream||k._callInputStream},getSinkIds:function(){return k._callSinkIds},maxAverageBitrate:this._options.maxAverageBitrate,preflight:this._options.preflight,rtcConstraints:this._options.rtcConstraints,shouldPlayDisconnect:function(){var M;return null===(M=k._audio)||void 0===M?void 0:M.disconnect()},twimlParams:P,voiceEventSidGenerator:this._options.voiceEventSidGenerator},R),I=function(){k._stream?null===k._activeCall&&0===k._calls.length&&k._stream.updatePreferredURI(null):k._log.warn("UnsetPreferredUri called without a stream")},U=new(this._options.Call||g.default)(d,R),this._publisher.info("settings","init",{RTCPeerConnection:!!this._options.RTCPeerConnection,enumerateDevices:!!this._options.enumerateDevices,getUserMedia:!!this._options.getUserMedia},U),U.once("accept",function(){var M;k._stream.updatePreferredURI(k._preferredURI),k._removeCall(U),k._activeCall=U,k._audio&&k._audio._maybeStartPollingVolume(),U.direction===g.default.CallDirection.Outgoing&&null!==(M=k._audio)&&void 0!==M&&M.outgoing()&&k._soundcache.get(w.SoundName.Outgoing).play();var j={edge:k._edge||k._region};k._options.edge&&(j.selected_edge=Array.isArray(k._options.edge)?k._options.edge:[k._options.edge]),k._publisher.info("settings","edge",j,U)}),U.addListener("error",function(M){"closed"===U.status()&&(k._removeCall(U),I()),k._audio&&k._audio._maybeStopPollingVolume(),k._maybeStopIncomingSound()}),U.once("cancel",function(){k._log.info("Canceled: "+U.parameters.CallSid),k._removeCall(U),I(),k._audio&&k._audio._maybeStopPollingVolume(),k._maybeStopIncomingSound()}),U.once("disconnect",function(){k._audio&&k._audio._maybeStopPollingVolume(),k._removeCall(U),I(),k._maybeStopIncomingSound()}),U.once("reject",function(){k._log.info("Rejected: "+U.parameters.CallSid),k._audio&&k._audio._maybeStopPollingVolume(),k._removeCall(U),I(),k._maybeStopIncomingSound()}),U.on("transportClose",function(){U.status()===g.default.State.Pending&&(k._audio&&k._audio._maybeStopPollingVolume(),k._removeCall(U),k._maybeStopIncomingSound())}),[2,U]}})})},w.prototype._maybeStopIncomingSound=function(){this._calls.length||this._soundcache.get(w.SoundName.Incoming).stop()},w.prototype._removeCall=function(P){this._activeCall===P&&(this._activeCall=null);for(var R=this._calls.length-1;R>=0;R--)P===this._calls[R]&&this._calls.splice(R,1)},w.prototype._sendPresence=function(P){return E(this,void 0,void 0,function(){var R;return _(this,function(d){switch(d.label){case 0:return[4,this._streamConnectedPromise];case 1:return(R=d.sent())?(R.register({audio:P}),P?this._startRegistrationTimer():this._stopRegistrationTimer(),[2]):[2]}})})},w.prototype._setState=function(P){P!==this.state&&(this._state=P,this.emit(this._stateEventMapping[P]))},w.prototype._setupAudioHelper=function(){var P=this,R={audioContext:w.audioContext,enumerateDevices:this._options.enumerateDevices};this._audio&&(this._log.info("Found existing audio helper; destroying..."),R.enabledSounds=this._audio._getEnabledSounds(),this._destroyAudioHelper()),this._audio=new(this._options.AudioHelper||C.default)(this._updateSinkIds,this._updateInputStream,this._options.getUserMedia||a.default,R),this._audio.on("deviceChange",function(d){var I=P._activeCall,U=d.map(function(F){return F.deviceId});P._publisher.info("audio","device-change",{lost_active_device_ids:U},I),I&&I._mediaHandler._onInputDevicesChanged()})},w.prototype._setupPublisher=function(){var P=this;this._publisher&&(this._log.info("Found existing publisher; destroying..."),this._destroyPublisher());var R={defaultPayload:this._createDefaultPayload,log:this._log,metadata:{app_name:this._options.appName,app_version:this._options.appVersion}};return this._options.eventgw&&(R.host=this._options.eventgw),this._home&&(R.host=n.createEventGatewayURI(this._home)),this._publisher=new(this._options.Publisher||m.default)("twilio-js-sdk",this.token,R),!1===this._options.publishEvents?this._publisher.disable():this._publisher.on("error",function(d){P._log.warn("Cannot connect to insights.",d)}),this._publisher},w.prototype._setupStream=function(){var P=this;return this._stream&&(this._log.info("Found existing stream; destroying..."),this._destroyStream()),this._log.info("Setting up VSP"),this._stream=new(this._options.PStream||i.default)(this.token,this._chunderURIs,{backoffMaxMs:this._options.backoffMaxMs,maxPreferredDurationMs:this._options.maxCallSignalingTimeoutMs}),this._stream.addListener("close",this._onSignalingClose),this._stream.addListener("connected",this._onSignalingConnected),this._stream.addListener("error",this._onSignalingError),this._stream.addListener("invite",this._onSignalingInvite),this._stream.addListener("offline",this._onSignalingOffline),this._stream.addListener("ready",this._onSignalingReady),this._streamConnectedPromise=new Promise(function(R){return P._stream.once("connected",function(){R(P._stream)})})},w.prototype._showIncomingCall=function(P,R){var I,d=this;return Promise.race([R(),new Promise(function(U,F){I=setTimeout(function(){F(new Error("Playing incoming ringtone took too long; it might not play. Continuing execution..."))},2e3)})]).catch(function(U){d._log.info(U.message)}).then(function(){clearTimeout(I),d.emit(w.EventName.Incoming,P)})},w.prototype._startRegistrationTimer=function(){var P=this;this._stopRegistrationTimer(),this._regTimer=setTimeout(function(){P._sendPresence(!0)},3e4)},w.prototype._stopRegistrationTimer=function(){this._regTimer&&clearTimeout(this._regTimer)},w.prototype._throwIfDestroyed=function(){if(this.state===w.State.Destroyed)throw new c.InvalidStateError("Device has been destroyed.")},w.prototype._updateRingtoneSinkIds=function(P){return Promise.resolve(this._soundcache.get(w.SoundName.Incoming).setSinkIds(P))},w.prototype._updateSpeakerSinkIds=function(P){Array.from(this._soundcache.entries()).filter(function(d){return d[0]!==w.SoundName.Incoming}).forEach(function(d){return d[1].setSinkIds(P)}),this._callSinkIds=P;var R=this._activeCall;return R?R._setSinkIds(P):Promise.resolve()},w._defaultSounds={disconnect:{filename:"disconnect",maxDuration:3e3},dtmf0:{filename:"dtmf-0",maxDuration:1e3},dtmf1:{filename:"dtmf-1",maxDuration:1e3},dtmf2:{filename:"dtmf-2",maxDuration:1e3},dtmf3:{filename:"dtmf-3",maxDuration:1e3},dtmf4:{filename:"dtmf-4",maxDuration:1e3},dtmf5:{filename:"dtmf-5",maxDuration:1e3},dtmf6:{filename:"dtmf-6",maxDuration:1e3},dtmf7:{filename:"dtmf-7",maxDuration:1e3},dtmf8:{filename:"dtmf-8",maxDuration:1e3},dtmf9:{filename:"dtmf-9",maxDuration:1e3},dtmfh:{filename:"dtmf-hash",maxDuration:1e3},dtmfs:{filename:"dtmf-star",maxDuration:1e3},incoming:{filename:"incoming",shouldLoop:!0},outgoing:{filename:"outgoing",maxDuration:3e3}},w}(A.EventEmitter);(function(L){var d;(d=L.EventName||(L.EventName={})).Error="error",d.Incoming="incoming",d.Destroyed="destroyed",d.Unregistered="unregistered",d.Registering="registering",d.Registered="registered",d.TokenWillExpire="tokenWillExpire",function(d){d.Destroyed="destroyed",d.Unregistered="unregistered",d.Registering="registering",d.Registered="registered"}(L.State||(L.State={})),function(d){d.Incoming="incoming",d.Outgoing="outgoing",d.Disconnect="disconnect",d.Dtmf0="dtmf0",d.Dtmf1="dtmf1",d.Dtmf2="dtmf2",d.Dtmf3="dtmf3",d.Dtmf4="dtmf4",d.Dtmf5="dtmf5",d.Dtmf6="dtmf6",d.Dtmf7="dtmf7",d.Dtmf8="dtmf8",d.Dtmf9="dtmf9",d.DtmfS="dtmfs",d.DtmfH="dtmfh"}(L.SoundName||(L.SoundName={}))})(Z||(Z={})),h.default=Z},2009:(N,h,p)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var f=p(1287),e={dtmf0:[1360,960],dtmf1:[1230,720],dtmf2:[1360,720],dtmf3:[1480,720],dtmf4:[1230,790],dtmf5:[1360,790],dtmf6:[1480,790],dtmf7:[1230,870],dtmf8:[1360,870],dtmf9:[1480,870],dtmfh:[1480,960],dtmfs:[1230,960]},E=function(){function _(A){var S=this;this._context=A,this._gainNodes=[],this._gainNodes=[this._context.createGain(),this._context.createGain()],this._gainNodes.forEach(function(C){C.connect(S._context.destination),C.gain.value=.1,S._gainNodes.push(C)})}return _.prototype.cleanup=function(){this._gainNodes.forEach(function(A){A.disconnect()})},_.prototype.play=function(A){var S=this,C=e[A];if(!C)throw new f.InvalidArgumentError("Invalid DTMF sound name");[this._context.createOscillator(),this._context.createOscillator()].forEach(function(T,u){T.type="sine",T.frequency.value=C[u],T.connect(S._gainNodes[u]),T.start(),T.stop(S._context.currentTime+.1),T.addEventListener("ended",function(){return T.disconnect()})})},_}();h.default=E},9888:function(N,h,p){"use strict";var u,f=this&&this.__extends||(u=function(c,m){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,o){s.__proto__=o}||function(s,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(s[i]=o[i])})(c,m)},function(c,m){function s(){this.constructor=c}u(c,m),c.prototype=null===m?Object.create(m):(s.prototype=m.prototype,new s)});Object.defineProperty(h,"__esModule",{value:!0}),h.errorsByCode=h.MediaErrors=h.SignalingErrors=h.UserMediaErrors=h.MalformedRequestErrors=h.GeneralErrors=h.ClientErrors=h.AuthorizationErrors=h.TwilioError=void 0;var E,_,A,S,C,g,T,e=p(9071);h.TwilioError=e.default,function(u){var c=function(o){function i(n,t){var a=o.call(this,n,t)||this;a.causes=[],a.code=20101,a.description="Invalid access token",a.explanation="Twilio was unable to validate your Access Token",a.name="AccessTokenInvalid",a.solutions=[],Object.setPrototypeOf(a,u.AccessTokenInvalid.prototype);var v="object"==typeof n?n:t;return a.message=a.name+" ("+a.code+"): "+("string"==typeof n?n:a.explanation),a.originalError=v,a}return f(i,o),i}(e.default);u.AccessTokenInvalid=c;var m=function(o){function i(n,t){var a=o.call(this,n,t)||this;a.causes=[],a.code=20104,a.description="Access token expired or expiration date invalid",a.explanation="The Access Token provided to the Twilio API has expired, the expiration time specified in the token was invalid, or the expiration time specified was too far in the future",a.name="AccessTokenExpired",a.solutions=[],Object.setPrototypeOf(a,u.AccessTokenExpired.prototype);var v="object"==typeof n?n:t;return a.message=a.name+" ("+a.code+"): "+("string"==typeof n?n:a.explanation),a.originalError=v,a}return f(i,o),i}(e.default);u.AccessTokenExpired=m;var s=function(o){function i(n,t){var a=o.call(this,n,t)||this;a.causes=[],a.code=20151,a.description="Authentication Failed",a.explanation="The Authentication with the provided JWT failed",a.name="AuthenticationFailed",a.solutions=[],Object.setPrototypeOf(a,u.AuthenticationFailed.prototype);var v="object"==typeof n?n:t;return a.message=a.name+" ("+a.code+"): "+("string"==typeof n?n:a.explanation),a.originalError=v,a}return f(i,o),i}(e.default);u.AuthenticationFailed=s}(h.AuthorizationErrors||(h.AuthorizationErrors={})),function(u){var c=function(m){function s(o,i){var n=m.call(this,o,i)||this;n.causes=[],n.code=31400,n.description="Bad Request (HTTP/SIP)",n.explanation="The request could not be understood due to malformed syntax.",n.name="BadRequest",n.solutions=[],Object.setPrototypeOf(n,u.BadRequest.prototype);var a="object"==typeof o?o:i;return n.message=n.name+" ("+n.code+"): "+("string"==typeof o?o:n.explanation),n.originalError=a,n}return f(s,m),s}(e.default);u.BadRequest=c}(_=h.ClientErrors||(h.ClientErrors={})),function(u){var c=function(i){function n(t,a){var r=i.call(this,t,a)||this;r.causes=[],r.code=31e3,r.description="Unknown Error",r.explanation="An unknown error has occurred. See error details for more information.",r.name="UnknownError",r.solutions=[],Object.setPrototypeOf(r,u.UnknownError.prototype);var l="object"==typeof t?t:a;return r.message=r.name+" ("+r.code+"): "+("string"==typeof t?t:r.explanation),r.originalError=l,r}return f(n,i),n}(e.default);u.UnknownError=c;var m=function(i){function n(t,a){var r=i.call(this,t,a)||this;r.causes=[],r.code=31005,r.description="Connection error",r.explanation="A connection error occurred during the call",r.name="ConnectionError",r.solutions=[],Object.setPrototypeOf(r,u.ConnectionError.prototype);var l="object"==typeof t?t:a;return r.message=r.name+" ("+r.code+"): "+("string"==typeof t?t:r.explanation),r.originalError=l,r}return f(n,i),n}(e.default);u.ConnectionError=m;var s=function(i){function n(t,a){var r=i.call(this,t,a)||this;r.causes=["The incoming call was cancelled because it was not answered in time or it was accepted/rejected by another application instance registered with the same identity."],r.code=31008,r.description="Call cancelled",r.explanation="Unable to answer because the call has ended",r.name="CallCancelledError",r.solutions=[],Object.setPrototypeOf(r,u.CallCancelledError.prototype);var l="object"==typeof t?t:a;return r.message=r.name+" ("+r.code+"): "+("string"==typeof t?t:r.explanation),r.originalError=l,r}return f(n,i),n}(e.default);u.CallCancelledError=s;var o=function(i){function n(t,a){var r=i.call(this,t,a)||this;r.causes=[],r.code=31009,r.description="Transport error",r.explanation="No transport available to send or receive messages",r.name="TransportError",r.solutions=[],Object.setPrototypeOf(r,u.TransportError.prototype);var l="object"==typeof t?t:a;return r.message=r.name+" ("+r.code+"): "+("string"==typeof t?t:r.explanation),r.originalError=l,r}return f(n,i),n}(e.default);u.TransportError=o}(A=h.GeneralErrors||(h.GeneralErrors={})),function(u){var c=function(m){function s(o,i){var n=m.call(this,o,i)||this;n.causes=["Invalid content or MessageType passed to sendMessage method."],n.code=31100,n.description="The request had malformed syntax.",n.explanation="The request could not be understood due to malformed syntax.",n.name="MalformedRequestError",n.solutions=["Ensure content and MessageType passed to sendMessage method are valid."],Object.setPrototypeOf(n,u.MalformedRequestError.prototype);var a="object"==typeof o?o:i;return n.message=n.name+" ("+n.code+"): "+("string"==typeof o?o:n.explanation),n.originalError=a,n}return f(s,m),s}(e.default);u.MalformedRequestError=c}(S=h.MalformedRequestErrors||(h.MalformedRequestErrors={})),function(u){var c=function(s){function o(i,n){var t=s.call(this,i,n)||this;t.causes=["Rate limit exceeded."],t.code=31206,t.description="Rate exceeded authorized limit.",t.explanation="The request performed exceeds the authorized limit.",t.name="RateExceededError",t.solutions=["Ensure message send rate does not exceed authorized limits."],Object.setPrototypeOf(t,u.RateExceededError.prototype);var r="object"==typeof i?i:n;return t.message=t.name+" ("+t.code+"): "+("string"==typeof i?i:t.explanation),t.originalError=r,t}return f(o,s),o}(e.default);u.RateExceededError=c;var m=function(s){function o(i,n){var t=s.call(this,i,n)||this;t.causes=["The payload size of Call Message Event exceeds the authorized limit."],t.code=31209,t.description="Call Message Event Payload size exceeded authorized limit.",t.explanation="The request performed to send a Call Message Event exceeds the payload size authorized limit",t.name="PayloadSizeExceededError",t.solutions=["Reduce payload size of Call Message Event to be within the authorized limit and try again."],Object.setPrototypeOf(t,u.PayloadSizeExceededError.prototype);var r="object"==typeof i?i:n;return t.message=t.name+" ("+t.code+"): "+("string"==typeof i?i:t.explanation),t.originalError=r,t}return f(o,s),o}(e.default);u.PayloadSizeExceededError=m}(E=h.AuthorizationErrors||(h.AuthorizationErrors={})),function(u){var c=function(s){function o(i,n){var t=s.call(this,i,n)||this;t.causes=["The user denied the getUserMedia request.","The browser denied the getUserMedia request."],t.code=31401,t.description="UserMedia Permission Denied Error",t.explanation="The browser or end-user denied permissions to user media. Therefore we were unable to acquire input audio.",t.name="PermissionDeniedError",t.solutions=["The user should accept the request next time prompted. If the browser saved the deny, the user should change that permission in their browser.","The user should to verify that the browser has permission to access the microphone at this address."],Object.setPrototypeOf(t,u.PermissionDeniedError.prototype);var r="object"==typeof i?i:n;return t.message=t.name+" ("+t.code+"): "+("string"==typeof i?i:t.explanation),t.originalError=r,t}return f(o,s),o}(e.default);u.PermissionDeniedError=c;var m=function(s){function o(i,n){var t=s.call(this,i,n)||this;t.causes=["NotFoundError - The deviceID specified was not found.","The getUserMedia constraints were overconstrained and no devices matched."],t.code=31402,t.description="UserMedia Acquisition Failed Error",t.explanation="The browser and end-user allowed permissions, however getting the media failed. Usually this is due to bad constraints, but can sometimes fail due to browser, OS or hardware issues.",t.name="AcquisitionFailedError",t.solutions=["Ensure the deviceID being specified exists.","Try acquiring media with fewer constraints."],Object.setPrototypeOf(t,u.AcquisitionFailedError.prototype);var r="object"==typeof i?i:n;return t.message=t.name+" ("+t.code+"): "+("string"==typeof i?i:t.explanation),t.originalError=r,t}return f(o,s),o}(e.default);u.AcquisitionFailedError=m}(C=h.UserMediaErrors||(h.UserMediaErrors={})),function(u){var c=function(s){function o(i,n){var t=s.call(this,i,n)||this;t.causes=[],t.code=53e3,t.description="Signaling connection error",t.explanation="Raised whenever a signaling connection error occurs that is not covered by a more specific error code.",t.name="ConnectionError",t.solutions=[],Object.setPrototypeOf(t,u.ConnectionError.prototype);var r="object"==typeof i?i:n;return t.message=t.name+" ("+t.code+"): "+("string"==typeof i?i:t.explanation),t.originalError=r,t}return f(o,s),o}(e.default);u.ConnectionError=c;var m=function(s){function o(i,n){var t=s.call(this,i,n)||this;t.causes=["The device running your application lost its Internet connection."],t.code=53001,t.description="Signaling connection disconnected",t.explanation="Raised whenever the signaling connection is unexpectedly disconnected.",t.name="ConnectionDisconnected",t.solutions=["Ensure the device running your application has access to a stable Internet connection."],Object.setPrototypeOf(t,u.ConnectionDisconnected.prototype);var r="object"==typeof i?i:n;return t.message=t.name+" ("+t.code+"): "+("string"==typeof i?i:t.explanation),t.originalError=r,t}return f(o,s),o}(e.default);u.ConnectionDisconnected=m}(g=h.SignalingErrors||(h.SignalingErrors={})),function(u){var c=function(o){function i(n,t){var a=o.call(this,n,t)||this;a.causes=["The Client may not be using a supported WebRTC implementation.","The Client may not have the necessary resources to create or apply a new media description."],a.code=53400,a.description="Client is unable to create or apply a local media description",a.explanation="Raised whenever a Client is unable to create or apply a local media description.",a.name="ClientLocalDescFailed",a.solutions=["If you are experiencing this error using the JavaScript SDK, ensure you are running it with a supported WebRTC implementation."],Object.setPrototypeOf(a,u.ClientLocalDescFailed.prototype);var v="object"==typeof n?n:t;return a.message=a.name+" ("+a.code+"): "+("string"==typeof n?n:a.explanation),a.originalError=v,a}return f(i,o),i}(e.default);u.ClientLocalDescFailed=c;var m=function(o){function i(n,t){var a=o.call(this,n,t)||this;a.causes=["The Client may not be using a supported WebRTC implementation.","The Client may be connecting peer-to-peer with another Participant that is not using a supported WebRTC implementation.","The Client may not have the necessary resources to apply a new media description."],a.code=53402,a.description="Client is unable to apply a remote media description",a.explanation="Raised whenever the Client receives a remote media description but is unable to apply it.",a.name="ClientRemoteDescFailed",a.solutions=["If you are experiencing this error using the JavaScript SDK, ensure you are running it with a supported WebRTC implementation."],Object.setPrototypeOf(a,u.ClientRemoteDescFailed.prototype);var v="object"==typeof n?n:t;return a.message=a.name+" ("+a.code+"): "+("string"==typeof n?n:a.explanation),a.originalError=v,a}return f(i,o),i}(e.default);u.ClientRemoteDescFailed=m;var s=function(o){function i(n,t){var a=o.call(this,n,t)||this;a.causes=["The Client was unable to establish a media connection.","A media connection which was active failed liveliness checks."],a.code=53405,a.description="Media connection failed",a.explanation="Raised by the Client or Server whenever a media connection fails.",a.name="ConnectionError",a.solutions=["If the problem persists, try connecting to another region.","Check your Client's network connectivity.","If you've provided custom ICE Servers then ensure that the URLs and credentials are valid."],Object.setPrototypeOf(a,u.ConnectionError.prototype);var v="object"==typeof n?n:t;return a.message=a.name+" ("+a.code+"): "+("string"==typeof n?n:a.explanation),a.originalError=v,a}return f(i,o),i}(e.default);u.ConnectionError=s}(T=h.MediaErrors||(h.MediaErrors={})),h.errorsByCode=new Map([[20101,E.AccessTokenInvalid],[20104,E.AccessTokenExpired],[20151,E.AuthenticationFailed],[31400,_.BadRequest],[31e3,A.UnknownError],[31005,A.ConnectionError],[31008,A.CallCancelledError],[31009,A.TransportError],[31100,S.MalformedRequestError],[31206,E.RateExceededError],[31209,E.PayloadSizeExceededError],[31401,C.PermissionDeniedError],[31402,C.AcquisitionFailedError],[53e3,g.ConnectionError],[53001,g.ConnectionDisconnected],[53400,T.ClientLocalDescFailed],[53402,T.ClientRemoteDescFailed],[53405,T.ConnectionError]]),Object.freeze(h.errorsByCode)},1287:function(N,h,p){"use strict";var g,f=this&&this.__extends||(g=function(T,u){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,m){c.__proto__=m}||function(c,m){for(var s in m)Object.prototype.hasOwnProperty.call(m,s)&&(c[s]=m[s])})(T,u)},function(T,u){function c(){this.constructor=T}g(T,u),T.prototype=null===u?Object.create(u):(c.prototype=u.prototype,new c)});Object.defineProperty(h,"__esModule",{value:!0}),h.UserMediaErrors=h.TwilioError=h.SignalingErrors=h.MediaErrors=h.GeneralErrors=h.ClientErrors=h.AuthorizationErrors=h.hasErrorByCode=h.getErrorByCode=h.NotSupportedError=h.InvalidStateError=h.InvalidArgumentError=void 0;var e=p(9888);Object.defineProperty(h,"AuthorizationErrors",{enumerable:!0,get:function(){return e.AuthorizationErrors}}),Object.defineProperty(h,"ClientErrors",{enumerable:!0,get:function(){return e.ClientErrors}}),Object.defineProperty(h,"GeneralErrors",{enumerable:!0,get:function(){return e.GeneralErrors}}),Object.defineProperty(h,"MediaErrors",{enumerable:!0,get:function(){return e.MediaErrors}}),Object.defineProperty(h,"SignalingErrors",{enumerable:!0,get:function(){return e.SignalingErrors}}),Object.defineProperty(h,"TwilioError",{enumerable:!0,get:function(){return e.TwilioError}}),Object.defineProperty(h,"UserMediaErrors",{enumerable:!0,get:function(){return e.UserMediaErrors}});var E=function(g){function T(u){var c=g.call(this,u)||this;return c.name="InvalidArgumentError",c}return f(T,g),T}(Error);h.InvalidArgumentError=E;var _=function(g){function T(u){var c=g.call(this,u)||this;return c.name="InvalidStateError",c}return f(T,g),T}(Error);h.InvalidStateError=_;var A=function(g){function T(u){var c=g.call(this,u)||this;return c.name="NotSupportedError",c}return f(T,g),T}(Error);h.NotSupportedError=A,h.getErrorByCode=function S(g){var T=e.errorsByCode.get(g);if(!T)throw new E("Error code "+g+" not found");return T},h.hasErrorByCode=function C(g){return e.errorsByCode.has(g)}},9071:function(N,h){"use strict";var e,p=this&&this.__extends||(e=function(E,_){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,S){A.__proto__=S}||function(A,S){for(var C in S)Object.prototype.hasOwnProperty.call(S,C)&&(A[C]=S[C])})(E,_)},function(E,_){function A(){this.constructor=E}e(E,_),E.prototype=null===_?Object.create(_):(A.prototype=_.prototype,new A)});Object.defineProperty(h,"__esModule",{value:!0});var f=function(e){function E(_,A){var S=e.call(this)||this;Object.setPrototypeOf(S,E.prototype);var g="object"==typeof _?_:A;return S.message=S.name+" ("+S.code+"): "+("string"==typeof _?_:S.explanation),S.originalError=g,S}return p(E,e),E}(Error);h.default=f},2694:function(N,h,p){"use strict";var S,f=this&&this.__extends||(S=function(C,g){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,u){T.__proto__=u}||function(T,u){for(var c in u)Object.prototype.hasOwnProperty.call(u,c)&&(T[c]=u[c])})(C,g)},function(C,g){function T(){this.constructor=C}S(C,g),C.prototype=null===g?Object.create(g):(T.prototype=g.prototype,new T)});Object.defineProperty(h,"__esModule",{value:!0});var e=p(2016),E=p(3074),_=function(S){function C(g,T,u){var c=S.call(this)||this;if(!(c instanceof C))return new C(g,T,u);var m=(u=Object.assign({defaultPayload:function(){return{}}},u)).defaultPayload;"function"!=typeof m&&(m=function(){return Object.assign({},u.defaultPayload)});var s=!0,o=Object.assign({app_name:void 0,app_version:void 0},u.metadata);return Object.defineProperties(c,{_defaultPayload:{value:m},_host:{value:u.host,writable:!0},_isEnabled:{get:function(){return s},set:function(i){s=i}},_log:{value:u.log},_request:{value:u.request||E.default,writable:!0},_token:{value:T,writable:!0},isEnabled:{enumerable:!0,get:function(){return s}},metadata:{enumerable:!0,get:function(){return o}},productName:{enumerable:!0,value:g},token:{enumerable:!0,get:function(){return this._token}}}),c}return f(C,S),C}(e.EventEmitter);function A(S){return{audio_codec:S.codecName,audio_level_in:S.audioInputLevel,audio_level_out:S.audioOutputLevel,bytes_received:S.bytesReceived,bytes_sent:S.bytesSent,call_volume_input:S.inputVolume,call_volume_output:S.outputVolume,jitter:S.jitter,mos:S.mos&&Math.round(100*S.mos)/100,packets_lost:S.packetsLost,packets_lost_fraction:S.packetsLostFraction&&Math.round(100*S.packetsLostFraction)/100,packets_received:S.packetsReceived,rtt:S.rtt,timestamp:new Date(S.timestamp).toISOString(),total_bytes_received:S.totals.bytesReceived,total_bytes_sent:S.totals.bytesSent,total_packets_lost:S.totals.packetsLost,total_packets_received:S.totals.packetsReceived,total_packets_sent:S.totals.packetsSent}}_.prototype._post=function(C,g,T,u,c,m,s){var o=this;if(!((this.isEnabled||s)&&this._host&&m&&(m.parameters&&m.parameters.CallSid||m.outboundConnectionId)))return Promise.resolve();var i={group:T,level:g.toUpperCase(),name:u,payload:c&&c.forEach?c.slice(0):Object.assign(this._defaultPayload(m),c),payload_type:"application/json",private:!1,publisher:this.productName,timestamp:(new Date).toISOString()};this.metadata&&(i.publisher_metadata=this.metadata);var n={body:i,headers:{"Content-Type":"application/json","X-Twilio-Token":this.token},url:"https://"+this._host+"/v4/"+C};return new Promise(function(t,a){o._request.post(n,function(r){r?(o.emit("error",r),a(r)):t()})}).catch(function(t){o._log.warn("Unable to post "+T+" "+u+" event to Insights. Received error: "+t)})},_.prototype.post=function(C,g,T,u,c,m){return this._post("EndpointEvents",C,g,T,u,c,m)},_.prototype.debug=function(C,g,T,u){return this.post("debug",C,g,T,u)},_.prototype.info=function(C,g,T,u){return this.post("info",C,g,T,u)},_.prototype.warn=function(C,g,T,u){return this.post("warning",C,g,T,u)},_.prototype.error=function(C,g,T,u){return this.post("error",C,g,T,u)},_.prototype.postMetrics=function(C,g,T,u,c){var m=this;return new Promise(function(s){var o=T.map(A).map(function(i){return Object.assign(i,u)});s(m._post("EndpointMetrics","info",C,g,o,c))})},_.prototype.setHost=function(C){this._host=C},_.prototype.setToken=function(C){this._token=C},_.prototype.enable=function(){this._isEnabled=!0},_.prototype.disable=function(){this._isEnabled=!1},h.default=_},990:(N,h,p)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Logger=void 0;var f=p(4182),e=p(186),E=function(){function _(A){try{this._log=(A&&A.LogLevelModule?A.LogLevelModule:f).getLogger(e.PACKAGE_NAME)}catch{console.warn("Cannot create custom logger"),this._log=console}}return _.getInstance=function(){return _.instance||(_.instance=new _),_.instance},_.prototype.debug=function(){for(var A,S=[],C=0;C<arguments.length;C++)S[C]=arguments[C];(A=this._log).debug.apply(A,S)},_.prototype.error=function(){for(var A,S=[],C=0;C<arguments.length;C++)S[C]=arguments[C];(A=this._log).error.apply(A,S)},_.prototype.getLogLevelInstance=function(){return this._log},_.prototype.info=function(){for(var A,S=[],C=0;C<arguments.length;C++)S[C]=arguments[C];(A=this._log).info.apply(A,S)},_.prototype.setDefaultLevel=function(A){this._log.setDefaultLevel?this._log.setDefaultLevel(A):console.warn("Logger cannot setDefaultLevel")},_.prototype.warn=function(){for(var A,S=[],C=0;C<arguments.length;C++)S[C]=arguments[C];(A=this._log).warn.apply(A,S)},_.levels=f.levels,_}();h.Logger=E.getInstance().getLogLevelInstance(),h.default=E},6178:(N,h,p)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var f=p(186),e=p(1287),E=f.SOUNDS_BASE_URL+"/outgoing.mp3",_=function(){function A(S,C,g,T){this._name=S,this._availableDevices=C,this._beforeChange=g,this._isSupported=T,this._activeDevices=new Set}return A.prototype.delete=function(S){var C=!!this._activeDevices.delete(S),g=this._availableDevices.get("default")||Array.from(this._availableDevices.values())[0];!this._activeDevices.size&&g&&this._activeDevices.add(g);var T=Array.from(this._activeDevices.values()).map(function(u){return u.deviceId});return this._beforeChange(this._name,T),!!C},A.prototype.get=function(){return this._activeDevices},A.prototype.set=function(S){var C=this;if(!this._isSupported)return Promise.reject(new e.NotSupportedError("This browser does not support audio output selection"));var g=Array.isArray(S)?S:[S];if(!g.length)return Promise.reject(new e.InvalidArgumentError("Must specify at least one device to set"));var T=[],u=g.map(function(c){var m=C._availableDevices.get(c);return m||T.push(c),m});return T.length?Promise.reject(new e.InvalidArgumentError("Devices not found: "+T.join(", "))):new Promise(function(c){c(C._beforeChange(C._name,g))}).then(function(){C._activeDevices.clear(),u.forEach(C._activeDevices.add,C._activeDevices)})},A.prototype.test=function(S){return void 0===S&&(S=E),this._isSupported?this._activeDevices.size?Promise.all(Array.from(this._activeDevices).map(function(C){var g;return new Promise(function(T){(g=new Audio(S)).oncanplay=T}).then(function(){return g.setSinkId(C.deviceId).then(function(){return g.play()})})})):Promise.reject(new e.InvalidStateError("No active output devices to test")):Promise.reject(new e.NotSupportedError("This browser does not support audio output selection"))},A}();h.default=_},8579:function(N,h,p){"use strict";var m,f=this&&this.__extends||(m=function(s,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(i[t]=n[t])})(s,o)},function(s,o){function i(){this.constructor=s}m(s,o),s.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}),e=this&&this.__assign||function(){return e=Object.assign||function(m){for(var s,o=1,i=arguments.length;o<i;o++)for(var n in s=arguments[o])Object.prototype.hasOwnProperty.call(s,n)&&(m[n]=s[n]);return m},e.apply(this,arguments)},E=this&&this.__awaiter||function(m,s,o,i){return new(o||(o=Promise))(function(t,a){function r(y){try{l(i.next(y))}catch(b){a(b)}}function v(y){try{l(i.throw(y))}catch(b){a(b)}}function l(y){y.done?t(y.value):function n(t){return t instanceof o?t:new o(function(a){a(t)})}(y.value).then(r,v)}l((i=i.apply(m,s||[])).next())})},_=this&&this.__generator||function(m,s){var i,n,t,a,o={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(l){return function(y){return function v(l){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(t=2&l[0]?n.return:l[0]?n.throw||((t=n.return)&&t.call(n),0):n.next)&&!(t=t.call(n,l[1])).done)return t;switch(n=0,t&&(l=[2&l[0],t.value]),l[0]){case 0:case 1:t=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(t=(t=o.trys).length>0&&t[t.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!t||l[1]>t[0]&&l[1]<t[3])){o.label=l[1];break}if(6===l[0]&&o.label<t[1]){o.label=t[1],t=l;break}if(t&&o.label<t[2]){o.label=t[2],o.ops.push(l);break}t[2]&&o.ops.pop(),o.trys.pop();continue}l=s.call(m,o)}catch(y){l=[6,y],n=0}finally{i=t=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,y])}}};Object.defineProperty(h,"__esModule",{value:!0}),h.PreflightTest=void 0;var A=p(2016),S=p(5487),C=p(1915),g=p(1287),T=p(5610),u=p(186),c=function(m){function s(o,i){var n=m.call(this)||this;return n._hasInsightsErrored=!1,n._networkTiming={},n._options={codecPreferences:[S.default.Codec.PCMU,S.default.Codec.Opus],edge:"roaming",fakeMicInput:!1,logLevel:"error",signalingTimeoutMs:1e4},n._status=s.Status.Connecting,Object.assign(n._options,i),n._samples=[],n._warnings=[],n._startTime=Date.now(),n._initDevice(o,e(e({},n._options),{fileInputStream:n._options.fakeMicInput?n._getStreamFromFile():void 0})),n}return f(s,m),s.prototype.stop=function(){var o=this,i=new g.GeneralErrors.CallCancelledError;this._device?(this._device.once(C.default.EventName.Unregistered,function(){return o._onFailed(i)}),this._device.destroy()):this._onFailed(i)},s.prototype._emitWarning=function(o,i,n){var t={name:o,description:i};n&&(t.rtcWarning=n),this._warnings.push(t),this.emit(s.Events.Warning,t)},s.prototype._getCallQuality=function(o){return o>4.2?s.CallQuality.Excellent:o>=4.1&&o<=4.2?s.CallQuality.Great:o>=3.7&&o<=4?s.CallQuality.Good:o>=3.1&&o<=3.6?s.CallQuality.Fair:s.CallQuality.Degraded},s.prototype._getReport=function(){var o=this._getRTCStats(),i={start:this._startTime};this._endTime&&(i.end=this._endTime,i.duration=this._endTime-this._startTime);var n={callSid:this._callSid,edge:this._edge,iceCandidateStats:this._rtcIceCandidateStatsReport.iceCandidateStats,networkTiming:this._networkTiming,samples:this._samples,selectedEdge:this._options.edge,stats:o,testTiming:i,totals:this._getRTCSampleTotals(),warnings:this._warnings},t=this._rtcIceCandidateStatsReport.selectedIceCandidatePairStats;return t&&(n.selectedIceCandidatePairStats=t,n.isTurnRequired="relay"===t.localCandidate.candidateType||"relay"===t.remoteCandidate.candidateType),o&&(n.callQuality=this._getCallQuality(o.mos.average)),n},s.prototype._getRTCSampleTotals=function(){if(this._latestSample)return e({},this._latestSample.totals)},s.prototype._getRTCStats=function(){var o=this._samples.findIndex(function(n){return"number"==typeof n.mos&&n.mos>0}),i=o>=0?this._samples.slice(o):[];if(i&&i.length)return["jitter","mos","rtt"].reduce(function(n,t){var a,r=i.map(function(v){return v[t]});return e(e({},n),((a={})[t]={average:Number((r.reduce(function(v,l){return v+l})/r.length).toPrecision(5)),max:Math.max.apply(Math,r),min:Math.min.apply(Math,r)},a))},{})},s.prototype._getStreamFromFile=function(){var o=this._options.audioContext;if(!o)throw new g.NotSupportedError("Cannot fake input audio stream: AudioContext is not supported by this browser.");var i=new Audio(u.COWBELL_AUDIO_URL);i.addEventListener("canplaythrough",function(){return i.play()}),"function"==typeof i.setAttribute&&i.setAttribute("crossorigin","anonymous");var n=o.createMediaElementSource(i),t=o.createMediaStreamDestination();return n.connect(t),t.stream},s.prototype._initDevice=function(o,i){var n=this;try{this._device=new(i.deviceFactory||C.default)(o,{codecPreferences:i.codecPreferences,edge:i.edge,fileInputStream:i.fileInputStream,logLevel:i.logLevel,preflight:!0}),this._device.once(C.default.EventName.Registered,function(){n._onDeviceRegistered()}),this._device.once(C.default.EventName.Error,function(t){n._onDeviceError(t)}),this._device.register()}catch(t){return void setTimeout(function(){n._onFailed(t)})}this._signalingTimeoutTimer=setTimeout(function(){n._onDeviceError(new g.SignalingErrors.ConnectionError("WebSocket Connection Timeout"))},i.signalingTimeoutMs)},s.prototype._onDeviceError=function(o){this._device.destroy(),this._onFailed(o)},s.prototype._onDeviceRegistered=function(){return E(this,void 0,void 0,function(){var o,i,t=this;return _(this,function(a){switch(a.label){case 0:return clearTimeout(this._echoTimer),clearTimeout(this._signalingTimeoutTimer),o=this,[4,this._device.connect({rtcConfiguration:this._options.rtcConfiguration})];case 1:return o._call=a.sent(),this._networkTiming.signaling={start:Date.now()},this._setupCallHandlers(this._call),this._edge=this._device.edge||void 0,this._options.fakeMicInput&&(this._echoTimer=setTimeout(function(){return t._device.disconnectAll()},u.ECHO_TEST_DURATION),(i=this._device.audio)&&(i.disconnect(!1),i.outgoing(!1))),this._call.once("disconnect",function(){t._device.once(C.default.EventName.Unregistered,function(){return t._onUnregistered()}),t._device.destroy()}),this._call._publisher.on("error",function(){t._hasInsightsErrored||t._emitWarning("insights-connection-error","Received an error when attempting to connect to Insights gateway"),t._hasInsightsErrored=!0}),[2]}})})},s.prototype._onFailed=function(o){clearTimeout(this._echoTimer),clearTimeout(this._signalingTimeoutTimer),this._releaseHandlers(),this._endTime=Date.now(),this._status=s.Status.Failed,this.emit(s.Events.Failed,o)},s.prototype._onUnregistered=function(){var o=this;setTimeout(function(){o._status!==s.Status.Failed&&(clearTimeout(o._echoTimer),clearTimeout(o._signalingTimeoutTimer),o._releaseHandlers(),o._endTime=Date.now(),o._status=s.Status.Completed,o._report=o._getReport(),o.emit(s.Events.Completed,o._report))},10)},s.prototype._releaseHandlers=function(){[this._device,this._call].forEach(function(o){o&&o.eventNames().forEach(function(i){return o.removeAllListeners(i)})})},s.prototype._setupCallHandlers=function(o){var i=this;this._options.fakeMicInput&&o.once("volume",function(){o._mediaHandler.outputs.forEach(function(n){return n.audio.muted=!0})}),o.on("warning",function(n,t){i._emitWarning(n,"Received an RTCWarning. See .rtcWarning for the RTCWarning",t)}),o.once("accept",function(){i._callSid=o._mediaHandler.callSid,i._status=s.Status.Connected,i.emit(s.Events.Connected)}),o.on("sample",function(n){return E(i,void 0,void 0,function(){var t;return _(this,function(a){switch(a.label){case 0:return this._latestSample?[3,2]:(t=this,[4,(this._options.getRTCIceCandidateStatsReport||T.getRTCIceCandidateStatsReport)(o._mediaHandler.version.pc)]);case 1:t._rtcIceCandidateStatsReport=a.sent(),a.label=2;case 2:return this._latestSample=n,this._samples.push(n),this.emit(s.Events.Sample,n),[2]}})})}),[{reportLabel:"peerConnection",type:"pcconnection"},{reportLabel:"ice",type:"iceconnection"},{reportLabel:"dtls",type:"dtlstransport"},{reportLabel:"signaling",type:"signaling"}].forEach(function(n){var a=n.reportLabel,r="on"+n.type+"statechange",v=o._mediaHandler[r];o._mediaHandler[r]=function(l){var y=i._networkTiming[a]=i._networkTiming[a]||{start:0};"connecting"===l||"checking"===l?y.start=Date.now():("connected"===l||"stable"===l)&&!y.duration&&(y.end=Date.now(),y.duration=y.end-y.start),v(l)}})},Object.defineProperty(s.prototype,"callSid",{get:function(){return this._callSid},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"endTime",{get:function(){return this._endTime},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"latestSample",{get:function(){return this._latestSample},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"report",{get:function(){return this._report},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"startTime",{get:function(){return this._startTime},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),s}(A.EventEmitter);h.PreflightTest=c,function(m){var n;(n=m.CallQuality||(m.CallQuality={})).Excellent="excellent",n.Great="great",n.Good="good",n.Fair="fair",n.Degraded="degraded",function(n){n.Completed="completed",n.Connected="connected",n.Failed="failed",n.Sample="sample",n.Warning="warning"}(m.Events||(m.Events={})),function(n){n.Connecting="connecting",n.Connected="connected",n.Completed="completed",n.Failed="failed"}(m.Status||(m.Status={}))}(c=h.PreflightTest||(h.PreflightTest={})),h.PreflightTest=c},3696:function(N,h,p){"use strict";var u,f=this&&this.__extends||(u=function(c,m){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,o){s.__proto__=o}||function(s,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(s[i]=o[i])})(c,m)},function(c,m){function s(){this.constructor=c}u(c,m),c.prototype=null===m?Object.create(m):(s.prototype=m.prototype,new s)});Object.defineProperty(h,"__esModule",{value:!0});var e=p(2016),E=p(186),_=p(1287),A=p(990),S=p(483),g=function(u){function c(m,s,o){var i=u.call(this)||this;if(!(i instanceof c))return new c(m,s,o);var n={TransportFactory:S.default};for(var t in o=o||{},n)t in o||(o[t]=n[t]);i.options=o,i.token=m||"",i.status="disconnected",i.gateway=null,i.region=null,i._messageQueue=[],i._preferredUri=null,i._uris=s,i._handleTransportClose=i._handleTransportClose.bind(i),i._handleTransportError=i._handleTransportError.bind(i),i._handleTransportMessage=i._handleTransportMessage.bind(i),i._handleTransportOpen=i._handleTransportOpen.bind(i),i._log=A.default.getInstance(),i.on("error",function(){i._log.warn("Unexpected error handled in pstream")});var a=i;return i.addListener("ready",function(){a.status="ready"}),i.addListener("offline",function(){a.status="offline"}),i.addListener("close",function(){a._log.info('Received "close" from server. Destroying PStream...'),a._destroy()}),i.transport=new i.options.TransportFactory(i._uris,{backoffMaxMs:i.options.backoffMaxMs,maxPreferredDurationMs:i.options.maxPreferredDurationMs}),Object.defineProperties(i,{uri:{enumerable:!0,get:function(){return this.transport.uri}}}),i.transport.on("close",i._handleTransportClose),i.transport.on("error",i._handleTransportError),i.transport.on("message",i._handleTransportMessage),i.transport.on("open",i._handleTransportOpen),i.transport.open(),i}return f(c,u),c}(e.EventEmitter);function T(){var u=typeof navigator<"u"?navigator:{};return{browser:{platform:u.platform||"unknown",userAgent:u.userAgent||"unknown"},p:"browser",plugin:"rtc",v:E.RELEASE_VERSION}}g.prototype._handleTransportClose=function(){this.emit("transportClose"),"disconnected"!==this.status&&("offline"!==this.status&&this.emit("offline",this),this.status="disconnected")},g.prototype._handleTransportError=function(u){this.emit("error",u?typeof u.code<"u"?{error:u}:u:{error:{code:31e3,message:"Websocket closed without a provided reason",twilioError:new _.SignalingErrors.ConnectionDisconnected}})},g.prototype._handleTransportMessage=function(u){if(u&&u.data&&"string"==typeof u.data){var c=JSON.parse(u.data),m=c.type,s=c.payload,o=void 0===s?{}:s;this.gateway=o.gateway||this.gateway,this.region=o.region||this.region,"error"===m&&o.error&&(o.error.twilioError=new _.SignalingErrors.ConnectionError),this.emit(m,o)}},g.prototype._handleTransportOpen=function(){var u=this;this.status="connected",this.setToken(this.token),this.emit("transportOpen"),this._messageQueue.splice(0,this._messageQueue.length).forEach(function(m){return u._publish.apply(u,m)})},g.toString=function(){return"[Twilio.PStream class]"},g.prototype.toString=function(){return"[Twilio.PStream instance]"},g.prototype.setToken=function(u){this._log.info("Setting token and publishing listen"),this.token=u;var c={browserinfo:T(),token:u};this._publish("listen",c)},g.prototype.sendMessage=function(u,c,m,s,o){void 0===m&&(m="application/json"),this._publish("message",{callsid:u,content:c,contenttype:m,messagetype:s,voiceeventsid:o},!0)},g.prototype.register=function(u){this._publish("register",{media:u},!0)},g.prototype.invite=function(u,c,m,s){this._publish("invite",{callsid:c,preflight:!!m,sdp:u,twilio:s?{params:s}:{}},!0)},g.prototype.reconnect=function(u,c,m,s){this._publish("invite",{callsid:c,preflight:!1,reconnect:m,sdp:u,twilio:s?{params:s}:{}},!0)},g.prototype.answer=function(u,c){this._publish("answer",{sdp:u,callsid:c},!0)},g.prototype.dtmf=function(u,c){this._publish("dtmf",{callsid:u,dtmf:c},!0)},g.prototype.hangup=function(u,c){this._publish("hangup",c?{callsid:u,message:c}:{callsid:u},!0)},g.prototype.reject=function(u){this._publish("reject",{callsid:u},!0)},g.prototype.reinvite=function(u,c){this._publish("reinvite",{sdp:u,callsid:c},!1)},g.prototype._destroy=function(){this.transport.removeListener("close",this._handleTransportClose),this.transport.removeListener("error",this._handleTransportError),this.transport.removeListener("message",this._handleTransportMessage),this.transport.removeListener("open",this._handleTransportOpen),this.transport.close(),this.emit("offline",this)},g.prototype.destroy=function(){return this._log.info("PStream.destroy() called..."),this._destroy(),this},g.prototype.updatePreferredURI=function(u){this._preferredUri=u,this.transport.updatePreferredURI(u)},g.prototype.updateURIs=function(u){this._uris=u,this.transport.updateURIs(this._uris)},g.prototype.publish=function(u,c){return this._publish(u,c,!0)},g.prototype._publish=function(u,c,m){var s=JSON.stringify({payload:c,type:u,version:"1.6"});this.transport.send(s)||(this.emit("error",{error:{code:31009,message:"No transport available to send or receive messages",twilioError:new _.GeneralErrors.TransportError}}),m&&this._messageQueue.push([u,c,!0]))},h.default=g},3351:(N,h,p)=>{"use strict";var f;Object.defineProperty(h,"__esModule",{value:!0}),h.getRegionShortcode=h.getChunderURIs=h.createSignalingEndpointURL=h.createEventGatewayURI=h.defaultEdge=h.regionToEdge=h.regionShortcodes=h.Region=h.Edge=void 0;var E,c,_,e=p(1287);function S(c){return"voice-js."+c+".twilio.com"}(c=E=h.Edge||(h.Edge={})).Sydney="sydney",c.SaoPaulo="sao-paulo",c.Dublin="dublin",c.Frankfurt="frankfurt",c.Tokyo="tokyo",c.Singapore="singapore",c.Ashburn="ashburn",c.Umatilla="umatilla",c.Roaming="roaming",c.AshburnIx="ashburn-ix",c.SanJoseIx="san-jose-ix",c.LondonIx="london-ix",c.FrankfurtIx="frankfurt-ix",c.SingaporeIx="singapore-ix",c.SydneyIx="sydney-ix",c.TokyoIx="tokyo-ix",function(c){c.Au1="au1",c.Au1Ix="au1-ix",c.Br1="br1",c.De1="de1",c.De1Ix="de1-ix",c.Gll="gll",c.Ie1="ie1",c.Ie1Ix="ie1-ix",c.Ie1Tnx="ie1-tnx",c.Jp1="jp1",c.Jp1Ix="jp1-ix",c.Sg1="sg1",c.Sg1Ix="sg1-ix",c.Sg1Tnx="sg1-tnx",c.Us1="us1",c.Us1Ix="us1-ix",c.Us1Tnx="us1-tnx",c.Us2="us2",c.Us2Ix="us2-ix",c.Us2Tnx="us2-tnx"}(_=h.Region||(h.Region={})),h.regionShortcodes={ASIAPAC_SINGAPORE:_.Sg1,ASIAPAC_SYDNEY:_.Au1,ASIAPAC_TOKYO:_.Jp1,EU_FRANKFURT:_.De1,EU_IRELAND:_.Ie1,SOUTH_AMERICA_SAO_PAULO:_.Br1,US_EAST_VIRGINIA:_.Us1,US_WEST_OREGON:_.Us2},h.regionToEdge=((f={})[_.Au1]=E.Sydney,f[_.Br1]=E.SaoPaulo,f[_.Ie1]=E.Dublin,f[_.De1]=E.Frankfurt,f[_.Jp1]=E.Tokyo,f[_.Sg1]=E.Singapore,f[_.Us1]=E.Ashburn,f[_.Us2]=E.Umatilla,f[_.Gll]=E.Roaming,f[_.Us1Ix]=E.AshburnIx,f[_.Us2Ix]=E.SanJoseIx,f[_.Ie1Ix]=E.LondonIx,f[_.De1Ix]=E.FrankfurtIx,f[_.Sg1Ix]=E.SingaporeIx,f[_.Au1Ix]=E.SydneyIx,f[_.Jp1Ix]=E.TokyoIx,f[_.Us1Tnx]=E.AshburnIx,f[_.Us2Tnx]=E.AshburnIx,f[_.Ie1Tnx]=E.LondonIx,f[_.Sg1Tnx]=E.SingaporeIx,f),h.defaultEdge=E.Roaming,h.createEventGatewayURI=function C(c){return c?"eventgw."+c+".twilio.com":"eventgw.twilio.com"},h.createSignalingEndpointURL=function g(c){return"wss://"+c+"/signal"},h.getChunderURIs=function T(c){if(c&&"string"!=typeof c&&!Array.isArray(c))throw new e.InvalidArgumentError("If `edge` is provided, it must be of type `string` or an array of strings.");return c?(Array.isArray(c)?c:[c]).map(function(o){return S(o)}):[S(h.defaultEdge)]},h.getRegionShortcode=function u(c){return h.regionShortcodes[c]||null}},3074:(N,h)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var f=function p(e,E,_){var A=JSON.stringify(E.body||{}),S=new Headers;E.headers=E.headers||[],Object.entries(E.headers).forEach(function(C){return S.append(C[0],C[1])}),fetch(E.url,{body:A,headers:S,method:e}).then(function(C){return C.text()},_).then(function(C){return _(null,C)},_)};f.get=function(E,_){return new this("GET",E,_)},f.post=function(E,_){return new this("POST",E,_)},h.default=f},5011:(N,h,p)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var f=p(1287),e=p(9819);h.default=function E(_,A){return(A=A||{}).util=A.util||e,A.navigator=A.navigator||(typeof navigator<"u"?navigator:null),new Promise(function(S,C){if(!A.navigator)throw new f.NotSupportedError("getUserMedia is not supported");switch("function"){case typeof(A.navigator.mediaDevices&&A.navigator.mediaDevices.getUserMedia):return S(A.navigator.mediaDevices.getUserMedia(_));case typeof A.navigator.webkitGetUserMedia:return A.navigator.webkitGetUserMedia(_,S,C);case typeof A.navigator.mozGetUserMedia:return A.navigator.mozGetUserMedia(_,S,C);case typeof A.navigator.getUserMedia:return A.navigator.getUserMedia(_,S,C);default:throw new f.NotSupportedError("getUserMedia is not supported")}}).catch(function(S){throw A.util.isFirefox()&&"NotReadableError"===S.name?new f.NotSupportedError("Firefox does not currently support opening multiple audio input trackssimultaneously, even across different tabs.\nRelated Bugzilla thread: https://bugzilla.mozilla.org/show_bug.cgi?id=1299324"):S})}},9168:(N,h)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.IceCandidate=void 0;var p=function(){function f(e,E){void 0===E&&(E=!1),this.deleted=!1;var _,A=e.candidate.split("network-cost ");A[1]&&(_=parseInt(A[1],10)),this.candidateType=e.type,this.ip=e.ip||e.address,this.isRemote=E,this.networkCost=_,this.port=e.port,this.priority=e.priority,this.protocol=e.protocol,this.relatedAddress=e.relatedAddress,this.relatedPort=e.relatedPort,this.tcpType=e.tcpType,this.transportId=e.sdpMid}return f.prototype.toPayload=function(){return{candidate_type:this.candidateType,deleted:this.deleted,ip:this.ip,is_remote:this.isRemote,"network-cost":this.networkCost,port:this.port,priority:this.priority,protocol:this.protocol,related_address:this.relatedAddress,related_port:this.relatedPort,tcp_type:this.tcpType,transport_id:this.transportId}},f}();h.IceCandidate=p},6813:(N,h,p)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.PeerConnection=h.getMediaEngine=h.enabled=void 0;var f=p(7578);h.PeerConnection=f.default;var e=p(3110);h.enabled=function E(){return e.default.test()},h.getMediaEngine=function _(){return typeof RTCIceGatherer<"u"?"ORTC":"WebRTC"}},1986:(N,h)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var f=typeof window<"u"?window.RTCStatsReport:void 0;function e(r){if(!(this instanceof e))return new e(r);var v=this;Object.defineProperties(this,{_map:{value:r},size:{enumerable:!0,get:function(){return v._map.size}}}),this[Symbol.iterator]=r[Symbol.iterator]}function E(r){return{bytesReceived:void 0,bytesSent:void 0,dtlsState:void 0,id:r.id,localCertificateId:r.stat("localCertificateId"),remoteCertificateId:r.stat("remoteCertificateId"),rtcpTransportStatsId:void 0,selectedCandidatePairId:r.stat("selectedCandidatePairId"),timestamp:Date.parse(r.timestamp),type:"transport"}}function S(r,v){return{associateStatsId:void 0,codecId:"codec-"+r.id,firCount:v?i(r,"googFirsSent"):void 0,id:r.id,isRemote:void 0,mediaType:r.stat("mediaType"),nackCount:i(r,v?"googNacksSent":"googNacksReceived"),pliCount:i(r,v?"googPlisSent":"googPlisReceived"),qpSum:i(r,"qpSum"),sliCount:void 0,ssrc:r.stat("ssrc"),timestamp:Date.parse(r.timestamp),trackId:"track-"+r.id,transportId:r.stat("transportId")}}function T(r,v){return{candidateType:o(r.stat("candidateType")),deleted:void 0,id:r.id,ip:r.stat("ipAddress"),isRemote:v,port:i(r,"portNumber"),priority:n(r,"priority"),protocol:r.stat("transport"),relayProtocol:void 0,timestamp:Date.parse(r.timestamp),transportId:void 0,type:v?"remote-candidate":"local-candidate",url:void 0}}function s(r){return isNaN(r)||""===r?void 0:parseInt(r,10)/1e3}function o(r){switch(r){case"peerreflexive":return"prflx";case"serverreflexive":return"srflx";default:return r}}function i(r,v){var l=r.stat(v);return a(r,v)?parseInt(l,10):void 0}function n(r,v){var l=r.stat(v);return a(r,v)?parseFloat(l):void 0}function t(r,v){var l=r.stat(v);return a(r,v)?"true"===l||!0===l:void 0}function a(r,v){var l=r.stat(v);return typeof l<"u"&&""!==l}f&&((e.prototype=Object.create(f.prototype)).constructor=e),["entries","forEach","get","has","keys","values"].forEach(function(r){e.prototype[r]=function(){for(var v,l=[],y=0;y<arguments.length;y++)l[y]=arguments[y];return(v=this._map)[r].apply(v,l)}}),e.fromArray=function(v){return new e(v.reduce(function(l,y){return l.set(y.id,y),l},new Map))},e.fromRTCStatsResponse=function(v){var l,y=new Map,b=v.result().reduce(function(x,Z){var L=Z.id;switch(Z.type){case"googCertificate":x.set(L,function c(r){return{base64Certificate:r.stat("googDerBase64"),fingerprint:r.stat("googFingerprint"),fingerprintAlgorithm:r.stat("googFingerprintAlgorithm"),id:r.id,issuerCertificateId:r.stat("googIssuerId"),timestamp:Date.parse(r.timestamp),type:"certificate"}}(Z));break;case"datachannel":x.set(L,function m(r){return{bytesReceived:void 0,bytesSent:void 0,datachannelid:r.stat("datachannelid"),id:r.id,label:r.stat("label"),messagesReceived:void 0,messagesSent:void 0,protocol:r.stat("protocol"),state:r.stat("state"),timestamp:Date.parse(r.timestamp),transportId:r.stat("transportId"),type:"data-channel"}}(Z));break;case"googCandidatePair":t(Z,"googActiveConnection")&&(l=L),x.set(L,function u(r){return{availableIncomingBitrate:void 0,availableOutgoingBitrate:void 0,bytesReceived:i(r,"bytesReceived"),bytesSent:i(r,"bytesSent"),consentRequestsSent:i(r,"consentRequestsSent"),currentRoundTripTime:s(r.stat("googRtt")),id:r.id,lastPacketReceivedTimestamp:void 0,lastPacketSentTimestamp:void 0,localCandidateId:r.stat("localCandidateId"),nominated:void 0,priority:void 0,readable:void 0,remoteCandidateId:r.stat("remoteCandidateId"),requestsReceived:i(r,"requestsReceived"),requestsSent:i(r,"requestsSent"),responsesReceived:i(r,"responsesReceived"),responsesSent:i(r,"responsesSent"),retransmissionsReceived:void 0,retransmissionsSent:void 0,state:void 0,timestamp:Date.parse(r.timestamp),totalRoundTripTime:void 0,transportId:r.stat("googChannelId"),type:"candidate-pair",writable:t(r,"googWritable")}}(Z));break;case"localcandidate":x.set(L,T(Z,!1));break;case"remotecandidate":x.set(L,T(Z,!0));break;case"ssrc":a(Z,"packetsReceived")?x.set("rtp-"+L,function C(r){var v=S(r,!0);return Object.assign(v,{burstDiscardCount:void 0,burstDiscardRate:void 0,burstLossCount:void 0,burstLossRate:void 0,burstPacketsDiscarded:void 0,burstPacketsLost:void 0,bytesReceived:i(r,"bytesReceived"),fractionLost:void 0,framesDecoded:i(r,"framesDecoded"),gapDiscardRate:void 0,gapLossRate:void 0,jitter:s(r.stat("googJitterReceived")),packetsDiscarded:void 0,packetsLost:i(r,"packetsLost"),packetsReceived:i(r,"packetsReceived"),packetsRepaired:void 0,roundTripTime:s(r.stat("googRtt")),type:"inbound-rtp"}),v}(Z)):x.set("rtp-"+L,function g(r){var v=S(r,!1);return Object.assign(v,{bytesSent:i(r,"bytesSent"),framesEncoded:i(r,"framesEncoded"),packetsSent:i(r,"packetsSent"),remoteTimestamp:void 0,targetBitrate:void 0,type:"outbound-rtp"}),v}(Z)),x.set("track-"+L,function A(r){return{audioLevel:a(r,"audioOutputLevel")?i(r,"audioOutputLevel")/32767:(i(r,"audioInputLevel")||0)/32767,detached:void 0,echoReturnLoss:n(r,"googEchoCancellationReturnLoss"),echoReturnLossEnhancement:n(r,"googEchoCancellationReturnLossEnhancement"),ended:void 0,frameHeight:a(r,"googFrameHeightReceived")?i(r,"googFrameHeightReceived"):i(r,"googFrameHeightSent"),frameWidth:a(r,"googFrameWidthReceived")?i(r,"googFrameWidthReceived"):i(r,"googFrameWidthSent"),framesCorrupted:void 0,framesDecoded:i(r,"framesDecoded"),framesDropped:void 0,framesPerSecond:void 0,framesReceived:void 0,framesSent:i(r,"framesEncoded"),fullFramesLost:void 0,id:r.id,kind:r.stat("mediaType"),partialFramesLost:void 0,remoteSource:void 0,ssrcIds:void 0,timestamp:Date.parse(r.timestamp),trackIdentifier:r.stat("googTrackId"),type:"track"}}(Z)),x.set("codec-"+L,function _(r){return{channels:void 0,clockRate:void 0,id:r.id,implementation:void 0,mimeType:r.stat("mediaType")+"/"+r.stat("googCodecName"),payloadType:void 0,sdpFmtpLine:void 0,timestamp:Date.parse(r.timestamp),type:"codec"}}(Z));break;case"googComponent":var w=E(Z);y.set(w.selectedCandidatePairId,L),x.set(L,E(Z))}return x},new Map);if(l){var O=y.get(l);O&&(b.get(O).dtlsState="connected")}return new e(b)},h.default=e},4938:(N,h)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.isNonNegativeNumber=h.calculate=void 0;var p=94.768;function f(E,_,A){if("number"!=typeof E||"number"!=typeof _||"number"!=typeof A||!e(E)||!e(_)||!e(A))return null;var S=E+2*_+10,C=0;switch(!0){case S<160:C=p-S/40;break;case S<1e3:C=p-(S-120)/10}return 1+.035*(C=1==A<=C/2.5?Math.max(C-2.5*A,6.52):0)+7e-6*C*(C-60)*(100-C)}function e(E){return"number"==typeof E&&!isNaN(E)&&isFinite(E)&&E>=0}h.calculate=f,h.isNonNegativeNumber=e,h.default={calculate:f,isNonNegativeNumber:e}},7578:(N,h,p)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var f=p(1287),e=p(990),E=p(9819),_=p(3110),A=p(2563);function c(n,t,a,r){if(!n||!t||!a)throw new f.InvalidArgumentError("Audiohelper, pstream and getUserMedia are required arguments");if(!(this instanceof c))return new c(n,t,a,r);function v(){this._log.warn("Unexpected noop call in peerconnection")}this._log=e.default.getInstance(),this.onaudio=v,this.onopen=v,this.onerror=v,this.onclose=v,this.ondisconnected=v,this.onfailed=v,this.onconnected=v,this.onreconnected=v,this.onsignalingstatechange=v,this.ondtlstransportstatechange=v,this.onicegatheringfailure=v,this.onicegatheringstatechange=v,this.oniceconnectionstatechange=v,this.onpcconnectionstatechange=v,this.onicecandidate=v,this.onselectedcandidatepairchange=v,this.onvolume=v,this.version=null,this.pstream=t,this.stream=null,this.sinkIds=new Set(["default"]),this.outputs=new Map,this.status="connecting",this.callSid=null,this.isMuted=!1,this.getUserMedia=a;var l=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);return this._isSinkSupported=!!l&&typeof HTMLAudioElement<"u"&&HTMLAudioElement.prototype.setSinkId,this._audioContext=l&&n._audioContext,this._hasIceCandidates=!1,this._hasIceGatheringFailures=!1,this._iceGatheringTimeoutId=null,this._masterAudio=null,this._masterAudioDeviceId=null,this._mediaStreamSource=null,this._dtmfSender=null,this._dtmfSenderUnsupported=!1,this._callEvents=[],this._nextTimeToPublish=Date.now(),this._onAnswerOrRinging=v,this._onHangup=v,this._remoteStream=null,this._shouldManageStream=!0,this._iceState="new",this._isUnifiedPlan=r.isUnifiedPlan,this.options=r=r||{},this.navigator=r.navigator||(typeof navigator<"u"?navigator:null),this.util=r.util||E,this.codecPreferences=r.codecPreferences,this}function m(n,t){"function"==typeof n.addTrack?t.getAudioTracks().forEach(function(a){n.addTrack(a,t)}):n.addStream(t)}function s(n){var t=typeof MediaStream<"u"?new MediaStream:new webkitMediaStream;return n.getAudioTracks().forEach(t.addTrack,t),t}function i(n,t){if(typeof n.srcObject<"u")n.srcObject=t;else if(typeof n.mozSrcObject<"u")n.mozSrcObject=t;else{if(!(typeof n.src<"u"))return!1;var a=n.options.window||window;n.src=(a.URL||a.webkitURL).createObjectURL(t)}return!0}c.prototype.uri=function(){return this._uri},c.prototype.openWithConstraints=function(n){return this.getUserMedia({audio:n}).then(this._setInputTracksFromStream.bind(this,!1))},c.prototype.setInputTracksFromStream=function(n){var t=this;return this._setInputTracksFromStream(!0,n).then(function(){t._shouldManageStream=!1})},c.prototype._createAnalyser=function(n,t){t=Object.assign({fftSize:32,smoothingTimeConstant:.3},t);var a=n.createAnalyser();for(var r in t)a[r]=t[r];return a},c.prototype._setVolumeHandler=function(n){this.onvolume=n},c.prototype._startPollingVolume=function(){if(this._audioContext&&this.stream&&this._remoteStream){var n=this._audioContext,t=this._inputAnalyser=this._createAnalyser(n),r=new Uint8Array(t.frequencyBinCount);this._inputAnalyser2=this._createAnalyser(n,{maxDecibels:0,minDecibels:-127,smoothingTimeConstant:0});var v=this._outputAnalyser=this._createAnalyser(n),y=new Uint8Array(v.frequencyBinCount);this._outputAnalyser2=this._createAnalyser(n,{maxDecibels:0,minDecibels:-127,smoothingTimeConstant:0}),this._updateInputStreamSource(this.stream),this._updateOutputStreamSource(this._remoteStream);var b=this;setTimeout(function O(){if(b._audioContext){if("closed"===b.status)return b._inputAnalyser.disconnect(),b._outputAnalyser.disconnect(),b._inputAnalyser2.disconnect(),void b._outputAnalyser2.disconnect();b._inputAnalyser.getByteFrequencyData(r);var x=b.util.average(r);b._inputAnalyser2.getByteFrequencyData(r);var Z=b.util.average(r);b._outputAnalyser.getByteFrequencyData(y);var L=b.util.average(y);b._outputAnalyser2.getByteFrequencyData(y);var w=b.util.average(y);b.onvolume(x/255,L/255,Z,w),setTimeout(O,50)}},50)}},c.prototype._stopStream=function(t){this._shouldManageStream&&("function"==typeof MediaStreamTrack.prototype.stop?("function"==typeof t.getAudioTracks?t.getAudioTracks():t.audioTracks).forEach(function(r){r.stop()}):t.stop())},c.prototype._updateInputStreamSource=function(n){this._inputStreamSource&&this._inputStreamSource.disconnect();try{this._inputStreamSource=this._audioContext.createMediaStreamSource(n),this._inputStreamSource.connect(this._inputAnalyser),this._inputStreamSource.connect(this._inputAnalyser2)}catch(t){this._log.warn("Unable to update input MediaStreamSource",t),this._inputStreamSource=null}},c.prototype._updateOutputStreamSource=function(n){this._outputStreamSource&&this._outputStreamSource.disconnect();try{this._outputStreamSource=this._audioContext.createMediaStreamSource(n),this._outputStreamSource.connect(this._outputAnalyser),this._outputStreamSource.connect(this._outputAnalyser2)}catch(t){this._log.warn("Unable to update output MediaStreamSource",t),this._outputStreamSource=null}},c.prototype._setInputTracksFromStream=function(n,t){return this._isUnifiedPlan?this._setInputTracksForUnifiedPlan(n,t):this._setInputTracksForPlanB(n,t)},c.prototype._setInputTracksForPlanB=function(n,t){var a=this;if(!t)return Promise.reject(new f.InvalidArgumentError("Can not set input stream to null while in a call"));if(!t.getAudioTracks().length)return Promise.reject(new f.InvalidArgumentError("Supplied input stream has no audio tracks"));var r=this.stream;return r?(this._stopStream(r),function o(n,t){"function"==typeof n.removeTrack?n.getSenders().forEach(function(a){n.removeTrack(a)}):n.removeStream(t)}(this.version.pc,r),r.getAudioTracks().forEach(r.removeTrack,r),t.getAudioTracks().forEach(r.addTrack,r),m(this.version.pc,t),this._updateInputStreamSource(this.stream)):this.stream=n?s(t):t,this.mute(this.isMuted),this.version?new Promise(function(v,l){a.version.createOffer(a.options.maxAverageBitrate,a.codecPreferences,{audio:!0},function(){a.version.processAnswer(a.codecPreferences,a._answerSdp,function(){v(a.stream)},l)},l)}):Promise.resolve(this.stream)},c.prototype._setInputTracksForUnifiedPlan=function(n,t){var a=this;if(!t)return Promise.reject(new f.InvalidArgumentError("Can not set input stream to null while in a call"));if(!t.getAudioTracks().length)return Promise.reject(new f.InvalidArgumentError("Supplied input stream has no audio tracks"));var r=this.stream,v=function(){return a.mute(a.isMuted),Promise.resolve(a.stream)};return r?(this._shouldManageStream&&this._stopStream(r),this._sender||(this._sender=this.version.pc.getSenders()[0]),this._sender.replaceTrack(t.getAudioTracks()[0]).then(function(){return a._updateInputStreamSource(t),v()})):(this.stream=n?s(t):t,v())},c.prototype._onInputDevicesChanged=function(){this.stream&&this.stream.getAudioTracks().every(function(t){return"ended"===t.readyState})&&this._shouldManageStream&&this.openWithConstraints(!0)},c.prototype._onIceGatheringFailure=function(n){this._hasIceGatheringFailures=!0,this.onicegatheringfailure(n)},c.prototype._onMediaConnectionStateChange=function(n){var a,t=this._iceState;if(t!==n&&("connected"===n||"disconnected"===n||"failed"===n))switch(this._iceState=n,n){case"connected":"disconnected"===t||"failed"===t?(this._log.info(a="ICE liveliness check succeeded. Connection with Twilio restored"),this.onreconnected(a)):(this._log.info(a="Media connection established."),this.onconnected(a)),this._stopIceGatheringTimeout(),this._hasIceGatheringFailures=!1;break;case"disconnected":this._log.info(a="ICE liveliness check failed. May be having trouble connecting to Twilio"),this.ondisconnected(a);break;case"failed":this._log.info(a="Connection with Twilio was interrupted."),this.onfailed(a)}},c.prototype._setSinkIds=function(n){return this._isSinkSupported?(this.sinkIds=new Set(n.forEach?n:[n]),this.version?this._updateAudioOutputs():Promise.resolve()):Promise.reject(new f.NotSupportedError("Audio output selection is not supported by this browser"))},c.prototype._startIceGatheringTimeout=function(){var t=this;this._stopIceGatheringTimeout(),this._iceGatheringTimeoutId=setTimeout(function(){t._onIceGatheringFailure("timeout")},15e3)},c.prototype._stopIceGatheringTimeout=function(){clearInterval(this._iceGatheringTimeoutId)},c.prototype._updateAudioOutputs=function(){var t=Array.from(this.sinkIds).filter(function(l){return!this.outputs.has(l)},this),a=Array.from(this.outputs.keys()).filter(function(l){return!this.sinkIds.has(l)},this),r=this,v=t.map(this._createAudioOutput,this);return Promise.all(v).then(function(){return Promise.all(a.map(r._removeAudioOutput,r))})},c.prototype._createAudio=function(t){var a=new Audio(t);return this.onaudio(a),a},c.prototype._createAudioOutput=function(t){var a=null;this._mediaStreamSource&&(a=this._audioContext.createMediaStreamDestination(),this._mediaStreamSource.connect(a));var r=this._createAudio();i(r,a&&a.stream?a.stream:this.pcStream);var v=this;return r.setSinkId(t).then(function(){return r.play()}).then(function(){v.outputs.set(t,{audio:r,dest:a})})},c.prototype._removeAudioOutputs=function(){return this._masterAudio&&typeof this._masterAudioDeviceId<"u"&&(this._disableOutput(this,this._masterAudioDeviceId),this.outputs.delete(this._masterAudioDeviceId),this._masterAudioDeviceId=null,this._masterAudio.paused||this._masterAudio.pause(),typeof this._masterAudio.srcObject<"u"?this._masterAudio.srcObject=null:this._masterAudio.src="",this._masterAudio=null),Array.from(this.outputs.keys()).map(this._removeAudioOutput,this)},c.prototype._disableOutput=function(t,a){var r=t.outputs.get(a);r&&(r.audio&&(r.audio.pause(),r.audio.src=""),r.dest&&r.dest.disconnect())},c.prototype._reassignMasterOutput=function(t,a){var r=t.outputs.get(a);t.outputs.delete(a);var v=this,l=Array.from(t.outputs.keys())[0]||"default";return r.audio.setSinkId(l).then(function(){v._disableOutput(t,l),t.outputs.set(l,r),t._masterAudioDeviceId=l}).catch(function(){t.outputs.set(a,r),v._log.info("Could not reassign master output. Attempted to roll back.")})},c.prototype._removeAudioOutput=function(t){return this._masterAudioDeviceId===t?this._reassignMasterOutput(this,t):(this._disableOutput(this,t),this.outputs.delete(t),Promise.resolve())},c.prototype._onAddTrack=function(t,a){var r=t._masterAudio=this._createAudio();i(r,a),r.play();var v=Array.from(t.outputs.keys())[0]||"default";t._masterAudioDeviceId=v,t.outputs.set(v,{audio:r});try{t._mediaStreamSource=t._audioContext.createMediaStreamSource(a)}catch(l){this._log.warn("Unable to create a MediaStreamSource from onAddTrack",l),this._mediaStreamSource=null}t.pcStream=a,t._updateAudioOutputs()},c.prototype._fallbackOnAddTrack=function(t,a){var r=document&&document.createElement("audio");r.autoplay=!0,i(r,a)||t._log.info("Error attaching stream to element."),t.outputs.set("default",{audio:r})},c.prototype._setEncodingParameters=function(n){if(n&&this._sender&&"function"==typeof this._sender.getParameters&&"function"==typeof this._sender.setParameters){var t=this._sender.getParameters();!t.priority&&(!t.encodings||!t.encodings.length)||(t.priority="high",t.encodings&&t.encodings.length&&t.encodings.forEach(function(a){a.priority="high",a.networkPriority="high"}),this._sender.setParameters(t))}},c.prototype._setupPeerConnection=function(n,t){var a=this,r=this,v=new(this.options.rtcpcFactory||_.default)({RTCPeerConnection:this.options.RTCPeerConnection});return v.create(n,t),m(v.pc,this.stream),v.pc["ontrack"in v.pc?"ontrack":"onaddstream"]=function(y){var b=r._remoteStream=y.stream||y.streams[0];"function"==typeof v.pc.getSenders&&(a._sender=v.pc.getSenders()[0]),r._isSinkSupported?r._onAddTrack(r,b):r._fallbackOnAddTrack(r,b),r._startPollingVolume()},v},c.prototype._maybeSetIceAggressiveNomination=function(n){return this.options.forceAggressiveIceNomination?A.setIceAggressiveNomination(n):n},c.prototype._setupChannel=function(){var n=this,t=this.version.pc;this.version.pc.onopen=function(){n.status="open",n.onopen()},this.version.pc.onstatechange=function(){n.version.pc&&"stable"===n.version.pc.readyState&&(n.status="open",n.onopen())},this.version.pc.onsignalingstatechange=function(){n._log.info('signalingState is "'+t.signalingState+'"'),n.version.pc&&"stable"===n.version.pc.signalingState&&(n.status="open",n.onopen()),n.onsignalingstatechange(t.signalingState)},t.onconnectionstatechange=function(a){var r=t.connectionState;if(!r&&a&&a.target){var v=a.target;n._log.info("pc.connectionState not detected. Using target PC. State="+(r=v.connectionState||v.connectionState_))}r?n._log.info('pc.connectionState is "'+r+'"'):n._log.warn('onconnectionstatechange detected but state is "'+r+'"'),n.onpcconnectionstatechange(r),n._onMediaConnectionStateChange(r)},t.onicecandidate=function(a){var r=a.candidate;r&&(n._hasIceCandidates=!0,n.onicecandidate(r),n._setupRTCIceTransportListener()),n._log.info("ICE Candidate: "+JSON.stringify(r))},t.onicegatheringstatechange=function(){var a=t.iceGatheringState;"gathering"===a?n._startIceGatheringTimeout():"complete"===a&&(n._stopIceGatheringTimeout(),n._hasIceCandidates||n._onIceGatheringFailure("none"),n._hasIceCandidates&&n._hasIceGatheringFailures&&n._startIceGatheringTimeout()),n._log.info('pc.iceGatheringState is "'+t.iceGatheringState+'"'),n.onicegatheringstatechange(a)},t.oniceconnectionstatechange=function(){n._log.info('pc.iceConnectionState is "'+t.iceConnectionState+'"'),n.oniceconnectionstatechange(t.iceConnectionState),n._onMediaConnectionStateChange(t.iceConnectionState)}},c.prototype._initializeMediaStream=function(n,t){return"open"!==this.status&&("disconnected"===this.pstream.status?(this.onerror({info:{code:31e3,message:"Cannot establish connection. Client is disconnected",twilioError:new f.SignalingErrors.ConnectionDisconnected}}),this.close(),!1):(this.version=this._setupPeerConnection(n,t),this._setupChannel(),!0))},c.prototype._removeReconnectionListeners=function(){this.pstream&&(this.pstream.removeListener("answer",this._onAnswerOrRinging),this.pstream.removeListener("hangup",this._onHangup))},c.prototype._setupRTCDtlsTransportListener=function(){var n=this,t=this.getRTCDtlsTransport();if(t&&!t.onstatechange){var a=function(){n._log.info('dtlsTransportState is "'+t.state+'"'),n.ondtlstransportstatechange(t.state)};a(),t.onstatechange=a}},c.prototype._setupRTCIceTransportListener=function(){var n=this,t=this._getRTCIceTransport();!t||t.onselectedcandidatepairchange||(t.onselectedcandidatepairchange=function(){return n.onselectedcandidatepairchange(t.getSelectedCandidatePair())})},c.prototype.iceRestart=function(){var n=this;this._log.info("Attempting to restart ICE..."),this._hasIceCandidates=!1,this.version.createOffer(this.options.maxAverageBitrate,this.codecPreferences,{iceRestart:!0}).then(function(){n._removeReconnectionListeners(),n._onAnswerOrRinging=function(t){if(n._removeReconnectionListeners(),t.sdp&&"have-local-offer"===n.version.pc.signalingState){var r=n._maybeSetIceAggressiveNomination(t.sdp);n._answerSdp=r,"closed"!==n.status&&n.version.processAnswer(n.codecPreferences,r,null,function(v){n._log.info("Failed to process answer during ICE Restart. Error: "+(v&&v.message?v.message:v))})}else n._log.info("Invalid state or param during ICE Restart:hasSdp:"+!!t.sdp+", signalingState:"+n.version.pc.signalingState)},n._onHangup=function(){n._log.info("Received hangup during ICE Restart"),n._removeReconnectionListeners()},n.pstream.on("answer",n._onAnswerOrRinging),n.pstream.on("hangup",n._onHangup),n.pstream.reinvite(n.version.getSDP(),n.callSid)}).catch(function(t){var a=t&&t.message?t.message:t;n._log.info("Failed to createOffer during ICE Restart. Error: "+a),n.onfailed(a)})},c.prototype.makeOutgoingCall=function(n,t,a,r,v,l){var y=this;if(this._initializeMediaStream(r,v)){var b=this;this.callSid=a,this._onAnswerOrRinging=function(w){if(w.sdp){var P=y._maybeSetIceAggressiveNomination(w.sdp);b._answerSdp=P,"closed"!==b.status&&b.version.processAnswer(y.codecPreferences,P,O,x),b.pstream.removeListener("answer",b._onAnswerOrRinging),b.pstream.removeListener("ringing",b._onAnswerOrRinging)}},this.pstream.on("answer",this._onAnswerOrRinging),this.pstream.on("ringing",this._onAnswerOrRinging),this.version.createOffer(this.options.maxAverageBitrate,this.codecPreferences,{audio:!0},function Z(){"closed"!==b.status&&(b.pstream.invite(b.version.getSDP(),b.callSid,b.options.preflight,t),b._setupRTCDtlsTransportListener())},function L(w){b.onerror({info:{code:31e3,message:"Error creating the offer: "+(w.message||w),twilioError:new f.MediaErrors.ClientLocalDescFailed}})})}function O(){b.options&&b._setEncodingParameters(b.options.dscp),l(b.version.pc)}function x(w){b.onerror({info:{code:31e3,message:"Error processing answer: "+(w.message||w),twilioError:new f.MediaErrors.ClientRemoteDescFailed}})}},c.prototype.answerIncomingCall=function(n,t,a,r,v){if(this._initializeMediaStream(a,r)){t=this._maybeSetIceAggressiveNomination(t),this._answerSdp=t.replace(/^a=setup:actpass$/gm,"a=setup:passive"),this.callSid=n;var l=this;this.version.processSDP(this.options.maxAverageBitrate,this.codecPreferences,t,{audio:!0},function y(){"closed"!==l.status&&(l.pstream.answer(l.version.getSDP(),n),l.options&&l._setEncodingParameters(l.options.dscp),v(l.version.pc),l._setupRTCDtlsTransportListener())},function b(O){l.onerror({info:{code:31e3,message:"Error creating the answer: "+(O.message||O),twilioError:new f.MediaErrors.ClientRemoteDescFailed}})})}},c.prototype.close=function(){this.version&&this.version.pc&&("closed"!==this.version.pc.signalingState&&this.version.pc.close(),this.version.pc=null),this.stream&&(this.mute(!1),this._stopStream(this.stream)),this.stream=null,this._removeReconnectionListeners(),this._stopIceGatheringTimeout(),Promise.all(this._removeAudioOutputs()).catch(function(){}),this._mediaStreamSource&&this._mediaStreamSource.disconnect(),this._inputAnalyser&&this._inputAnalyser.disconnect(),this._outputAnalyser&&this._outputAnalyser.disconnect(),this._inputAnalyser2&&this._inputAnalyser2.disconnect(),this._outputAnalyser2&&this._outputAnalyser2.disconnect(),this.status="closed",this.onclose()},c.prototype.reject=function(n){this.callSid=n},c.prototype.ignore=function(n){this.callSid=n},c.prototype.mute=function(n){this.isMuted=n,this.stream&&(this._sender&&this._sender.track?this._sender.track.enabled=!n:("function"==typeof this.stream.getAudioTracks?this.stream.getAudioTracks():this.stream.audioTracks).forEach(function(a){a.enabled=!n}))},c.prototype.getOrCreateDTMFSender=function(){if(this._dtmfSender||this._dtmfSenderUnsupported)return this._dtmfSender||null;var t=this,a=this.version.pc;if(!a)return this._log.info("No RTCPeerConnection available to call createDTMFSender on"),null;if("function"==typeof a.getSenders&&("function"==typeof RTCDTMFSender||"function"==typeof RTCDtmfSender)){var r=a.getSenders().find(function(l){return l.dtmf});if(r)return this._log.info("Using RTCRtpSender#dtmf"),this._dtmfSender=r.dtmf,this._dtmfSender}if("function"==typeof a.createDTMFSender&&"function"==typeof a.getLocalStreams){var v=a.getLocalStreams().map(function(l){var y=t._getAudioTracks(l);return y&&y[0]})[0];return v?(this._log.info("Creating RTCDTMFSender"),this._dtmfSender=a.createDTMFSender(v),this._dtmfSender):(this._log.info("No local audio MediaStreamTrack available on the RTCPeerConnection to pass to createDTMFSender"),null)}return this._log.info("RTCPeerConnection does not support RTCDTMFSender"),this._dtmfSenderUnsupported=!0,null},c.prototype.getRTCDtlsTransport=function(){var t=this.version&&this.version.pc&&"function"==typeof this.version.pc.getSenders&&this.version.pc.getSenders()[0];return t&&t.transport||null},c.prototype._canStopMediaStreamTrack=function(){return"function"==typeof MediaStreamTrack.prototype.stop},c.prototype._getAudioTracks=function(n){return"function"==typeof n.getAudioTracks?n.getAudioTracks():n.audioTracks},c.prototype._getRTCIceTransport=function(){var t=this.getRTCDtlsTransport();return t&&t.iceTransport||null},c.protocol=_.default.test()?new _.default:null,c.enabled=_.default.test(),h.default=c},3110:(N,h,p)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var f=p(990),e=p(9819),E=p(2563),_=p(4191);function A(T){typeof window>"u"?this.log.info("No RTCPeerConnection implementation available. The window object was not found."):T&&T.RTCPeerConnection?this.RTCPeerConnection=T.RTCPeerConnection:e.isLegacyEdge()?this.RTCPeerConnection=new _(typeof window<"u"?window:global):"function"==typeof window.RTCPeerConnection?this.RTCPeerConnection=window.RTCPeerConnection:"function"==typeof window.webkitRTCPeerConnection?this.RTCPeerConnection=webkitRTCPeerConnection:"function"==typeof window.mozRTCPeerConnection?(this.RTCPeerConnection=mozRTCPeerConnection,window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate):this.log.info("No RTCPeerConnection implementation available")}function S(T,u,c,m){return function(){var s=Array.prototype.slice.call(arguments);return new Promise(function(o){var i=T.apply(u,s);if(m){if("object"!=typeof i||"function"!=typeof i.then)throw new Error;o(i)}else o(i)}).catch(function(){return new Promise(function(o,i){T.apply(u,c?[o,i].concat(s):s.concat([o,i]))})})}}function C(T,u){return S(T,u,!0,!0)}function g(T,u){return S(T,u,!1,!1)}A.prototype.create=function(T,u){this.log=f.default.getInstance(),this.pc=new this.RTCPeerConnection(u,T)},A.prototype.createModernConstraints=function(T){if(typeof T>"u")return null;var u=Object.assign({},T);return typeof webkitRTCPeerConnection<"u"&&!e.isLegacyEdge()?(u.mandatory={},typeof T.audio<"u"&&(u.mandatory.OfferToReceiveAudio=T.audio),typeof T.video<"u"&&(u.mandatory.OfferToReceiveVideo=T.video)):(typeof T.audio<"u"&&(u.offerToReceiveAudio=T.audio),typeof T.video<"u"&&(u.offerToReceiveVideo=T.video)),delete u.audio,delete u.video,u},A.prototype.createOffer=function(T,u,c,m,s){var o=this;return c=this.createModernConstraints(c),C(this.pc.createOffer,this.pc)(c).then(function(i){if(!o.pc)return Promise.resolve();var n=E.setMaxAverageBitrate(i.sdp,T);return g(o.pc.setLocalDescription,o.pc)(new RTCSessionDescription({sdp:E.setCodecPreferences(n,u),type:"offer"}))}).then(m,s)},A.prototype.createAnswer=function(T,u,c,m,s){var o=this;return c=this.createModernConstraints(c),C(this.pc.createAnswer,this.pc)(c).then(function(i){if(!o.pc)return Promise.resolve();var n=E.setMaxAverageBitrate(i.sdp,T);return g(o.pc.setLocalDescription,o.pc)(new RTCSessionDescription({sdp:E.setCodecPreferences(n,u),type:"answer"}))}).then(m,s)},A.prototype.processSDP=function(T,u,c,m,s,o){var i=this;c=E.setCodecPreferences(c,u);var n=new RTCSessionDescription({sdp:c,type:"offer"});return g(this.pc.setRemoteDescription,this.pc)(n).then(function(){i.createAnswer(T,u,m,s,o)})},A.prototype.getSDP=function(){return this.pc.localDescription.sdp},A.prototype.processAnswer=function(T,u,c,m){return this.pc?(u=E.setCodecPreferences(u,T),g(this.pc.setRemoteDescription,this.pc)(new RTCSessionDescription({sdp:u,type:"answer"})).then(c,m)):Promise.resolve()},A.test=function(){if("object"==typeof navigator){var T=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.getUserMedia;if(e.isLegacyEdge(navigator))return!1;if(T&&"function"==typeof window.RTCPeerConnection)return!0;if(T&&"function"==typeof window.webkitRTCPeerConnection)return!0;if(T&&"function"==typeof window.mozRTCPeerConnection){try{if("function"!=typeof(new window.mozRTCPeerConnection).getLocalStreams)return!1}catch{return!1}return!0}if(typeof RTCIceGatherer<"u")return!0}return!1},h.default=A},2563:(N,h,p)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.setMaxAverageBitrate=h.setIceAggressiveNomination=h.setCodecPreferences=h.getPreferredCodecInfo=void 0;var f=p(9819),e={0:"PCMU",8:"PCMA"};h.getPreferredCodecInfo=function S(n){var t=/a=rtpmap:(\d+) (\S+)/m.exec(n)||[null,"",""];return{codecName:t[2],codecParams:(new RegExp("a=fmtp:"+t[1]+" (\\S+)","m").exec(n)||[null,""])[1]}},h.setIceAggressiveNomination=function C(n){return f.isChrome(window,window.navigator)?n.split("\n").filter(function(t){return-1===t.indexOf("a=ice-lite")}).join("\n"):n},h.setMaxAverageBitrate=function g(n,t){if("number"!=typeof t||t<6e3||t>51e4)return n;var a=/a=rtpmap:(\d+) opus/m.exec(n),v=new RegExp("a=fmtp:"+(a&&a.length?a[1]:111));return n.split("\n").map(function(y){return v.test(y)?y+";maxaveragebitrate="+t:y}).join("\n")},h.setCodecPreferences=function T(n,t){var a=function u(n,t,a){return n.replace(/\r\n\r\n$/,"\r\n").split("\r\nm=").slice(1).map(function(r){return"m="+r}).filter(function(r){var v=new RegExp("m="+(t||".*"),"gm"),l=new RegExp("a="+(a||".*"),"gm");return v.test(r)&&l.test(r)})}(n);return[n.split("\r\nm=")[0]].concat(a.map(function(v){if(!/^m=(audio|video)/.test(v))return v;var l=v.match(/^m=(audio|video)/)[1],y=function c(n){return Array.from(function o(n){return function i(n){var a=n.split("\r\n")[0].match(/([0-9]+)/g);return a?a.slice(1).map(function(r){return parseInt(r,10)}):[]}(n).reduce(function(t,a){var r=new RegExp("a=rtpmap:"+a+" ([^/]+)"),v=n.match(r),l=v?v[1].toLowerCase():e[a]?e[a].toLowerCase():"";return t.set(a,l)},new Map)}(n)).reduce(function(t,a){var r=a[0],v=a[1],l=t.get(v)||[];return t.set(v,l.concat(r))},new Map)}(v),b=function m(n,t){t=t.map(function(l){return l.toLowerCase()});var a=f.flatMap(t,function(l){return n.get(l)||[]}),r=f.difference(Array.from(n.keys()),t),v=f.flatMap(r,function(l){return n.get(l)});return a.concat(v)}(y,t),O=function s(n,t){var a=t.split("\r\n"),r=a[0],v=a.slice(1);return[r=r.replace(/([0-9]+\s?)+$/,n.join(" "))].concat(v).join("\r\n")}(b,v),x=y.get("pcma")||[],Z=y.get("pcmu")||[];return("audio"===l?new Set(x.concat(Z)):new Set).has(b[0])?O.replace(/\r\nb=(AS|TIAS):([0-9]+)/g,""):O})).join("\r\n")}},5610:function(N,h,p){"use strict";var f=this&&this.__spreadArrays||function(){for(var m=0,s=0,o=arguments.length;s<o;s++)m+=arguments[s].length;var i=Array(m),n=0;for(s=0;s<o;s++)for(var t=arguments[s],a=0,r=t.length;a<r;a++,n++)i[n]=t[a];return i};Object.defineProperty(h,"__esModule",{value:!0}),h.getRTCIceCandidateStatsReport=h.getRTCStats=void 0;var e=p(1287),E=p(1986);function S(m,s){return"function"==typeof m.get?m.get(s):m.find(function(o){return o.id===s})}function C(m){if(!m)return Promise.reject(new e.InvalidArgumentError("PeerConnection is null"));if("function"!=typeof m.getStats)return Promise.reject(new e.NotSupportedError("WebRTC statistics are unsupported"));var s;try{s=m.getStats()}catch{s=new Promise(function(i){return m.getStats(i)}).then(E.default.fromRTCStatsResponse)}return s}function u(){}function c(m){var i,s=null,o=new u;Array.from(m.values()).forEach(function(v){if(!v.isRemote){var l=v.type.replace("-","");if(i=i||v.timestamp,v.remoteId){var y=S(m,v.remoteId);y&&y.roundTripTime&&(o.rtt=1e3*y.roundTripTime)}switch(l){case"inboundrtp":o.timestamp=o.timestamp||v.timestamp,o.jitter=1e3*v.jitter,o.packetsLost=v.packetsLost,o.packetsReceived=v.packetsReceived,o.bytesReceived=v.bytesReceived;break;case"outboundrtp":if(o.timestamp=v.timestamp,o.packetsSent=v.packetsSent,o.bytesSent=v.bytesSent,v.codecId){var b=S(m,v.codecId);o.codecName=b?b.mimeType&&b.mimeType.match(/(.*\/)?(.*)/)[2]:v.codecId}break;case"transport":s=v.id}}}),o.timestamp||(o.timestamp=i);var n=S(m,s);if(!n)return o;var t=S(m,n.selectedCandidatePairId);if(!t)return o;var a=S(m,t.localCandidateId),r=S(m,t.remoteCandidateId);return o.rtt||(o.rtt=t&&1e3*t.currentRoundTripTime),Object.assign(o,{localAddress:a&&(a.address||a.ip),remoteAddress:r&&(r.address||r.ip)}),o}h.getRTCStats=function g(m,s){return s=Object.assign({createRTCSample:c},s),C(m).then(s.createRTCSample)},h.getRTCIceCandidateStatsReport=function T(m){return C(m).then(function(s){var v,o=Array.from(s.values()).reduce(function(l,y){switch(["candidatePairs","localCandidates","remoteCandidates"].forEach(function(b){l[b]||(l[b]=[])}),y.type){case"candidate-pair":l.candidatePairs.push(y);break;case"local-candidate":l.localCandidates.push(y);break;case"remote-candidate":l.remoteCandidates.push(y);break;case"transport":y.selectedCandidatePairId&&(l.transport=y)}return l},{}),n=o.localCandidates,t=o.remoteCandidates,a=o.transport,r=o.candidatePairs.find(function(l){return l.selected||a&&l.id===a.selectedCandidatePairId});return r&&(v={localCandidate:n.find(function(l){return l.id===r.localCandidateId}),remoteCandidate:t.find(function(l){return l.id===r.remoteCandidateId})}),{iceCandidateStats:f(n,t),selectedIceCandidatePairStats:v}})}},7556:(N,h,p)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var f=p(2016);function e(){Object.defineProperties(this,{_eventEmitter:{value:new f.EventEmitter},_handlers:{value:{}}})}e.prototype.dispatchEvent=function(_){return this._eventEmitter.emit(_.type,_)},e.prototype.addEventListener=function(){var _;return(_=this._eventEmitter).addListener.apply(_,arguments)},e.prototype.removeEventListener=function(){var _;return(_=this._eventEmitter).removeListener.apply(_,arguments)},e.prototype._defineEventHandler=function(_){var A=this;Object.defineProperty(this,"on"+_,{get:function(){return A._handlers[_]},set:function(S){var C=A._handlers[_];C&&("function"==typeof S||typeof S>"u"||null===S)&&(A._handlers[_]=null,A.removeEventListener(_,C)),"function"==typeof S&&(A._handlers[_]=S,A.addEventListener(_,S))}})},h.default=e},4199:(N,h)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.default=function f(e){Object.defineProperties(this,{deviceId:{get:function(){return e.deviceId}},groupId:{get:function(){return e.groupId}},kind:{get:function(){return e.kind}},label:{get:function(){return e.label}}})}},6292:function(N,h,p){"use strict";var o,f=this&&this.__extends||(o=function(i,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,a){t.__proto__=a}||function(t,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])})(i,n)},function(i,n){function t(){this.constructor=i}o(i,n),i.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0});var e=p(7556),_=null,A=function(o){function i(){var n=o.call(this)||this;n._defineEventHandler("devicechange"),n._defineEventHandler("deviceinfochange");var t=[];return Object.defineProperties(n,{_deviceChangeIsNative:{value:c(n,"devicechange")},_deviceInfoChangeIsNative:{value:c(n,"deviceinfochange")},_knownDevices:{value:t},_pollInterval:{value:null,writable:!0}}),"function"==typeof _.enumerateDevices&&_.enumerateDevices().then(function(a){a.sort(m).forEach(function(r){return t.push(r)})}),n._eventEmitter.on("newListener",function(r){"devicechange"!==r&&"deviceinfochange"!==r||(this._pollInterval=this._pollInterval||setInterval(T.bind(null,this),500))}.bind(n)),n._eventEmitter.on("removeListener",function(){this._pollInterval&&!function g(o){return["devicechange","deviceinfochange"].reduce(function(i,n){return i+o._eventEmitter.listenerCount(n)},0)>0}(this)&&(clearInterval(this._pollInterval),this._pollInterval=null)}.bind(n)),n}return f(i,o),i}(e.default);function T(o){_.enumerateDevices().then(function(i){var n=o._knownDevices,t=n.slice();[].splice.apply(n,[0,n.length].concat(i.sort(m))),!o._deviceChangeIsNative&&function C(o,i){return o.length!==i.length||function u(o,i,n){return i.some(function(t,a){return t[o]!==n[a][o]})}("deviceId",o,i)}(n,t)&&o.dispatchEvent(new Event("devicechange")),!o._deviceInfoChangeIsNative&&function S(o,i){if(o=o.filter(function(t){return"audioinput"===t.kind||"audiooutput"===t.kind}),(i=i.filter(function(t){return"audioinput"===t.kind||"audiooutput"===t.kind})).some(function(t){return!t.deviceId})&&o.some(function(t){return!!t.deviceId}))return!0;var n=i.reduce(function(t,a){return t.set(a.deviceId+"-"+a.kind,a.label)},new Map);return o.some(function(t){var a=n.get(t.deviceId+"-"+t.kind);return typeof a<"u"&&a!==t.label})}(n,t)&&o.dispatchEvent(new Event("deviceinfochange"))})}function c(o,i){var n="on"+i;function t(a){o.dispatchEvent(a)}return n in _&&("addEventListener"in _?_.addEventListener(i,t):_[n]=t,!0)}function m(o,i){return o.deviceId<i.deviceId}A.prototype.enumerateDevices=function(){return _&&"function"==typeof _.enumerateDevices?_.enumerateDevices.apply(_,arguments):null},A.prototype.getUserMedia=function(){return _.getUserMedia.apply(_,arguments)},h.default=function(){return(_=typeof navigator<"u"?navigator.mediaDevices:null)?new A:null}},8068:(N,h,p)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var f=p(1976),e=p(5358),E=p(1287);function _(S,C,g){if(!(this instanceof _))return new _(S,C,g);if(!S||!C)throw new E.InvalidArgumentError("name and url are required arguments");(g=Object.assign({AudioFactory:typeof Audio<"u"?Audio:null,maxDuration:0,shouldLoop:!1},g)).AudioPlayer=g.audioContext?e.default.bind(e.default,g.audioContext):g.AudioFactory,Object.defineProperties(this,{_Audio:{value:g.AudioPlayer},_activeEls:{value:new Map},_isSinkSupported:{value:null!==g.AudioFactory&&"function"==typeof g.AudioFactory.prototype.setSinkId},_maxDuration:{value:g.maxDuration},_maxDurationTimeout:{value:null,writable:!0},_operations:{value:new f.AsyncQueue},_playPromise:{value:null,writable:!0},_shouldLoop:{value:g.shouldLoop},_sinkIds:{value:["default"]},isPlaying:{enumerable:!0,get:function(){return!!this._playPromise}},name:{enumerable:!0,value:S},url:{enumerable:!0,value:C}}),this._Audio&&this._play(!0,!1)}function A(S){S&&(S.pause(),S.src="",S.srcObject=null,S.load())}_.prototype._playAudioElement=function(C,g,T){var u=this,c=this._activeEls.get(C);if(!c)throw new E.InvalidArgumentError('sinkId: "'+C+"\" doesn't have an audio element");return c.muted=!!g,c.loop=!!T,c.play().then(function(){return c}).catch(function(m){throw A(c),u._activeEls.delete(C),m})},_.prototype._play=function(C,g){this.isPlaying&&this._stop(),this._maxDuration>0&&(this._maxDurationTimeout=setTimeout(this._stop.bind(this),this._maxDuration)),g="boolean"==typeof g?g:this._shouldLoop;var T=this;return this._playPromise=Promise.all(this._sinkIds.map(function(m){if(!T._Audio)return Promise.resolve();var s=T._activeEls.get(m);return s?T._playAudioElement(m,C,g):("function"==typeof(s=new T._Audio(T.url)).setAttribute&&s.setAttribute("crossorigin","anonymous"),new Promise(function(o){s.addEventListener("canplaythrough",o)}).then(function(){return(T._isSinkSupported?s.setSinkId(m):Promise.resolve()).then(function(){return T._activeEls.set(m,s),T._playPromise?T._playAudioElement(m,C,g):Promise.resolve()})}))}))},_.prototype._stop=function(){var C=this;this._activeEls.forEach(function(g,T){C._sinkIds.includes(T)?(g.pause(),g.currentTime=0):(A(g),C._activeEls.delete(T))}),clearTimeout(this._maxDurationTimeout),this._playPromise=null,this._maxDurationTimeout=null},_.prototype.setSinkIds=function(C){this._isSinkSupported&&[].splice.apply(this._sinkIds,[0,this._sinkIds.length].concat(C=C.forEach?C:[C]))},_.prototype.stop=function(){var C=this;this._operations.enqueue(function(){return C._stop(),Promise.resolve()})},_.prototype.play=function(){var C=this;return this._operations.enqueue(function(){return C._play()})},h.default=_},8753:function(N,h,p){"use strict";var v,f=this&&this.__extends||(v=function(l,y){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,O){b.__proto__=O}||function(b,O){for(var x in O)Object.prototype.hasOwnProperty.call(O,x)&&(b[x]=O[x])})(l,y)},function(l,y){function b(){this.constructor=l}v(l,y),l.prototype=null===y?Object.create(y):(b.prototype=y.prototype,new b)}),e=this&&this.__assign||function(){return e=Object.assign||function(v){for(var l,y=1,b=arguments.length;y<b;y++)for(var O in l=arguments[y])Object.prototype.hasOwnProperty.call(l,O)&&(v[O]=l[O]);return v},e.apply(this,arguments)},E=this&&this.__spreadArrays||function(){for(var v=0,l=0,y=arguments.length;l<y;l++)v+=arguments[l].length;var b=Array(v),O=0;for(l=0;l<y;l++)for(var x=arguments[l],Z=0,L=x.length;Z<L;Z++,O++)b[O]=x[Z];return b};Object.defineProperty(h,"__esModule",{value:!0});var _=p(2016),A=p(1287),S=p(4938),C=p(5610),g=p(9819),o={audioInputLevel:{minStandardDeviation:327.67,sampleCount:10},audioOutputLevel:{minStandardDeviation:327.67,sampleCount:10},bytesReceived:{clearCount:2,min:1,raiseCount:3,sampleCount:3},bytesSent:{clearCount:2,min:1,raiseCount:3,sampleCount:3},jitter:{max:30},mos:{min:3},packetsLostFraction:[{max:1},{clearValue:1,maxAverage:3,sampleCount:7}],rtt:{max:400}},r=function(v){function l(y){var b=v.call(this)||this;b._activeWarnings=new Map,b._currentStreaks=new Map,b._inputVolumes=[],b._outputVolumes=[],b._sampleBuffer=[],b._supplementalSampleBuffers={audioInputLevel:[],audioOutputLevel:[]},b._warningsEnabled=!0,b._getRTCStats=(y=y||{}).getRTCStats||C.getRTCStats,b._mos=y.Mos||S.default,b._peerConnection=y.peerConnection,b._thresholds=e(e({},o),y.thresholds);var O=Object.values(b._thresholds).map(function(x){return x.sampleCount}).filter(function(x){return!!x});return b._maxSampleCount=Math.max.apply(Math,E([5],O)),b._peerConnection&&b.enable(b._peerConnection),b}return f(l,v),l.prototype.addVolumes=function(y,b){this._inputVolumes.push(y),this._outputVolumes.push(b)},l.prototype.disable=function(){return this._sampleInterval&&(clearInterval(this._sampleInterval),delete this._sampleInterval),this},l.prototype.disableWarnings=function(){return this._warningsEnabled&&this._activeWarnings.clear(),this._warningsEnabled=!1,this},l.prototype.enable=function(y){if(y){if(this._peerConnection&&y!==this._peerConnection)throw new A.InvalidArgumentError("Attempted to replace an existing PeerConnection in StatsMonitor.enable");this._peerConnection=y}if(!this._peerConnection)throw new A.InvalidArgumentError("Can not enable StatsMonitor without a PeerConnection");return this._sampleInterval=this._sampleInterval||setInterval(this._fetchSample.bind(this),1e3),this},l.prototype.enableWarnings=function(){return this._warningsEnabled=!0,this},l.prototype.hasActiveWarning=function(y,b){return!!this._activeWarnings.get(y+":"+b)},l.prototype._addSample=function(y){var b=this._sampleBuffer;b.push(y),b.length>this._maxSampleCount&&b.splice(0,b.length-this._maxSampleCount)},l.prototype._clearWarning=function(y,b,O){var x=y+":"+b,Z=this._activeWarnings.get(x);!Z||Date.now()-Z.timeRaised<5e3||(this._activeWarnings.delete(x),this.emit("warning-cleared",e(e({},O),{name:y,threshold:{name:b,value:this._thresholds[y][b]}})))},l.prototype._createSample=function(y,b){var P=y.bytesSent-(b&&b.totals.bytesSent||0),R=y.bytesReceived-(b&&b.totals.bytesReceived||0),d=y.packetsSent-(b&&b.totals.packetsSent||0),I=y.packetsReceived-(b&&b.totals.packetsReceived||0),U=y.packetsLost-(b&&b.totals.packetsLost||0),F=I+U,k=F>0?U/F*100:0,D=y.packetsReceived+y.packetsLost,M=D>0?y.packetsLost/D*100:100,j="number"!=typeof y.rtt&&b?b.rtt:y.rtt,H=this._inputVolumes.splice(0);this._supplementalSampleBuffers.audioInputLevel.push(H);var B=this._outputVolumes.splice(0);return this._supplementalSampleBuffers.audioOutputLevel.push(B),{audioInputLevel:Math.round(g.average(H)),audioOutputLevel:Math.round(g.average(B)),bytesReceived:R,bytesSent:P,codecName:y.codecName,jitter:y.jitter,mos:this._mos.calculate(j,y.jitter,b&&k),packetsLost:U,packetsLostFraction:k,packetsReceived:I,packetsSent:d,rtt:j,timestamp:y.timestamp,totals:{bytesReceived:y.bytesReceived,bytesSent:y.bytesSent,packetsLost:y.packetsLost,packetsLostFraction:M,packetsReceived:y.packetsReceived,packetsSent:y.packetsSent}}},l.prototype._fetchSample=function(){var y=this;this._getSample().then(function(b){y._addSample(b),y._raiseWarnings(),y.emit("sample",b)}).catch(function(b){y.disable(),y.emit("error",b)})},l.prototype._getSample=function(){var y=this;return this._getRTCStats(this._peerConnection).then(function(b){var O=null;return y._sampleBuffer.length&&(O=y._sampleBuffer[y._sampleBuffer.length-1]),y._createSample(b,O)})},l.prototype._raiseWarning=function(y,b,O){var x=y+":"+b;if(!this._activeWarnings.has(x)){this._activeWarnings.set(x,{timeRaised:Date.now()});var L,Z=this._thresholds[y];if(Array.isArray(Z)){var w=Z.find(function(P){return b in P});w&&(L=w[b])}else L=this._thresholds[y][b];this.emit("warning",e(e({},O),{name:y,threshold:{name:b,value:L}}))}},l.prototype._raiseWarnings=function(){var y=this;this._warningsEnabled&&Object.keys(this._thresholds).forEach(function(b){return y._raiseWarningsForStat(b)})},l.prototype._raiseWarningsForStat=function(y){var b=this;(Array.isArray(this._thresholds[y])?this._thresholds[y]:[this._thresholds[y]]).forEach(function(x){var Z=b._sampleBuffer,L=x.clearCount||0,w=x.raiseCount||3,P=x.sampleCount||b._maxSampleCount,R=Z.slice(-P),d=R.map(function(q){return q[y]});if(!d.some(function(q){return typeof q>"u"||null===q})){var U;if("number"==typeof x.max&&(U=function i(v,l){return l.reduce(function(y,b){return y+(b>v?1:0)},0)}(x.max,d),U>=w?b._raiseWarning(y,"max",{values:d,samples:R}):U<=L&&b._clearWarning(y,"max",{values:d,samples:R})),"number"==typeof x.min&&(U=function n(v,l){return l.reduce(function(y,b){return y+(b<v?1:0)},0)}(x.min,d),U>=w?b._raiseWarning(y,"min",{values:d,samples:R}):U<=L&&b._clearWarning(y,"min",{values:d,samples:R})),"number"==typeof x.maxDuration&&Z.length>1){var F=(R=Z.slice(-2))[0][y],k=R[1][y],D=b._currentStreaks.get(y)||0,M=F===k?D+1:0;b._currentStreaks.set(y,M),M>=x.maxDuration?b._raiseWarning(y,"maxDuration",{value:M}):0===M&&b._clearWarning(y,"maxDuration",{value:D})}if("number"==typeof x.minStandardDeviation){var j=b._supplementalSampleBuffers[y];if(!j||j.length<x.sampleCount)return;j.length>x.sampleCount&&j.splice(0,j.length-x.sampleCount);var H=function a(v){return v.reduce(function(l,y){return E(l,y)},[])}(j.slice(-P)),B=function t(v){if(v.length<=0)return null;var l=v.reduce(function(O,x){return O+x},0)/v.length,y=v.map(function(O){return Math.pow(O-l,2)});return Math.sqrt(y.reduce(function(O,x){return O+x},0)/y.length)}(H);if("number"!=typeof B)return;B<x.minStandardDeviation?b._raiseWarning(y,"minStandardDeviation",{value:B}):b._clearWarning(y,"minStandardDeviation",{value:B})}[["maxAverage",function(q,G){return q>G}],["minAverage",function(q,G){return q<G}]].forEach(function(q){var G=q[0],V=q[1];if("number"==typeof x[G]&&d.length>=P){var W=g.average(d);V(W,x[G])?b._raiseWarning(y,G,{values:d,samples:R}):V(W,x.clearValue||x[G])||b._clearWarning(y,G,{values:d,samples:R})}})}})},l}(_.EventEmitter);h.default=r},9819:(N,h)=>{"use strict";function p(m){if(!(this instanceof p))return new p(m);this.message=m}function E(m){return!!m.userAgent.match("Electron")}function _(m,s){var o=!!s.userAgent.match("CriOS"),i=!!s.userAgent.match("HeadlessChrome"),n=typeof m.chrome<"u"&&"Google Inc."===s.vendor&&-1===s.userAgent.indexOf("OPR")&&-1===s.userAgent.indexOf("Edge");return o||E(s)||n||i}function A(m){return!!(m=m||(typeof window>"u"?global.navigator:window.navigator))&&"string"==typeof m.userAgent&&/firefox|fxios/i.test(m.userAgent)}function C(m){return!!m.vendor&&-1!==m.vendor.indexOf("Apple")&&m.userAgent&&-1===m.userAgent.indexOf("CriOS")&&-1===m.userAgent.indexOf("FxiOS")}Object.defineProperty(h,"__esModule",{value:!0}),h.flatMap=h.queryToJson=h.isUnifiedPlanDefault=h.isSafari=h.isLegacyEdge=h.isFirefox=h.isChrome=h.isElectron=h.difference=h.average=h.Exception=void 0,p.prototype.toString=function(){return"Twilio.Exception: "+this.message},h.average=function f(m){return m&&m.length?m.reduce(function(s,o){return s+o})/m.length:0},h.difference=function e(m,s,o){o=o||function(n){return n};var i=new Set(s.map(o));return m.filter(function(n){return!i.has(o(n))})},h.isElectron=E,h.isChrome=_,h.isFirefox=A,h.isLegacyEdge=function S(m){return!!(m=m||(typeof window>"u"?global.navigator:window.navigator))&&"string"==typeof m.userAgent&&/edge\/\d+/i.test(m.userAgent)},h.isSafari=C,h.isUnifiedPlanDefault=function g(m,s,o,i){if(typeof m>"u"||typeof s>"u"||typeof o>"u"||typeof i>"u"||typeof o.prototype>"u"||typeof i.prototype>"u")return!1;if(_(m,s)&&o.prototype.addTransceiver){var n=new o,t=!0;try{n.addTransceiver("audio")}catch{t=!1}return n.close(),t}return!!A(s)||!!C(s)&&"currentDirection"in i.prototype},h.queryToJson=function T(m){return m?m.split("&").reduce(function(s,o){var i=o.split("="),n=i[0],t=decodeURIComponent((i[1]||"").replace(/\+/g,"%20"));return n&&(s[n]=t),s},{}):""},h.flatMap=function u(m,s){var o=m instanceof Map||m instanceof Set?Array.from(m.values()):m;return s=s||function(i){return i},o.reduce(function(i,n){var t=s(n);return i.concat(t)},[])},h.Exception=p},8941:(N,h,p)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.generateVoiceEventSid=void 0;var f=p(9095),e=p(1287);h.generateVoiceEventSid=function _(){return"KX"+function E(){if("object"!=typeof window)throw new e.NotSupportedError("This platform is not supported.");var A=window.crypto;if("object"!=typeof A)throw new e.NotSupportedError("The `crypto` module is not available on this platform.");if(typeof(A.randomUUID||A.getRandomValues)>"u")throw new e.NotSupportedError("Neither `crypto.randomUUID` or `crypto.getRandomValues` are available on this platform.");if(typeof window.Uint32Array>"u")throw new e.NotSupportedError("The `Uint32Array` module is not available on this platform.");return f(("function"==typeof A.randomUUID?function(){return A.randomUUID()}:function(){return A.getRandomValues(new Uint32Array(32)).toString()})())}()}},483:function(N,h,p){"use strict";var t,f=this&&this.__extends||(t=function(a,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,l){v.__proto__=l}||function(v,l){for(var y in l)Object.prototype.hasOwnProperty.call(l,y)&&(v[y]=l[y])})(a,r)},function(a,r){function v(){this.constructor=a}t(a,r),a.prototype=null===r?Object.create(r):(v.prototype=r.prototype,new v)}),e=this&&this.__assign||function(){return e=Object.assign||function(t){for(var a,r=1,v=arguments.length;r<v;r++)for(var l in a=arguments[r])Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l]);return t},e.apply(this,arguments)};Object.defineProperty(h,"__esModule",{value:!0}),h.WSTransportState=void 0;var i,E=p(2016),_=p(8039),A=p(1287),S=p(990),C=globalThis.WebSocket;!function(t){t.Connecting="connecting",t.Closed="closed",t.Open="open"}(i=h.WSTransportState||(h.WSTransportState={}));var n=function(t){function a(r,v){void 0===v&&(v={});var l=t.call(this)||this;return l.state=i.Closed,l._backoffStartTime={preferred:null,primary:null},l._connectedUri=null,l._log=S.default.getInstance(),l._shouldFallback=!1,l._uriIndex=0,l._moveUriIndex=function(){l._uriIndex++,l._uriIndex>=l._uris.length&&(l._uriIndex=0)},l._onSocketClose=function(y){l._log.info("Received websocket close event code: "+y.code+". Reason: "+y.reason),(1006===y.code||1015===y.code)&&(l.emit("error",{code:31005,message:y.reason||"Websocket connection to Twilio's signaling servers were unexpectedly ended. If this is happening consistently, there may be an issue resolving the hostname provided. If a region or an edge is being specified in Device setup, ensure it is valid.",twilioError:new A.SignalingErrors.ConnectionError}),(l._shouldFallback||!(l.state===i.Open||l._previousState===i.Open))&&l._moveUriIndex(),l._shouldFallback=!0),l._closeSocket()},l._onSocketError=function(y){l._log.info("WebSocket received error: "+y.message),l.emit("error",{code:31e3,message:y.message||"WSTransport socket error",twilioError:new A.SignalingErrors.ConnectionDisconnected})},l._onSocketMessage=function(y){l._setHeartbeatTimeout(),l._socket&&"\n"===y.data?l._socket.send("\n"):l.emit("message",y)},l._onSocketOpen=function(){l._log.info("WebSocket opened successfully."),l._timeOpened=Date.now(),l._shouldFallback=!1,l._setState(i.Open),clearTimeout(l._connectTimeout),l._resetBackoffs(),l._setHeartbeatTimeout(),l.emit("open")},l._options=e(e({},a.defaultConstructorOptions),v),l._uris=r,l._backoff=l._setupBackoffs(),l}return f(a,t),a.prototype.close=function(){this._log.info("WSTransport.close() called..."),this._close()},a.prototype.open=function(){this._log.info("WSTransport.open() called..."),!this._socket||this._socket.readyState!==C.CONNECTING&&this._socket.readyState!==C.OPEN?this._connect(this._preferredUri?this._preferredUri:this._uris[this._uriIndex]):this._log.info("WebSocket already open.")},a.prototype.send=function(r){if(!this._socket||this._socket.readyState!==C.OPEN)return!1;try{this._socket.send(r)}catch(v){return this._log.info("Error while sending message:",v.message),this._closeSocket(),!1}return!0},a.prototype.updatePreferredURI=function(r){this._preferredUri=r},a.prototype.updateURIs=function(r){"string"==typeof r&&(r=[r]),this._uris=r,this._uriIndex=0},a.prototype._close=function(){this._setState(i.Closed),this._closeSocket()},a.prototype._closeSocket=function(){clearTimeout(this._connectTimeout),clearTimeout(this._heartbeatTimeout),this._log.info("Closing and cleaning up WebSocket..."),this._socket?(this._socket.removeEventListener("close",this._onSocketClose),this._socket.removeEventListener("error",this._onSocketError),this._socket.removeEventListener("message",this._onSocketMessage),this._socket.removeEventListener("open",this._onSocketOpen),(this._socket.readyState===C.CONNECTING||this._socket.readyState===C.OPEN)&&this._socket.close(),this._timeOpened&&Date.now()-this._timeOpened>1e4&&this._resetBackoffs(),this.state!==i.Closed&&this._performBackoff(),delete this._socket,this.emit("close")):this._log.info("No WebSocket to clean up.")},a.prototype._connect=function(r,v){var l=this;this._log.info("number"==typeof v?"Attempting to reconnect (retry #"+v+")...":"Attempting to connect..."),this._closeSocket(),this._setState(i.Connecting),this._connectedUri=r;try{this._socket=new this._options.WebSocket(this._connectedUri)}catch(y){return this._log.info("Could not connect to endpoint:",y.message),this._close(),void this.emit("error",{code:31e3,message:y.message||"Could not connect to "+this._connectedUri,twilioError:new A.SignalingErrors.ConnectionDisconnected})}this._socket.addEventListener("close",this._onSocketClose),this._socket.addEventListener("error",this._onSocketError),this._socket.addEventListener("message",this._onSocketMessage),this._socket.addEventListener("open",this._onSocketOpen),delete this._timeOpened,this._connectTimeout=setTimeout(function(){l._log.info("WebSocket connection attempt timed out."),l._moveUriIndex(),l._closeSocket()},this._options.connectTimeoutMs)},a.prototype._performBackoff=function(){this._preferredUri?(this._log.info("Preferred URI set; backing off."),this._backoff.preferred.backoff()):(this._log.info("Preferred URI not set; backing off."),this._backoff.primary.backoff())},a.prototype._resetBackoffs=function(){this._backoff.preferred.reset(),this._backoff.primary.reset(),this._backoffStartTime.preferred=null,this._backoffStartTime.primary=null},a.prototype._setHeartbeatTimeout=function(){var r=this;clearTimeout(this._heartbeatTimeout),this._heartbeatTimeout=setTimeout(function(){r._log.info("No messages received in 15 seconds. Reconnecting..."),r._shouldFallback=!0,r._closeSocket()},15e3)},a.prototype._setState=function(r){this._previousState=this.state,this.state=r},a.prototype._setupBackoffs=function(){var r=this,v={factor:2,jitter:.4,max:this._options.maxPreferredDelayMs,min:100};this._log.info("Initializing preferred transport backoff using config: ",v);var l=new _.default(v);l.on("backoff",function(O,x){r.state!==i.Closed?(r._log.info("Will attempt to reconnect Websocket to preferred URI in "+x+"ms"),0===O&&(r._backoffStartTime.preferred=Date.now(),r._log.info("Preferred backoff start; "+r._backoffStartTime.preferred))):r._log.info("Preferred backoff initiated but transport state is closed; not attempting a connection.")}),l.on("ready",function(O,x){if(r.state!==i.Closed){if(null!==r._backoffStartTime.preferred)return Date.now()-r._backoffStartTime.preferred>r._options.maxPreferredDurationMs?(r._log.info("Max preferred backoff attempt time exceeded; falling back to primary backoff."),r._preferredUri=null,void r._backoff.primary.backoff()):"string"!=typeof r._preferredUri?(r._log.info("Preferred URI cleared; falling back to primary backoff."),r._preferredUri=null,void r._backoff.primary.backoff()):void r._connect(r._preferredUri,O+1);r._log.info("Preferred backoff start time invalid; not attempting a connection.")}else r._log.info("Preferred backoff ready but transport state is closed; not attempting a connection.")});var y={factor:2,jitter:.4,max:this._options.maxPrimaryDelayMs,min:this._uris&&this._uris.length>1?Math.floor(4001*Math.random())+1e3:100};this._log.info("Initializing primary transport backoff using config: ",y);var b=new _.default(y);return b.on("backoff",function(O,x){r.state!==i.Closed?(r._log.info("Will attempt to reconnect WebSocket in "+x+"ms"),0===O&&(r._backoffStartTime.primary=Date.now(),r._log.info("Primary backoff start; "+r._backoffStartTime.primary))):r._log.info("Primary backoff initiated but transport state is closed; not attempting a connection.")}),b.on("ready",function(O,x){r.state!==i.Closed?null!==r._backoffStartTime.primary?Date.now()-r._backoffStartTime.primary>r._options.maxPrimaryDurationMs?r._log.info("Max primary backoff attempt time exceeded; not attempting a connection."):r._connect(r._uris[r._uriIndex],O+1):r._log.info("Primary backoff start time invalid; not attempting a connection."):r._log.info("Primary backoff ready but transport state is closed; not attempting a connection.")}),{preferred:l,primary:b}},Object.defineProperty(a.prototype,"uri",{get:function(){return this._connectedUri},enumerable:!1,configurable:!0}),a.defaultConstructorOptions={WebSocket:C,connectTimeoutMs:5e3,maxPreferredDelayMs:1e3,maxPreferredDurationMs:15e3,maxPrimaryDelayMs:2e4,maxPrimaryDurationMs:1/0},a}(E.EventEmitter);h.default=n},8870:N=>{var h={utf8:{stringToBytes:function(p){return h.bin.stringToBytes(unescape(encodeURIComponent(p)))},bytesToString:function(p){return decodeURIComponent(escape(h.bin.bytesToString(p)))}},bin:{stringToBytes:function(p){for(var f=[],e=0;e<p.length;e++)f.push(255&p.charCodeAt(e));return f},bytesToString:function(p){for(var f=[],e=0;e<p.length;e++)f.push(String.fromCharCode(p[e]));return f.join("")}}};N.exports=h},6962:N=>{var h,p;h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",N.exports=p={rotl:function(f,e){return f<<e|f>>>32-e},rotr:function(f,e){return f<<32-e|f>>>e},endian:function(f){if(f.constructor==Number)return 16711935&p.rotl(f,8)|4278255360&p.rotl(f,24);for(var e=0;e<f.length;e++)f[e]=p.endian(f[e]);return f},randomBytes:function(f){for(var e=[];f>0;f--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(f){for(var e=[],E=0,_=0;E<f.length;E++,_+=8)e[_>>>5]|=f[E]<<24-_%32;return e},wordsToBytes:function(f){for(var e=[],E=0;E<32*f.length;E+=8)e.push(f[E>>>5]>>>24-E%32&255);return e},bytesToHex:function(f){for(var e=[],E=0;E<f.length;E++)e.push((f[E]>>>4).toString(16)),e.push((15&f[E]).toString(16));return e.join("")},hexToBytes:function(f){for(var e=[],E=0;E<f.length;E+=2)e.push(parseInt(f.substr(E,2),16));return e},bytesToBase64:function(f){for(var e=[],E=0;E<f.length;E+=3)for(var _=f[E]<<16|f[E+1]<<8|f[E+2],A=0;A<4;A++)e.push(8*E+6*A<=8*f.length?h.charAt(_>>>6*(3-A)&63):"=");return e.join("")},base64ToBytes:function(f){f=f.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],E=0,_=0;E<f.length;_=++E%4)0!=_&&e.push((h.indexOf(f.charAt(E-1))&Math.pow(2,-2*_+8)-1)<<2*_|h.indexOf(f.charAt(E))>>>6-2*_);return e}}},2016:N=>{"use strict";var f,h="object"==typeof Reflect?Reflect:null,p=h&&"function"==typeof h.apply?h.apply:function(v,l,y){return Function.prototype.apply.call(v,l,y)};f=h&&"function"==typeof h.ownKeys?h.ownKeys:Object.getOwnPropertySymbols?function(v){return Object.getOwnPropertyNames(v).concat(Object.getOwnPropertySymbols(v))}:function(v){return Object.getOwnPropertyNames(v)};var E=Number.isNaN||function(v){return v!=v};function _(){_.init.call(this)}N.exports=_,N.exports.once=function n(r,v){return new Promise(function(l,y){function b(x){r.removeListener(v,O),y(x)}function O(){"function"==typeof r.removeListener&&r.removeListener("error",b),l([].slice.call(arguments))}a(r,v,O,{once:!0}),"error"!==v&&function t(r,v,l){"function"==typeof r.on&&a(r,"error",v,l)}(r,b,{once:!0})})},_.EventEmitter=_,_.prototype._events=void 0,_.prototype._eventsCount=0,_.prototype._maxListeners=void 0;var A=10;function S(r){if("function"!=typeof r)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}function C(r){return void 0===r._maxListeners?_.defaultMaxListeners:r._maxListeners}function g(r,v,l,y){var b,O,x;if(S(l),void 0===(O=r._events)?(O=r._events=Object.create(null),r._eventsCount=0):(void 0!==O.newListener&&(r.emit("newListener",v,l.listener?l.listener:l),O=r._events),x=O[v]),void 0===x)x=O[v]=l,++r._eventsCount;else if("function"==typeof x?x=O[v]=y?[l,x]:[x,l]:y?x.unshift(l):x.push(l),(b=C(r))>0&&x.length>b&&!x.warned){x.warned=!0;var Z=new Error("Possible EventEmitter memory leak detected. "+x.length+" "+String(v)+" listeners added. Use emitter.setMaxListeners() to increase limit");Z.name="MaxListenersExceededWarning",Z.emitter=r,Z.type=v,Z.count=x.length,function e(r){console&&console.warn&&console.warn(r)}(Z)}return r}function T(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(r,v,l){var y={fired:!1,wrapFn:void 0,target:r,type:v,listener:l},b=T.bind(y);return b.listener=l,y.wrapFn=b,b}function c(r,v,l){var y=r._events;if(void 0===y)return[];var b=y[v];return void 0===b?[]:"function"==typeof b?l?[b.listener||b]:[b]:l?function i(r){for(var v=new Array(r.length),l=0;l<v.length;++l)v[l]=r[l].listener||r[l];return v}(b):s(b,b.length)}function m(r){var v=this._events;if(void 0!==v){var l=v[r];if("function"==typeof l)return 1;if(void 0!==l)return l.length}return 0}function s(r,v){for(var l=new Array(v),y=0;y<v;++y)l[y]=r[y];return l}function a(r,v,l,y){if("function"==typeof r.on)y.once?r.once(v,l):r.on(v,l);else{if("function"!=typeof r.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r);r.addEventListener(v,function b(O){y.once&&r.removeEventListener(v,b),l(O)})}}Object.defineProperty(_,"defaultMaxListeners",{enumerable:!0,get:function(){return A},set:function(r){if("number"!=typeof r||r<0||E(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");A=r}}),_.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},_.prototype.setMaxListeners=function(v){if("number"!=typeof v||v<0||E(v))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+v+".");return this._maxListeners=v,this},_.prototype.getMaxListeners=function(){return C(this)},_.prototype.emit=function(v){for(var l=[],y=1;y<arguments.length;y++)l.push(arguments[y]);var b="error"===v,O=this._events;if(void 0!==O)b=b&&void 0===O.error;else if(!b)return!1;if(b){var x;if(l.length>0&&(x=l[0]),x instanceof Error)throw x;var Z=new Error("Unhandled error."+(x?" ("+x.message+")":""));throw Z.context=x,Z}var L=O[v];if(void 0===L)return!1;if("function"==typeof L)p(L,this,l);else{var w=L.length,P=s(L,w);for(y=0;y<w;++y)p(P[y],this,l)}return!0},_.prototype.on=_.prototype.addListener=function(v,l){return g(this,v,l,!1)},_.prototype.prependListener=function(v,l){return g(this,v,l,!0)},_.prototype.once=function(v,l){return S(l),this.on(v,u(this,v,l)),this},_.prototype.prependOnceListener=function(v,l){return S(l),this.prependListener(v,u(this,v,l)),this},_.prototype.off=_.prototype.removeListener=function(v,l){var y,b,O,x,Z;if(S(l),void 0===(b=this._events))return this;if(void 0===(y=b[v]))return this;if(y===l||y.listener===l)0==--this._eventsCount?this._events=Object.create(null):(delete b[v],b.removeListener&&this.emit("removeListener",v,y.listener||l));else if("function"!=typeof y){for(O=-1,x=y.length-1;x>=0;x--)if(y[x]===l||y[x].listener===l){Z=y[x].listener,O=x;break}if(O<0)return this;0===O?y.shift():function o(r,v){for(;v+1<r.length;v++)r[v]=r[v+1];r.pop()}(y,O),1===y.length&&(b[v]=y[0]),void 0!==b.removeListener&&this.emit("removeListener",v,Z||l)}return this},_.prototype.removeAllListeners=function(v){var l,y,b;if(void 0===(y=this._events))return this;if(void 0===y.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==y[v]&&(0==--this._eventsCount?this._events=Object.create(null):delete y[v]),this;if(0===arguments.length){var x,O=Object.keys(y);for(b=0;b<O.length;++b)"removeListener"!==(x=O[b])&&this.removeAllListeners(x);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(l=y[v]))this.removeListener(v,l);else if(void 0!==l)for(b=l.length-1;b>=0;b--)this.removeListener(v,l[b]);return this},_.prototype.listeners=function(v){return c(this,v,!0)},_.prototype.rawListeners=function(v){return c(this,v,!1)},_.listenerCount=function(r,v){return"function"==typeof r.listenerCount?r.listenerCount(v):m.call(r,v)},_.prototype.listenerCount=m,_.prototype.eventNames=function(){return this._eventsCount>0?f(this._events):[]}},3678:N=>{function h(f){return!!f.constructor&&"function"==typeof f.constructor.isBuffer&&f.constructor.isBuffer(f)}N.exports=function(f){return null!=f&&(h(f)||function p(f){return"function"==typeof f.readFloatLE&&"function"==typeof f.slice&&h(f.slice(0,0))}(f)||!!f._isBuffer)}},4182:function(N,h,p){var f,e;!function(E,_){"use strict";f=function(){var E=function(){},_="undefined",A=typeof window!==_&&typeof window.navigator!==_&&/Trident\/|MSIE /.test(window.navigator.userAgent),S=["trace","debug","info","warn","error"];function C(t,a){var r=t[a];if("function"==typeof r.bind)return r.bind(t);try{return Function.prototype.bind.call(r,t)}catch{return function(){return Function.prototype.apply.apply(r,[t,arguments])}}}function g(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function u(t,a){for(var r=0;r<S.length;r++){var v=S[r];this[v]=r<t?E:this.methodFactory(v,t,a)}this.log=this.debug}function c(t,a,r){return function(){typeof console!==_&&(u.call(this,a,r),this[t].apply(this,arguments))}}function m(t,a,r){return function T(t){return"debug"===t&&(t="log"),typeof console!==_&&("trace"===t&&A?g:void 0!==console[t]?C(console,t):void 0!==console.log?C(console,"log"):E)}(t)||c.apply(this,arguments)}function s(t,a,r){var l,v=this,y="loglevel";function O(){var Z;if(typeof window!==_){try{Z=window.localStorage[y]}catch{}if(typeof Z===_)try{var L=window.document.cookie,w=L.indexOf(encodeURIComponent(y)+"=");-1!==w&&(Z=/^([^;]+)/.exec(L.slice(w))[1])}catch{}return void 0===v.levels[Z]&&(Z=void 0),Z}}t&&(y+=":"+t),v.name=t,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=r||m,v.getLevel=function(){return l},v.setLevel=function(Z,L){if("string"==typeof Z&&void 0!==v.levels[Z.toUpperCase()]&&(Z=v.levels[Z.toUpperCase()]),!("number"==typeof Z&&Z>=0&&Z<=v.levels.SILENT))throw"log.setLevel() called with invalid level: "+Z;if(l=Z,!1!==L&&function b(Z){var L=(S[Z]||"silent").toUpperCase();if(typeof window!==_){try{return void(window.localStorage[y]=L)}catch{}try{window.document.cookie=encodeURIComponent(y)+"="+L+";"}catch{}}}(Z),u.call(v,Z,t),typeof console===_&&Z<v.levels.SILENT)return"No console available for logging"},v.setDefaultLevel=function(Z){O()||v.setLevel(Z,!1)},v.enableAll=function(Z){v.setLevel(v.levels.TRACE,Z)},v.disableAll=function(Z){v.setLevel(v.levels.SILENT,Z)};var x=O();null==x&&(x=a??"WARN"),v.setLevel(x,!1)}var o=new s,i={};o.getLogger=function(a){if("string"!=typeof a||""===a)throw new TypeError("You must supply a name when creating a logger.");var r=i[a];return r||(r=i[a]=new s(a,o.getLevel(),o.methodFactory)),r};var n=typeof window!==_?window.log:void 0;return o.noConflict=function(){return typeof window!==_&&window.log===o&&(window.log=n),o},o.getLoggers=function(){return i},o},void 0!==(e=f.call(h,p,h,N))&&(N.exports=e)}()},9095:(N,h,p)=>{var f,e,E,_,A;f=p(6962),e=p(8870).utf8,E=p(3678),_=p(8870).bin,(A=function(S,C){S.constructor==String?S=C&&"binary"===C.encoding?_.stringToBytes(S):e.stringToBytes(S):E(S)?S=Array.prototype.slice.call(S,0):!Array.isArray(S)&&S.constructor!==Uint8Array&&(S=S.toString());for(var g=f.bytesToWords(S),T=8*S.length,u=1732584193,c=-271733879,m=-1732584194,s=271733878,o=0;o<g.length;o++)g[o]=16711935&(g[o]<<8|g[o]>>>24)|4278255360&(g[o]<<24|g[o]>>>8);g[T>>>5]|=128<<T%32,g[14+(T+64>>>9<<4)]=T;var i=A._ff,n=A._gg,t=A._hh,a=A._ii;for(o=0;o<g.length;o+=16){var r=u,v=c,l=m,y=s;u=i(u,c,m,s,g[o+0],7,-680876936),s=i(s,u,c,m,g[o+1],12,-389564586),m=i(m,s,u,c,g[o+2],17,606105819),c=i(c,m,s,u,g[o+3],22,-1044525330),u=i(u,c,m,s,g[o+4],7,-176418897),s=i(s,u,c,m,g[o+5],12,1200080426),m=i(m,s,u,c,g[o+6],17,-1473231341),c=i(c,m,s,u,g[o+7],22,-45705983),u=i(u,c,m,s,g[o+8],7,1770035416),s=i(s,u,c,m,g[o+9],12,-1958414417),m=i(m,s,u,c,g[o+10],17,-42063),c=i(c,m,s,u,g[o+11],22,-1990404162),u=i(u,c,m,s,g[o+12],7,1804603682),s=i(s,u,c,m,g[o+13],12,-40341101),m=i(m,s,u,c,g[o+14],17,-1502002290),u=n(u,c=i(c,m,s,u,g[o+15],22,1236535329),m,s,g[o+1],5,-165796510),s=n(s,u,c,m,g[o+6],9,-1069501632),m=n(m,s,u,c,g[o+11],14,643717713),c=n(c,m,s,u,g[o+0],20,-373897302),u=n(u,c,m,s,g[o+5],5,-701558691),s=n(s,u,c,m,g[o+10],9,38016083),m=n(m,s,u,c,g[o+15],14,-660478335),c=n(c,m,s,u,g[o+4],20,-405537848),u=n(u,c,m,s,g[o+9],5,568446438),s=n(s,u,c,m,g[o+14],9,-1019803690),m=n(m,s,u,c,g[o+3],14,-187363961),c=n(c,m,s,u,g[o+8],20,1163531501),u=n(u,c,m,s,g[o+13],5,-1444681467),s=n(s,u,c,m,g[o+2],9,-51403784),m=n(m,s,u,c,g[o+7],14,1735328473),u=t(u,c=n(c,m,s,u,g[o+12],20,-1926607734),m,s,g[o+5],4,-378558),s=t(s,u,c,m,g[o+8],11,-2022574463),m=t(m,s,u,c,g[o+11],16,1839030562),c=t(c,m,s,u,g[o+14],23,-35309556),u=t(u,c,m,s,g[o+1],4,-1530992060),s=t(s,u,c,m,g[o+4],11,1272893353),m=t(m,s,u,c,g[o+7],16,-155497632),c=t(c,m,s,u,g[o+10],23,-1094730640),u=t(u,c,m,s,g[o+13],4,681279174),s=t(s,u,c,m,g[o+0],11,-358537222),m=t(m,s,u,c,g[o+3],16,-722521979),c=t(c,m,s,u,g[o+6],23,76029189),u=t(u,c,m,s,g[o+9],4,-640364487),s=t(s,u,c,m,g[o+12],11,-421815835),m=t(m,s,u,c,g[o+15],16,530742520),u=a(u,c=t(c,m,s,u,g[o+2],23,-995338651),m,s,g[o+0],6,-198630844),s=a(s,u,c,m,g[o+7],10,1126891415),m=a(m,s,u,c,g[o+14],15,-1416354905),c=a(c,m,s,u,g[o+5],21,-57434055),u=a(u,c,m,s,g[o+12],6,1700485571),s=a(s,u,c,m,g[o+3],10,-1894986606),m=a(m,s,u,c,g[o+10],15,-1051523),c=a(c,m,s,u,g[o+1],21,-2054922799),u=a(u,c,m,s,g[o+8],6,1873313359),s=a(s,u,c,m,g[o+15],10,-30611744),m=a(m,s,u,c,g[o+6],15,-1560198380),c=a(c,m,s,u,g[o+13],21,1309151649),u=a(u,c,m,s,g[o+4],6,-145523070),s=a(s,u,c,m,g[o+11],10,-1120210379),m=a(m,s,u,c,g[o+2],15,718787259),c=a(c,m,s,u,g[o+9],21,-343485551),u=u+r>>>0,c=c+v>>>0,m=m+l>>>0,s=s+y>>>0}return f.endian([u,c,m,s])})._ff=function(S,C,g,T,u,c,m){var s=S+(C&g|~C&T)+(u>>>0)+m;return(s<<c|s>>>32-c)+C},A._gg=function(S,C,g,T,u,c,m){var s=S+(C&T|g&~T)+(u>>>0)+m;return(s<<c|s>>>32-c)+C},A._hh=function(S,C,g,T,u,c,m){var s=S+(C^g^T)+(u>>>0)+m;return(s<<c|s>>>32-c)+C},A._ii=function(S,C,g,T,u,c,m){var s=S+(g^(C|~T))+(u>>>0)+m;return(s<<c|s>>>32-c)+C},A._blocksize=16,A._digestsize=16,N.exports=function(S,C){if(null==S)throw new Error("Illegal argument "+S);var g=f.wordsToBytes(A(S,C));return C&&C.asBytes?g:C&&C.asString?_.bytesToString(g):f.bytesToHex(g)}},4191:(N,h,p)=>{"use strict";var f=p(2917);function e(g,T,u,c,m){var s=f.writeRtpDescription(g.kind,T);if(s+=f.writeIceParameters(g.iceGatherer.getLocalParameters()),s+=f.writeDtlsParameters(g.dtlsTransport.getLocalParameters(),"offer"===u?"actpass":m||"active"),s+="a=mid:"+g.mid+"\r\n",s+=g.rtpSender&&g.rtpReceiver?"a=sendrecv\r\n":g.rtpSender?"a=sendonly\r\n":g.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",g.rtpSender){var o=g.rtpSender._initialTrackId||g.rtpSender.track.id;g.rtpSender._initialTrackId=o;var i="msid:"+(c?c.id:"-")+" "+o+"\r\n";s+="a="+i,s+="a=ssrc:"+g.sendEncodingParameters[0].ssrc+" "+i,g.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+g.sendEncodingParameters[0].rtx.ssrc+" "+i,s+="a=ssrc-group:FID "+g.sendEncodingParameters[0].ssrc+" "+g.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+g.sendEncodingParameters[0].ssrc+" cname:"+f.localCName+"\r\n",g.rtpSender&&g.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+g.sendEncodingParameters[0].rtx.ssrc+" cname:"+f.localCName+"\r\n"),s}function _(g,T){var u={codecs:[],headerExtensions:[],fecMechanisms:[]},c=function(s,o){s=parseInt(s,10);for(var i=0;i<o.length;i++)if(o[i].payloadType===s||o[i].preferredPayloadType===s)return o[i]},m=function(s,o,i,n){var t=c(s.parameters.apt,i),a=c(o.parameters.apt,n);return t&&a&&t.name.toLowerCase()===a.name.toLowerCase()};return g.codecs.forEach(function(s){for(var o=0;o<T.codecs.length;o++){var i=T.codecs[o];if(s.name.toLowerCase()===i.name.toLowerCase()&&s.clockRate===i.clockRate){if("rtx"===s.name.toLowerCase()&&s.parameters&&i.parameters.apt&&!m(s,i,g.codecs,T.codecs))continue;(i=JSON.parse(JSON.stringify(i))).numChannels=Math.min(s.numChannels,i.numChannels),u.codecs.push(i),i.rtcpFeedback=i.rtcpFeedback.filter(function(n){for(var t=0;t<s.rtcpFeedback.length;t++)if(s.rtcpFeedback[t].type===n.type&&s.rtcpFeedback[t].parameter===n.parameter)return!0;return!1});break}}}),g.headerExtensions.forEach(function(s){for(var o=0;o<T.headerExtensions.length;o++){var i=T.headerExtensions[o];if(s.uri===i.uri){u.headerExtensions.push(i);break}}}),u}function A(g,T,u){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[T][g].indexOf(u)}function S(g,T){var u=g.getRemoteCandidates().find(function(c){return T.foundation===c.foundation&&T.ip===c.ip&&T.port===c.port&&T.priority===c.priority&&T.protocol===c.protocol&&T.type===c.type});return u||g.addRemoteCandidate(T),!u}function C(g,T){var u=new Error(T);return u.name=g,u}N.exports=function(g,T){function u(i,n){n.addTrack(i),n.dispatchEvent(new g.MediaStreamTrackEvent("addtrack",{track:i}))}function m(i,n,t,a){var r=new Event("track");r.track=n,r.receiver=t,r.transceiver={receiver:t},r.streams=a,g.setTimeout(function(){i._dispatchEvent("track",r)})}var s=function(i){var n=this,t=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(r){n[r]=t[r].bind(t)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this.localDescription=null,this.remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.iceGatheringState="new",i=JSON.parse(JSON.stringify(i||{})),this.usingBundle="max-bundle"===i.bundlePolicy,"negotiate"===i.rtcpMuxPolicy)throw C("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(i.rtcpMuxPolicy||(i.rtcpMuxPolicy="require"),i.iceTransportPolicy){case"all":case"relay":break;default:i.iceTransportPolicy="all"}switch(i.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:i.bundlePolicy="balanced"}if(i.iceServers=function E(g,T){var u=!1;return(g=JSON.parse(JSON.stringify(g))).filter(function(c){if(c&&(c.urls||c.url)){var m=c.urls||c.url;c.url&&!c.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var s="string"==typeof m;return s&&(m=[m]),m=m.filter(function(o){return 0!==o.indexOf("turn:")||-1===o.indexOf("transport=udp")||-1!==o.indexOf("turn:[")||u?0===o.indexOf("stun:")&&T>=14393&&-1===o.indexOf("?transport=udp"):(u=!0,!0)}),delete c.url,c.urls=s?m[0]:m,!!m.length}})}(i.iceServers||[],T),this._iceGatherers=[],i.iceCandidatePoolSize)for(var a=i.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new g.RTCIceGatherer({iceServers:i.iceServers,gatherPolicy:i.iceTransportPolicy}));else i.iceCandidatePoolSize=0;this._config=i,this.transceivers=[],this._sdpSessionId=f.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};s.prototype.onicecandidate=null,s.prototype.onaddstream=null,s.prototype.ontrack=null,s.prototype.onremovestream=null,s.prototype.onsignalingstatechange=null,s.prototype.oniceconnectionstatechange=null,s.prototype.onicegatheringstatechange=null,s.prototype.onnegotiationneeded=null,s.prototype.ondatachannel=null,s.prototype._dispatchEvent=function(i,n){this._isClosed||(this.dispatchEvent(n),"function"==typeof this["on"+i]&&this["on"+i](n))},s.prototype._emitGatheringStateChange=function(){var i=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",i)},s.prototype.getConfiguration=function(){return this._config},s.prototype.getLocalStreams=function(){return this.localStreams},s.prototype.getRemoteStreams=function(){return this.remoteStreams},s.prototype._createTransceiver=function(i){var t={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:i,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&this.transceivers.length>0)t.iceTransport=this.transceivers[0].iceTransport,t.dtlsTransport=this.transceivers[0].dtlsTransport;else{var a=this._createIceAndDtlsTransports();t.iceTransport=a.iceTransport,t.dtlsTransport=a.dtlsTransport}return this.transceivers.push(t),t},s.prototype.addTrack=function(i,n){if(this._isClosed)throw C("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(v){return v.track===i}))throw C("InvalidAccessError","Track already exists.");for(var a,r=0;r<this.transceivers.length;r++)!this.transceivers[r].track&&this.transceivers[r].kind===i.kind&&(a=this.transceivers[r]);return a||(a=this._createTransceiver(i.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),a.track=i,a.stream=n,a.rtpSender=new g.RTCRtpSender(i,a.dtlsTransport),a.rtpSender},s.prototype.addStream=function(i){var n=this;if(T>=15025)i.getTracks().forEach(function(a){n.addTrack(a,i)});else{var t=i.clone();i.getTracks().forEach(function(a,r){var v=t.getTracks()[r];a.addEventListener("enabled",function(l){v.enabled=l.enabled})}),t.getTracks().forEach(function(a){n.addTrack(a,t)})}},s.prototype.removeTrack=function(i){if(this._isClosed)throw C("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(i instanceof g.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find(function(r){return r.rtpSender===i});if(!n)throw C("InvalidAccessError","Sender was not created by this connection.");var t=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map(function(r){return r.stream}).indexOf(t)&&this.localStreams.indexOf(t)>-1&&this.localStreams.splice(this.localStreams.indexOf(t),1),this._maybeFireNegotiationNeeded()},s.prototype.removeStream=function(i){var n=this;i.getTracks().forEach(function(t){var a=n.getSenders().find(function(r){return r.track===t});a&&n.removeTrack(a)})},s.prototype.getSenders=function(){return this.transceivers.filter(function(i){return!!i.rtpSender}).map(function(i){return i.rtpSender})},s.prototype.getReceivers=function(){return this.transceivers.filter(function(i){return!!i.rtpReceiver}).map(function(i){return i.rtpReceiver})},s.prototype._createIceGatherer=function(i,n){var t=this;if(n&&i>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var a=new g.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(a,"state",{value:"new",writable:!0}),this.transceivers[i].bufferedCandidateEvents=[],this.transceivers[i].bufferCandidates=function(r){var v=!r.candidate||0===Object.keys(r.candidate).length;a.state=v?"completed":"gathering",null!==t.transceivers[i].bufferedCandidateEvents&&t.transceivers[i].bufferedCandidateEvents.push(r)},a.addEventListener("localcandidate",this.transceivers[i].bufferCandidates),a},s.prototype._gather=function(i,n){var t=this,a=this.transceivers[n].iceGatherer;if(!a.onlocalcandidate){var r=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,a.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),a.onlocalcandidate=function(v){if(!(t.usingBundle&&n>0)){var l=new Event("icecandidate");l.candidate={sdpMid:i,sdpMLineIndex:n};var y=v.candidate,b=!y||0===Object.keys(y).length;if(b)("new"===a.state||"gathering"===a.state)&&(a.state="completed");else{"new"===a.state&&(a.state="gathering"),y.component=1;var O=f.writeCandidate(y);l.candidate=Object.assign(l.candidate,f.parseCandidate(O)),l.candidate.candidate=O}var x=f.getMediaSections(t.localDescription.sdp);x[l.candidate.sdpMLineIndex]+=b?"a=end-of-candidates\r\n":"a="+l.candidate.candidate+"\r\n",t.localDescription.sdp=f.getDescription(t.localDescription.sdp)+x.join("");var Z=t.transceivers.every(function(L){return L.iceGatherer&&"completed"===L.iceGatherer.state});"gathering"!==t.iceGatheringState&&(t.iceGatheringState="gathering",t._emitGatheringStateChange()),b||t._dispatchEvent("icecandidate",l),Z&&(t._dispatchEvent("icecandidate",new Event("icecandidate")),t.iceGatheringState="complete",t._emitGatheringStateChange())}},g.setTimeout(function(){r.forEach(function(v){a.onlocalcandidate(v)})},0)}},s.prototype._createIceAndDtlsTransports=function(){var i=this,n=new g.RTCIceTransport(null);n.onicestatechange=function(){i._updateConnectionState()};var t=new g.RTCDtlsTransport(n);return t.ondtlsstatechange=function(){i._updateConnectionState()},t.onerror=function(){Object.defineProperty(t,"state",{value:"failed",writable:!0}),i._updateConnectionState()},{iceTransport:n,dtlsTransport:t}},s.prototype._disposeIceAndDtlsTransports=function(i){var n=this.transceivers[i].iceGatherer;n&&(delete n.onlocalcandidate,delete this.transceivers[i].iceGatherer);var t=this.transceivers[i].iceTransport;t&&(delete t.onicestatechange,delete this.transceivers[i].iceTransport);var a=this.transceivers[i].dtlsTransport;a&&(delete a.ondtlsstatechange,delete a.onerror,delete this.transceivers[i].dtlsTransport)},s.prototype._transceive=function(i,n,t){var a=_(i.localCapabilities,i.remoteCapabilities);n&&i.rtpSender&&(a.encodings=i.sendEncodingParameters,a.rtcp={cname:f.localCName,compound:i.rtcpParameters.compound},i.recvEncodingParameters.length&&(a.rtcp.ssrc=i.recvEncodingParameters[0].ssrc),i.rtpSender.send(a)),t&&i.rtpReceiver&&a.codecs.length>0&&("video"===i.kind&&i.recvEncodingParameters&&T<15019&&i.recvEncodingParameters.forEach(function(r){delete r.rtx}),a.encodings=i.recvEncodingParameters.length?i.recvEncodingParameters:[{}],a.rtcp={compound:i.rtcpParameters.compound},i.rtcpParameters.cname&&(a.rtcp.cname=i.rtcpParameters.cname),i.sendEncodingParameters.length&&(a.rtcp.ssrc=i.sendEncodingParameters[0].ssrc),i.rtpReceiver.receive(a))},s.prototype.setLocalDescription=function(i){var t,a,n=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(C("TypeError",'Unsupported type "'+i.type+'"'));if(!A("setLocalDescription",i.type,n.signalingState)||n._isClosed)return Promise.reject(C("InvalidStateError","Can not set local "+i.type+" in state "+n.signalingState));if("offer"===i.type)t=f.splitSections(i.sdp),a=t.shift(),t.forEach(function(v,l){var y=f.parseRtpParameters(v);n.transceivers[l].localCapabilities=y}),n.transceivers.forEach(function(v,l){n._gather(v.mid,l)});else if("answer"===i.type){t=f.splitSections(n.remoteDescription.sdp),a=t.shift();var r=f.matchPrefix(a,"a=ice-lite").length>0;t.forEach(function(v,l){var y=n.transceivers[l],b=y.iceGatherer,O=y.iceTransport,x=y.dtlsTransport,Z=y.localCapabilities,L=y.remoteCapabilities;if(!(f.isRejected(v)&&0===f.matchPrefix(v,"a=bundle-only").length||y.isDatachannel)){var P=f.getIceParameters(v,a),R=f.getDtlsParameters(v,a);r&&(R.role="server"),(!n.usingBundle||0===l)&&(n._gather(y.mid,l),"new"===O.state&&O.start(b,P,r?"controlling":"controlled"),"new"===x.state&&x.start(R));var d=_(Z,L);n._transceive(y,d.codecs.length>0,!1)}})}return n.localDescription={type:i.type,sdp:i.sdp},n._updateSignalingState("offer"===i.type?"have-local-offer":"stable"),Promise.resolve()},s.prototype.setRemoteDescription=function(i){var n=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(C("TypeError",'Unsupported type "'+i.type+'"'));if(!A("setRemoteDescription",i.type,n.signalingState)||n._isClosed)return Promise.reject(C("InvalidStateError","Can not set remote "+i.type+" in state "+n.signalingState));var t={};n.remoteStreams.forEach(function(O){t[O.id]=O});var a=[],r=f.splitSections(i.sdp),v=r.shift(),l=f.matchPrefix(v,"a=ice-lite").length>0,y=f.matchPrefix(v,"a=group:BUNDLE ").length>0;n.usingBundle=y;var b=f.matchPrefix(v,"a=ice-options:")[0];return n.canTrickleIceCandidates=!!b&&b.substr(14).split(" ").indexOf("trickle")>=0,r.forEach(function(O,x){var Z=f.splitLines(O),L=f.getKind(O),w=f.isRejected(O)&&0===f.matchPrefix(O,"a=bundle-only").length,P=Z[0].substr(2).split(" ")[2],R=f.getDirection(O,v),d=f.parseMsid(O),I=f.getMid(O)||f.generateIdentifier();if("application"!==L||"DTLS/SCTP"!==P){var U,F,k,D,M,j,H,B,q,V,W,G=f.parseRtpParameters(O);w||(V=f.getIceParameters(O,v),(W=f.getDtlsParameters(O,v)).role="client"),H=f.parseRtpEncodingParameters(O);var J=f.parseRtcpParameters(O),K=f.matchPrefix(O,"a=end-of-candidates",v).length>0,X=f.matchPrefix(O,"a=candidate:").map(function(z){return f.parseCandidate(z)}).filter(function(z){return 1===z.component});if(("offer"===i.type||"answer"===i.type)&&!w&&y&&x>0&&n.transceivers[x]&&(n._disposeIceAndDtlsTransports(x),n.transceivers[x].iceGatherer=n.transceivers[0].iceGatherer,n.transceivers[x].iceTransport=n.transceivers[0].iceTransport,n.transceivers[x].dtlsTransport=n.transceivers[0].dtlsTransport,n.transceivers[x].rtpSender&&n.transceivers[x].rtpSender.setTransport(n.transceivers[0].dtlsTransport),n.transceivers[x].rtpReceiver&&n.transceivers[x].rtpReceiver.setTransport(n.transceivers[0].dtlsTransport)),"offer"!==i.type||w)"answer"===i.type&&!w&&(F=(U=n.transceivers[x]).iceGatherer,k=U.iceTransport,D=U.dtlsTransport,M=U.rtpReceiver,j=U.sendEncodingParameters,B=U.localCapabilities,n.transceivers[x].recvEncodingParameters=H,n.transceivers[x].remoteCapabilities=G,n.transceivers[x].rtcpParameters=J,X.length&&"new"===k.state&&(!l&&!K||y&&0!==x?X.forEach(function(z){S(U.iceTransport,z)}):k.setRemoteCandidates(X)),(!y||0===x)&&("new"===k.state&&k.start(F,V,"controlling"),"new"===D.state&&D.start(W)),n._transceive(U,"sendrecv"===R||"recvonly"===R,"sendrecv"===R||"sendonly"===R),!M||"sendrecv"!==R&&"sendonly"!==R?delete U.rtpReceiver:(q=M.track,d?(t[d.stream]||(t[d.stream]=new g.MediaStream),u(q,t[d.stream]),a.push([q,M,t[d.stream]])):(t.default||(t.default=new g.MediaStream),u(q,t.default),a.push([q,M,t.default]))));else{(U=n.transceivers[x]||n._createTransceiver(L)).mid=I,U.iceGatherer||(U.iceGatherer=n._createIceGatherer(x,y)),X.length&&"new"===U.iceTransport.state&&(!K||y&&0!==x?X.forEach(function(z){S(U.iceTransport,z)}):U.iceTransport.setRemoteCandidates(X)),B=g.RTCRtpReceiver.getCapabilities(L),T<15019&&(B.codecs=B.codecs.filter(function(z){return"rtx"!==z.name})),j=U.sendEncodingParameters||[{ssrc:1001*(2*x+2)}];var Q,Y=!1;"sendrecv"===R||"sendonly"===R?(Y=!U.rtpReceiver,M=U.rtpReceiver||new g.RTCRtpReceiver(U.dtlsTransport,L),Y&&(q=M.track,d&&"-"===d.stream||(d?(t[d.stream]||(t[d.stream]=new g.MediaStream,Object.defineProperty(t[d.stream],"id",{get:function(){return d.stream}})),Object.defineProperty(q,"id",{get:function(){return d.track}}),Q=t[d.stream]):(t.default||(t.default=new g.MediaStream),Q=t.default)),Q&&(u(q,Q),U.associatedRemoteMediaStreams.push(Q)),a.push([q,M,Q]))):U.rtpReceiver&&U.rtpReceiver.track&&(U.associatedRemoteMediaStreams.forEach(function(z){var $=z.getTracks().find(function(ee){return ee.id===U.rtpReceiver.track.id});$&&function c(i,n){n.removeTrack(i),n.dispatchEvent(new g.MediaStreamTrackEvent("removetrack",{track:i}))}($,z)}),U.associatedRemoteMediaStreams=[]),U.localCapabilities=B,U.remoteCapabilities=G,U.rtpReceiver=M,U.rtcpParameters=J,U.sendEncodingParameters=j,U.recvEncodingParameters=H,n._transceive(n.transceivers[x],!1,Y)}}else n.transceivers[x]={mid:I,isDatachannel:!0}}),void 0===n._dtlsRole&&(n._dtlsRole="offer"===i.type?"active":"passive"),n.remoteDescription={type:i.type,sdp:i.sdp},n._updateSignalingState("offer"===i.type?"have-remote-offer":"stable"),Object.keys(t).forEach(function(O){var x=t[O];if(x.getTracks().length){if(-1===n.remoteStreams.indexOf(x)){n.remoteStreams.push(x);var Z=new Event("addstream");Z.stream=x,g.setTimeout(function(){n._dispatchEvent("addstream",Z)})}a.forEach(function(L){x.id===L[2].id&&m(n,L[0],L[1],[x])})}}),a.forEach(function(O){O[2]||m(n,O[0],O[1],[])}),g.setTimeout(function(){n&&n.transceivers&&n.transceivers.forEach(function(O){O.iceTransport&&"new"===O.iceTransport.state&&O.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),O.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},s.prototype.close=function(){this.transceivers.forEach(function(i){i.iceTransport&&i.iceTransport.stop(),i.dtlsTransport&&i.dtlsTransport.stop(),i.rtpSender&&i.rtpSender.stop(),i.rtpReceiver&&i.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},s.prototype._updateSignalingState=function(i){this.signalingState=i;var n=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",n)},s.prototype._maybeFireNegotiationNeeded=function(){var i=this;"stable"!==this.signalingState||!0===this.needNegotiation||(this.needNegotiation=!0,g.setTimeout(function(){if(i.needNegotiation){i.needNegotiation=!1;var n=new Event("negotiationneeded");i._dispatchEvent("negotiationneeded",n)}},0))},s.prototype._updateConnectionState=function(){var i,n={new:0,closed:0,connecting:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(a){n[a.iceTransport.state]++,n[a.dtlsTransport.state]++}),n.connected+=n.completed,i="new",n.failed>0?i="failed":n.connecting>0||n.checking>0?i="connecting":n.disconnected>0?i="disconnected":n.new>0?i="new":(n.connected>0||n.completed>0)&&(i="connected"),i!==this.iceConnectionState){this.iceConnectionState=i;var t=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",t)}},s.prototype.createOffer=function(){var i=this;if(i._isClosed)return Promise.reject(C("InvalidStateError","Can not call createOffer after close"));var n=i.transceivers.filter(function(l){return"audio"===l.kind}).length,t=i.transceivers.filter(function(l){return"video"===l.kind}).length,a=arguments[0];if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(n=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio),void 0!==a.offerToReceiveVideo&&(t=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(i.transceivers.forEach(function(l){"audio"===l.kind?--n<0&&(l.wantReceive=!1):"video"===l.kind&&--t<0&&(l.wantReceive=!1)});n>0||t>0;)n>0&&(i._createTransceiver("audio"),n--),t>0&&(i._createTransceiver("video"),t--);var r=f.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.transceivers.forEach(function(l,y){var b=l.track,O=l.kind,x=l.mid||f.generateIdentifier();l.mid=x,l.iceGatherer||(l.iceGatherer=i._createIceGatherer(y,i.usingBundle));var Z=g.RTCRtpSender.getCapabilities(O);T<15019&&(Z.codecs=Z.codecs.filter(function(w){return"rtx"!==w.name})),Z.codecs.forEach(function(w){"H264"===w.name&&void 0===w.parameters["level-asymmetry-allowed"]&&(w.parameters["level-asymmetry-allowed"]="1"),l.remoteCapabilities&&l.remoteCapabilities.codecs&&l.remoteCapabilities.codecs.forEach(function(P){w.name.toLowerCase()===P.name.toLowerCase()&&w.clockRate===P.clockRate&&(w.preferredPayloadType=P.payloadType)})}),Z.headerExtensions.forEach(function(w){(l.remoteCapabilities&&l.remoteCapabilities.headerExtensions||[]).forEach(function(R){w.uri===R.uri&&(w.id=R.id)})});var L=l.sendEncodingParameters||[{ssrc:1001*(2*y+1)}];b&&T>=15019&&"video"===O&&!L[0].rtx&&(L[0].rtx={ssrc:L[0].ssrc+1}),l.wantReceive&&(l.rtpReceiver=new g.RTCRtpReceiver(l.dtlsTransport,O)),l.localCapabilities=Z,l.sendEncodingParameters=L}),"max-compat"!==i._config.bundlePolicy&&(r+="a=group:BUNDLE "+i.transceivers.map(function(l){return l.mid}).join(" ")+"\r\n"),r+="a=ice-options:trickle\r\n",i.transceivers.forEach(function(l,y){r+=e(l,l.localCapabilities,"offer",l.stream,i._dtlsRole),r+="a=rtcp-rsize\r\n",l.iceGatherer&&"new"!==i.iceGatheringState&&(0===y||!i.usingBundle)&&(l.iceGatherer.getLocalCandidates().forEach(function(b){b.component=1,r+="a="+f.writeCandidate(b)+"\r\n"}),"completed"===l.iceGatherer.state&&(r+="a=end-of-candidates\r\n"))});var v=new g.RTCSessionDescription({type:"offer",sdp:r});return Promise.resolve(v)},s.prototype.createAnswer=function(){var i=this;if(i._isClosed)return Promise.reject(C("InvalidStateError","Can not call createAnswer after close"));var n=f.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.usingBundle&&(n+="a=group:BUNDLE "+i.transceivers.map(function(r){return r.mid}).join(" ")+"\r\n");var t=f.getMediaSections(i.remoteDescription.sdp).length;i.transceivers.forEach(function(r,v){if(!(v+1>t)){if(r.isDatachannel)return void(n+="m=application 0 DTLS/SCTP 5000\r\nc=IN IP4 0.0.0.0\r\na=mid:"+r.mid+"\r\n");var l;r.stream&&("audio"===r.kind?l=r.stream.getAudioTracks()[0]:"video"===r.kind&&(l=r.stream.getVideoTracks()[0]),l&&T>=15019&&"video"===r.kind&&!r.sendEncodingParameters[0].rtx&&(r.sendEncodingParameters[0].rtx={ssrc:r.sendEncodingParameters[0].ssrc+1}));var y=_(r.localCapabilities,r.remoteCapabilities);!y.codecs.filter(function(O){return"rtx"===O.name.toLowerCase()}).length&&r.sendEncodingParameters[0].rtx&&delete r.sendEncodingParameters[0].rtx,n+=e(r,y,"answer",r.stream,i._dtlsRole),r.rtcpParameters&&r.rtcpParameters.reducedSize&&(n+="a=rtcp-rsize\r\n")}});var a=new g.RTCSessionDescription({type:"answer",sdp:n});return Promise.resolve(a)},s.prototype.addIceCandidate=function(i){var t,n=this;return i&&void 0===i.sdpMLineIndex&&!i.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(a,r){if(!n.remoteDescription)return r(C("InvalidStateError","Can not add ICE candidate without a remote description"));if(i&&""!==i.candidate){var l=i.sdpMLineIndex;if(i.sdpMid)for(var y=0;y<n.transceivers.length;y++)if(n.transceivers[y].mid===i.sdpMid){l=y;break}var b=n.transceivers[l];if(!b)return r(C("OperationError","Can not add ICE candidate"));if(b.isDatachannel)return a();var O=Object.keys(i.candidate).length>0?f.parseCandidate(i.candidate):{};if("tcp"===O.protocol&&(0===O.port||9===O.port)||O.component&&1!==O.component)return a();if((0===l||l>0&&b.iceTransport!==n.transceivers[0].iceTransport)&&!S(b.iceTransport,O))return r(C("OperationError","Can not add ICE candidate"));var x=i.candidate.trim();0===x.indexOf("a=")&&(x=x.substr(2)),(t=f.getMediaSections(n.remoteDescription.sdp))[l]+="a="+(O.type?x:"end-of-candidates")+"\r\n",n.remoteDescription.sdp=t.join("")}else for(var v=0;v<n.transceivers.length&&(n.transceivers[v].isDatachannel||(n.transceivers[v].iceTransport.addRemoteCandidate({}),(t=f.getMediaSections(n.remoteDescription.sdp))[v]+="a=end-of-candidates\r\n",n.remoteDescription.sdp=f.getDescription(n.remoteDescription.sdp)+t.join(""),!n.usingBundle));v++);a()})},s.prototype.getStats=function(){var i=[];return this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(a){t[a]&&i.push(t[a].getStats())})}),new Promise(function(t){var a=new Map;Promise.all(i).then(function(r){r.forEach(function(v){Object.keys(v).forEach(function(l){v[l].type=function(t){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type}(v[l]),a.set(l,v[l])})}),t(a)})})};var o=["createOffer","createAnswer"];return o.forEach(function(i){var n=s.prototype[i];s.prototype[i]=function(){var t=arguments;return"function"==typeof t[0]||"function"==typeof t[1]?n.apply(this,[arguments[2]]).then(function(a){"function"==typeof t[0]&&t[0].apply(null,[a])},function(a){"function"==typeof t[1]&&t[1].apply(null,[a])}):n.apply(this,arguments)}}),(o=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(i){var n=s.prototype[i];s.prototype[i]=function(){var t=arguments;return"function"==typeof t[1]||"function"==typeof t[2]?n.apply(this,arguments).then(function(){"function"==typeof t[1]&&t[1].apply(null)},function(a){"function"==typeof t[2]&&t[2].apply(null,[a])}):n.apply(this,arguments)}}),["getStats"].forEach(function(i){var n=s.prototype[i];s.prototype[i]=function(){var t=arguments;return"function"==typeof t[1]?n.apply(this,arguments).then(function(){"function"==typeof t[1]&&t[1].apply(null)}):n.apply(this,arguments)}}),s}},2917:N=>{"use strict";var h={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};h.localCName=h.generateIdentifier(),h.splitLines=function(p){return p.trim().split("\n").map(function(f){return f.trim()})},h.splitSections=function(p){return p.split("\nm=").map(function(e,E){return(E>0?"m="+e:e).trim()+"\r\n"})},h.getDescription=function(p){var f=h.splitSections(p);return f&&f[0]},h.getMediaSections=function(p){var f=h.splitSections(p);return f.shift(),f},h.matchPrefix=function(p,f){return h.splitLines(p).filter(function(e){return 0===e.indexOf(f)})},h.parseCandidate=function(p){for(var f,e={foundation:(f=0===p.indexOf("a=candidate:")?p.substring(12).split(" "):p.substring(10).split(" "))[0],component:parseInt(f[1],10),protocol:f[2].toLowerCase(),priority:parseInt(f[3],10),ip:f[4],address:f[4],port:parseInt(f[5],10),type:f[7]},E=8;E<f.length;E+=2)switch(f[E]){case"raddr":e.relatedAddress=f[E+1];break;case"rport":e.relatedPort=parseInt(f[E+1],10);break;case"tcptype":e.tcpType=f[E+1];break;case"ufrag":e.ufrag=f[E+1],e.usernameFragment=f[E+1];break;default:e[f[E]]=f[E+1]}return e},h.writeCandidate=function(p){var f=[];f.push(p.foundation),f.push(p.component),f.push(p.protocol.toUpperCase()),f.push(p.priority),f.push(p.address||p.ip),f.push(p.port);var e=p.type;return f.push("typ"),f.push(e),"host"!==e&&p.relatedAddress&&p.relatedPort&&(f.push("raddr"),f.push(p.relatedAddress),f.push("rport"),f.push(p.relatedPort)),p.tcpType&&"tcp"===p.protocol.toLowerCase()&&(f.push("tcptype"),f.push(p.tcpType)),(p.usernameFragment||p.ufrag)&&(f.push("ufrag"),f.push(p.usernameFragment||p.ufrag)),"candidate:"+f.join(" ")},h.parseIceOptions=function(p){return p.substr(14).split(" ")},h.parseRtpMap=function(p){var f=p.substr(9).split(" "),e={payloadType:parseInt(f.shift(),10)};return f=f[0].split("/"),e.name=f[0],e.clockRate=parseInt(f[1],10),e.channels=3===f.length?parseInt(f[2],10):1,e.numChannels=e.channels,e},h.writeRtpMap=function(p){var f=p.payloadType;void 0!==p.preferredPayloadType&&(f=p.preferredPayloadType);var e=p.channels||p.numChannels||1;return"a=rtpmap:"+f+" "+p.name+"/"+p.clockRate+(1!==e?"/"+e:"")+"\r\n"},h.parseExtmap=function(p){var f=p.substr(9).split(" ");return{id:parseInt(f[0],10),direction:f[0].indexOf("/")>0?f[0].split("/")[1]:"sendrecv",uri:f[1]}},h.writeExtmap=function(p){return"a=extmap:"+(p.id||p.preferredId)+(p.direction&&"sendrecv"!==p.direction?"/"+p.direction:"")+" "+p.uri+"\r\n"},h.parseFmtp=function(p){for(var e,f={},E=p.substr(p.indexOf(" ")+1).split(";"),_=0;_<E.length;_++)f[(e=E[_].trim().split("="))[0].trim()]=e[1];return f},h.writeFmtp=function(p){var f="",e=p.payloadType;if(void 0!==p.preferredPayloadType&&(e=p.preferredPayloadType),p.parameters&&Object.keys(p.parameters).length){var E=[];Object.keys(p.parameters).forEach(function(_){E.push(p.parameters[_]?_+"="+p.parameters[_]:_)}),f+="a=fmtp:"+e+" "+E.join(";")+"\r\n"}return f},h.parseRtcpFb=function(p){var f=p.substr(p.indexOf(" ")+1).split(" ");return{type:f.shift(),parameter:f.join(" ")}},h.writeRtcpFb=function(p){var f="",e=p.payloadType;return void 0!==p.preferredPayloadType&&(e=p.preferredPayloadType),p.rtcpFeedback&&p.rtcpFeedback.length&&p.rtcpFeedback.forEach(function(E){f+="a=rtcp-fb:"+e+" "+E.type+(E.parameter&&E.parameter.length?" "+E.parameter:"")+"\r\n"}),f},h.parseSsrcMedia=function(p){var f=p.indexOf(" "),e={ssrc:parseInt(p.substr(7,f-7),10)},E=p.indexOf(":",f);return E>-1?(e.attribute=p.substr(f+1,E-f-1),e.value=p.substr(E+1)):e.attribute=p.substr(f+1),e},h.parseSsrcGroup=function(p){var f=p.substr(13).split(" ");return{semantics:f.shift(),ssrcs:f.map(function(e){return parseInt(e,10)})}},h.getMid=function(p){var f=h.matchPrefix(p,"a=mid:")[0];if(f)return f.substr(6)},h.parseFingerprint=function(p){var f=p.substr(14).split(" ");return{algorithm:f[0].toLowerCase(),value:f[1]}},h.getDtlsParameters=function(p,f){return{role:"auto",fingerprints:h.matchPrefix(p+f,"a=fingerprint:").map(h.parseFingerprint)}},h.writeDtlsParameters=function(p,f){var e="a=setup:"+f+"\r\n";return p.fingerprints.forEach(function(E){e+="a=fingerprint:"+E.algorithm+" "+E.value+"\r\n"}),e},h.parseCryptoLine=function(p){var f=p.substr(9).split(" ");return{tag:parseInt(f[0],10),cryptoSuite:f[1],keyParams:f[2],sessionParams:f.slice(3)}},h.writeCryptoLine=function(p){return"a=crypto:"+p.tag+" "+p.cryptoSuite+" "+("object"==typeof p.keyParams?h.writeCryptoKeyParams(p.keyParams):p.keyParams)+(p.sessionParams?" "+p.sessionParams.join(" "):"")+"\r\n"},h.parseCryptoKeyParams=function(p){if(0!==p.indexOf("inline:"))return null;var f=p.substr(7).split("|");return{keyMethod:"inline",keySalt:f[0],lifeTime:f[1],mkiValue:f[2]?f[2].split(":")[0]:void 0,mkiLength:f[2]?f[2].split(":")[1]:void 0}},h.writeCryptoKeyParams=function(p){return p.keyMethod+":"+p.keySalt+(p.lifeTime?"|"+p.lifeTime:"")+(p.mkiValue&&p.mkiLength?"|"+p.mkiValue+":"+p.mkiLength:"")},h.getCryptoParameters=function(p,f){return h.matchPrefix(p+f,"a=crypto:").map(h.parseCryptoLine)},h.getIceParameters=function(p,f){var e=h.matchPrefix(p+f,"a=ice-ufrag:")[0],E=h.matchPrefix(p+f,"a=ice-pwd:")[0];return e&&E?{usernameFragment:e.substr(12),password:E.substr(10)}:null},h.writeIceParameters=function(p){return"a=ice-ufrag:"+p.usernameFragment+"\r\na=ice-pwd:"+p.password+"\r\n"},h.parseRtpParameters=function(p){for(var f={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},E=h.splitLines(p)[0].split(" "),_=3;_<E.length;_++){var A=E[_],S=h.matchPrefix(p,"a=rtpmap:"+A+" ")[0];if(S){var C=h.parseRtpMap(S),g=h.matchPrefix(p,"a=fmtp:"+A+" ");switch(C.parameters=g.length?h.parseFmtp(g[0]):{},C.rtcpFeedback=h.matchPrefix(p,"a=rtcp-fb:"+A+" ").map(h.parseRtcpFb),f.codecs.push(C),C.name.toUpperCase()){case"RED":case"ULPFEC":f.fecMechanisms.push(C.name.toUpperCase())}}}return h.matchPrefix(p,"a=extmap:").forEach(function(T){f.headerExtensions.push(h.parseExtmap(T))}),f},h.writeRtpDescription=function(p,f){var e="";e+="m="+p+" ",e+=f.codecs.length>0?"9":"0",e+=" UDP/TLS/RTP/SAVPF ",e+=f.codecs.map(function(_){return void 0!==_.preferredPayloadType?_.preferredPayloadType:_.payloadType}).join(" ")+"\r\n",e+="c=IN IP4 0.0.0.0\r\n",e+="a=rtcp:9 IN IP4 0.0.0.0\r\n",f.codecs.forEach(function(_){e+=h.writeRtpMap(_),e+=h.writeFmtp(_),e+=h.writeRtcpFb(_)});var E=0;return f.codecs.forEach(function(_){_.maxptime>E&&(E=_.maxptime)}),E>0&&(e+="a=maxptime:"+E+"\r\n"),e+="a=rtcp-mux\r\n",f.headerExtensions&&f.headerExtensions.forEach(function(_){e+=h.writeExtmap(_)}),e},h.parseRtpEncodingParameters=function(p){var C,f=[],e=h.parseRtpParameters(p),E=-1!==e.fecMechanisms.indexOf("RED"),_=-1!==e.fecMechanisms.indexOf("ULPFEC"),A=h.matchPrefix(p,"a=ssrc:").map(function(u){return h.parseSsrcMedia(u)}).filter(function(u){return"cname"===u.attribute}),S=A.length>0&&A[0].ssrc,g=h.matchPrefix(p,"a=ssrc-group:FID").map(function(u){return u.substr(17).split(" ").map(function(m){return parseInt(m,10)})});g.length>0&&g[0].length>1&&g[0][0]===S&&(C=g[0][1]),e.codecs.forEach(function(u){if("RTX"===u.name.toUpperCase()&&u.parameters.apt){var c={ssrc:S,codecPayloadType:parseInt(u.parameters.apt,10)};S&&C&&(c.rtx={ssrc:C}),f.push(c),E&&((c=JSON.parse(JSON.stringify(c))).fec={ssrc:S,mechanism:_?"red+ulpfec":"red"},f.push(c))}}),0===f.length&&S&&f.push({ssrc:S});var T=h.matchPrefix(p,"b=");return T.length&&(T=0===T[0].indexOf("b=TIAS:")?parseInt(T[0].substr(7),10):0===T[0].indexOf("b=AS:")?1e3*parseInt(T[0].substr(5),10)*.95-16e3:void 0,f.forEach(function(u){u.maxBitrate=T})),f},h.parseRtcpParameters=function(p){var f={},e=h.matchPrefix(p,"a=ssrc:").map(function(A){return h.parseSsrcMedia(A)}).filter(function(A){return"cname"===A.attribute})[0];e&&(f.cname=e.value,f.ssrc=e.ssrc);var E=h.matchPrefix(p,"a=rtcp-rsize");f.reducedSize=E.length>0,f.compound=0===E.length;var _=h.matchPrefix(p,"a=rtcp-mux");return f.mux=_.length>0,f},h.parseMsid=function(p){var f,e=h.matchPrefix(p,"a=msid:");if(1===e.length)return{stream:(f=e[0].substr(7).split(" "))[0],track:f[1]};var E=h.matchPrefix(p,"a=ssrc:").map(function(_){return h.parseSsrcMedia(_)}).filter(function(_){return"msid"===_.attribute});return E.length>0?{stream:(f=E[0].value.split(" "))[0],track:f[1]}:void 0},h.parseSctpDescription=function(p){var E,f=h.parseMLine(p),e=h.matchPrefix(p,"a=max-message-size:");e.length>0&&(E=parseInt(e[0].substr(19),10)),isNaN(E)&&(E=65536);var _=h.matchPrefix(p,"a=sctp-port:");if(_.length>0)return{port:parseInt(_[0].substr(12),10),protocol:f.fmt,maxMessageSize:E};if(h.matchPrefix(p,"a=sctpmap:").length>0){var S=h.matchPrefix(p,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(S[0],10),protocol:S[1],maxMessageSize:E}}},h.writeSctpDescription=function(p,f){var e=[];return e="DTLS/SCTP"!==p.protocol?["m="+p.kind+" 9 "+p.protocol+" "+f.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+f.port+"\r\n"]:["m="+p.kind+" 9 "+p.protocol+" "+f.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+f.port+" "+f.protocol+" 65535\r\n"],void 0!==f.maxMessageSize&&e.push("a=max-message-size:"+f.maxMessageSize+"\r\n"),e.join("")},h.generateSessionId=function(){return Math.random().toString().substr(2,21)},h.writeSessionBoilerplate=function(p,f,e){var _=void 0!==f?f:2;return"v=0\r\no="+(e||"thisisadapterortc")+" "+(p||h.generateSessionId())+" "+_+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},h.writeMediaSection=function(p,f,e,E){var _=h.writeRtpDescription(p.kind,f);if(_+=h.writeIceParameters(p.iceGatherer.getLocalParameters()),_+=h.writeDtlsParameters(p.dtlsTransport.getLocalParameters(),"offer"===e?"actpass":"active"),_+="a=mid:"+p.mid+"\r\n",_+=p.direction?"a="+p.direction+"\r\n":p.rtpSender&&p.rtpReceiver?"a=sendrecv\r\n":p.rtpSender?"a=sendonly\r\n":p.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",p.rtpSender){var A="msid:"+E.id+" "+p.rtpSender.track.id+"\r\n";_+="a="+A,_+="a=ssrc:"+p.sendEncodingParameters[0].ssrc+" "+A,p.sendEncodingParameters[0].rtx&&(_+="a=ssrc:"+p.sendEncodingParameters[0].rtx.ssrc+" "+A,_+="a=ssrc-group:FID "+p.sendEncodingParameters[0].ssrc+" "+p.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return _+="a=ssrc:"+p.sendEncodingParameters[0].ssrc+" cname:"+h.localCName+"\r\n",p.rtpSender&&p.sendEncodingParameters[0].rtx&&(_+="a=ssrc:"+p.sendEncodingParameters[0].rtx.ssrc+" cname:"+h.localCName+"\r\n"),_},h.getDirection=function(p,f){for(var e=h.splitLines(p),E=0;E<e.length;E++)switch(e[E]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return e[E].substr(2)}return f?h.getDirection(f):"sendrecv"},h.getKind=function(p){return h.splitLines(p)[0].split(" ")[0].substr(2)},h.isRejected=function(p){return"0"===p.split(" ",2)[1]},h.parseMLine=function(p){var e=h.splitLines(p)[0].substr(2).split(" ");return{kind:e[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}},h.parseOLine=function(p){var e=h.matchPrefix(p,"o=")[0].substr(2).split(" ");return{username:e[0],sessionId:e[1],sessionVersion:parseInt(e[2],10),netType:e[3],addressType:e[4],address:e[5]}},h.isValidSDP=function(p){if("string"!=typeof p||0===p.length)return!1;for(var f=h.splitLines(p),e=0;e<f.length;e++)if(f[e].length<2||"="!==f[e].charAt(1))return!1;return!0},N.exports=h}}]);